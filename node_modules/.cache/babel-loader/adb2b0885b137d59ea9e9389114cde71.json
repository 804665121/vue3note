{"ast":null,"code":"import _mergeJSXProps from 'babel-helper-vue-jsx-merge-props';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport PropTypes from '../_util/vue-types';\nimport classNames from 'classnames';\nimport omit from 'omit.js';\nimport ResizeObserver from '../vc-resize-observer';\nimport BaseMixin from '../_util/BaseMixin';\nimport throttleByAnimationFrame from '../_util/throttleByAnimationFrame';\nimport { ConfigConsumerProps } from '../config-provider/configConsumerProps';\nimport Base from '../base';\nimport warning from '../_util/warning';\nimport { addObserveTarget, removeObserveTarget, getTargetRect, getFixedTop, getFixedBottom } from './utils';\n\nfunction getDefaultTarget() {\n  return typeof window !== 'undefined' ? window : null;\n} // Affix\n\n\nvar AffixProps = {\n  /**\n   * 距离窗口顶部达到指定偏移量后触发\n   */\n  offsetTop: PropTypes.number,\n  offset: PropTypes.number,\n\n  /** 距离窗口底部达到指定偏移量后触发 */\n  offsetBottom: PropTypes.number,\n\n  /** 固定状态改变时触发的回调函数 */\n  // onChange?: (affixed?: boolean) => void;\n\n  /** 设置 Affix 需要监听其滚动事件的元素，值为一个返回对应 DOM 元素的函数 */\n  target: PropTypes.func.def(getDefaultTarget),\n  prefixCls: PropTypes.string\n};\nvar AffixStatus = {\n  None: 'none',\n  Prepare: 'Prepare'\n};\nvar Affix = {\n  name: 'AAffix',\n  props: AffixProps,\n  mixins: [BaseMixin],\n  inject: {\n    configProvider: {\n      'default': function _default() {\n        return ConfigConsumerProps;\n      }\n    }\n  },\n  data: function data() {\n    return {\n      affixStyle: undefined,\n      placeholderStyle: undefined,\n      status: AffixStatus.None,\n      lastAffix: false,\n      prevTarget: null\n    };\n  },\n  beforeMount: function beforeMount() {\n    this.updatePosition = throttleByAnimationFrame(this.updatePosition);\n    this.lazyUpdatePosition = throttleByAnimationFrame(this.lazyUpdatePosition);\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    var target = this.target;\n\n    if (target) {\n      // [Legacy] Wait for parent component ref has its value.\n      // We should use target as directly element instead of function which makes element check hard.\n      this.timeout = setTimeout(function () {\n        addObserveTarget(target(), _this); // Mock Event object.\n\n        _this.updatePosition();\n      });\n    }\n  },\n  updated: function updated() {\n    this.measure();\n  },\n  watch: {\n    target: function target(val) {\n      var newTarget = null;\n\n      if (val) {\n        newTarget = val() || null;\n      }\n\n      if (this.prevTarget !== newTarget) {\n        removeObserveTarget(this);\n\n        if (newTarget) {\n          addObserveTarget(newTarget, this); // Mock Event object.\n\n          this.updatePosition();\n        }\n\n        this.prevTarget = newTarget;\n      }\n    },\n    offsetTop: function offsetTop() {\n      this.updatePosition();\n    },\n    offsetBottom: function offsetBottom() {\n      this.updatePosition();\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    clearTimeout(this.timeout);\n    removeObserveTarget(this);\n    this.updatePosition.cancel(); // https://github.com/ant-design/ant-design/issues/22683\n\n    this.lazyUpdatePosition.cancel();\n  },\n  methods: {\n    getOffsetTop: function getOffsetTop() {\n      var offset = this.offset,\n          offsetBottom = this.offsetBottom;\n      var offsetTop = this.offsetTop;\n\n      if (typeof offsetTop === 'undefined') {\n        offsetTop = offset;\n        warning(typeof offset === 'undefined', 'Affix', '`offset` is deprecated. Please use `offsetTop` instead.');\n      }\n\n      if (offsetBottom === undefined && offsetTop === undefined) {\n        offsetTop = 0;\n      }\n\n      return offsetTop;\n    },\n    getOffsetBottom: function getOffsetBottom() {\n      return this.offsetBottom;\n    },\n    // =================== Measure ===================\n    measure: function measure() {\n      var status = this.status,\n          lastAffix = this.lastAffix;\n      var target = this.target;\n\n      if (status !== AffixStatus.Prepare || !this.$refs.fixedNode || !this.$refs.placeholderNode || !target) {\n        return;\n      }\n\n      var offsetTop = this.getOffsetTop();\n      var offsetBottom = this.getOffsetBottom();\n      var targetNode = target();\n\n      if (!targetNode) {\n        return;\n      }\n\n      var newState = {\n        status: AffixStatus.None\n      };\n      var targetRect = getTargetRect(targetNode);\n      var placeholderReact = getTargetRect(this.$refs.placeholderNode);\n      var fixedTop = getFixedTop(placeholderReact, targetRect, offsetTop);\n      var fixedBottom = getFixedBottom(placeholderReact, targetRect, offsetBottom);\n\n      if (fixedTop !== undefined) {\n        newState.affixStyle = {\n          position: 'fixed',\n          top: fixedTop,\n          width: placeholderReact.width + 'px',\n          height: placeholderReact.height + 'px'\n        };\n        newState.placeholderStyle = {\n          width: placeholderReact.width + 'px',\n          height: placeholderReact.height + 'px'\n        };\n      } else if (fixedBottom !== undefined) {\n        newState.affixStyle = {\n          position: 'fixed',\n          bottom: fixedBottom,\n          width: placeholderReact.width + 'px',\n          height: placeholderReact.height + 'px'\n        };\n        newState.placeholderStyle = {\n          width: placeholderReact.width + 'px',\n          height: placeholderReact.height + 'px'\n        };\n      }\n\n      newState.lastAffix = !!newState.affixStyle;\n\n      if (lastAffix !== newState.lastAffix) {\n        this.$emit('change', newState.lastAffix);\n      }\n\n      this.setState(newState);\n    },\n    // @ts-ignore TS6133\n    prepareMeasure: function prepareMeasure() {\n      this.setState({\n        status: AffixStatus.Prepare,\n        affixStyle: undefined,\n        placeholderStyle: undefined\n      });\n      this.$forceUpdate(); // Test if `updatePosition` called\n\n      if (process.env.NODE_ENV === 'test') {\n        this.$emit('testUpdatePosition');\n      }\n    },\n    updatePosition: function updatePosition() {\n      this.prepareMeasure();\n    },\n    lazyUpdatePosition: function lazyUpdatePosition() {\n      var target = this.target;\n      var affixStyle = this.affixStyle; // Check position change before measure to make Safari smooth\n\n      if (target && affixStyle) {\n        var offsetTop = this.getOffsetTop();\n        var offsetBottom = this.getOffsetBottom();\n        var targetNode = target();\n\n        if (targetNode && this.$refs.placeholderNode) {\n          var targetRect = getTargetRect(targetNode);\n          var placeholderReact = getTargetRect(this.$refs.placeholderNode);\n          var fixedTop = getFixedTop(placeholderReact, targetRect, offsetTop);\n          var fixedBottom = getFixedBottom(placeholderReact, targetRect, offsetBottom);\n\n          if (fixedTop !== undefined && affixStyle.top === fixedTop || fixedBottom !== undefined && affixStyle.bottom === fixedBottom) {\n            return;\n          }\n        }\n      } // Directly call prepare measure since it's already throttled.\n\n\n      this.prepareMeasure();\n    }\n  },\n  render: function render() {\n    var _this2 = this;\n\n    var h = arguments[0];\n    var prefixCls = this.prefixCls,\n        affixStyle = this.affixStyle,\n        placeholderStyle = this.placeholderStyle,\n        $slots = this.$slots,\n        $props = this.$props;\n    var getPrefixCls = this.configProvider.getPrefixCls;\n    var className = classNames(_defineProperty({}, getPrefixCls('affix', prefixCls), affixStyle));\n    var props = {\n      attrs: omit($props, ['prefixCls', 'offsetTop', 'offsetBottom', 'target'])\n    };\n    return h(ResizeObserver, {\n      on: {\n        'resize': function resize() {\n          _this2.updatePosition();\n        }\n      }\n    }, [h('div', _mergeJSXProps([props, {\n      style: placeholderStyle,\n      ref: 'placeholderNode'\n    }]), [h('div', {\n      'class': className,\n      ref: 'fixedNode',\n      style: affixStyle\n    }, [$slots['default']])])]);\n  }\n};\n/* istanbul ignore next */\n\nAffix.install = function (Vue) {\n  Vue.use(Base);\n  Vue.component(Affix.name, Affix);\n};\n\nexport default Affix;","map":{"version":3,"sources":["/Users/liulu/刘璐/vue3/hello-vue3/node_modules/ant-design-vue/es/affix/index.js"],"names":["_mergeJSXProps","_defineProperty","PropTypes","classNames","omit","ResizeObserver","BaseMixin","throttleByAnimationFrame","ConfigConsumerProps","Base","warning","addObserveTarget","removeObserveTarget","getTargetRect","getFixedTop","getFixedBottom","getDefaultTarget","window","AffixProps","offsetTop","number","offset","offsetBottom","target","func","def","prefixCls","string","AffixStatus","None","Prepare","Affix","name","props","mixins","inject","configProvider","_default","data","affixStyle","undefined","placeholderStyle","status","lastAffix","prevTarget","beforeMount","updatePosition","lazyUpdatePosition","mounted","_this","timeout","setTimeout","updated","measure","watch","val","newTarget","beforeDestroy","clearTimeout","cancel","methods","getOffsetTop","getOffsetBottom","$refs","fixedNode","placeholderNode","targetNode","newState","targetRect","placeholderReact","fixedTop","fixedBottom","position","top","width","height","bottom","$emit","setState","prepareMeasure","$forceUpdate","process","env","NODE_ENV","render","_this2","h","arguments","$slots","$props","getPrefixCls","className","attrs","on","resize","style","ref","install","Vue","use","component"],"mappings":"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","sourcesContent":["import _mergeJSXProps from 'babel-helper-vue-jsx-merge-props';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport PropTypes from '../_util/vue-types';\nimport classNames from 'classnames';\nimport omit from 'omit.js';\nimport ResizeObserver from '../vc-resize-observer';\nimport BaseMixin from '../_util/BaseMixin';\nimport throttleByAnimationFrame from '../_util/throttleByAnimationFrame';\nimport { ConfigConsumerProps } from '../config-provider/configConsumerProps';\nimport Base from '../base';\nimport warning from '../_util/warning';\nimport { addObserveTarget, removeObserveTarget, getTargetRect, getFixedTop, getFixedBottom } from './utils';\n\nfunction getDefaultTarget() {\n  return typeof window !== 'undefined' ? window : null;\n}\n\n// Affix\nvar AffixProps = {\n  /**\n   * 距离窗口顶部达到指定偏移量后触发\n   */\n  offsetTop: PropTypes.number,\n  offset: PropTypes.number,\n  /** 距离窗口底部达到指定偏移量后触发 */\n  offsetBottom: PropTypes.number,\n  /** 固定状态改变时触发的回调函数 */\n  // onChange?: (affixed?: boolean) => void;\n  /** 设置 Affix 需要监听其滚动事件的元素，值为一个返回对应 DOM 元素的函数 */\n  target: PropTypes.func.def(getDefaultTarget),\n  prefixCls: PropTypes.string\n};\nvar AffixStatus = {\n  None: 'none',\n  Prepare: 'Prepare'\n};\nvar Affix = {\n  name: 'AAffix',\n  props: AffixProps,\n  mixins: [BaseMixin],\n  inject: {\n    configProvider: { 'default': function _default() {\n        return ConfigConsumerProps;\n      } }\n  },\n  data: function data() {\n    return {\n      affixStyle: undefined,\n      placeholderStyle: undefined,\n      status: AffixStatus.None,\n      lastAffix: false,\n      prevTarget: null\n    };\n  },\n  beforeMount: function beforeMount() {\n    this.updatePosition = throttleByAnimationFrame(this.updatePosition);\n    this.lazyUpdatePosition = throttleByAnimationFrame(this.lazyUpdatePosition);\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    var target = this.target;\n\n    if (target) {\n      // [Legacy] Wait for parent component ref has its value.\n      // We should use target as directly element instead of function which makes element check hard.\n      this.timeout = setTimeout(function () {\n        addObserveTarget(target(), _this);\n        // Mock Event object.\n        _this.updatePosition();\n      });\n    }\n  },\n  updated: function updated() {\n    this.measure();\n  },\n\n  watch: {\n    target: function target(val) {\n      var newTarget = null;\n      if (val) {\n        newTarget = val() || null;\n      }\n      if (this.prevTarget !== newTarget) {\n        removeObserveTarget(this);\n        if (newTarget) {\n          addObserveTarget(newTarget, this);\n          // Mock Event object.\n          this.updatePosition();\n        }\n        this.prevTarget = newTarget;\n      }\n    },\n    offsetTop: function offsetTop() {\n      this.updatePosition();\n    },\n    offsetBottom: function offsetBottom() {\n      this.updatePosition();\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    clearTimeout(this.timeout);\n    removeObserveTarget(this);\n    this.updatePosition.cancel();\n    // https://github.com/ant-design/ant-design/issues/22683\n    this.lazyUpdatePosition.cancel();\n  },\n\n  methods: {\n    getOffsetTop: function getOffsetTop() {\n      var offset = this.offset,\n          offsetBottom = this.offsetBottom;\n      var offsetTop = this.offsetTop;\n\n      if (typeof offsetTop === 'undefined') {\n        offsetTop = offset;\n        warning(typeof offset === 'undefined', 'Affix', '`offset` is deprecated. Please use `offsetTop` instead.');\n      }\n\n      if (offsetBottom === undefined && offsetTop === undefined) {\n        offsetTop = 0;\n      }\n      return offsetTop;\n    },\n    getOffsetBottom: function getOffsetBottom() {\n      return this.offsetBottom;\n    },\n\n    // =================== Measure ===================\n    measure: function measure() {\n      var status = this.status,\n          lastAffix = this.lastAffix;\n      var target = this.target;\n\n      if (status !== AffixStatus.Prepare || !this.$refs.fixedNode || !this.$refs.placeholderNode || !target) {\n        return;\n      }\n\n      var offsetTop = this.getOffsetTop();\n      var offsetBottom = this.getOffsetBottom();\n\n      var targetNode = target();\n      if (!targetNode) {\n        return;\n      }\n\n      var newState = {\n        status: AffixStatus.None\n      };\n      var targetRect = getTargetRect(targetNode);\n      var placeholderReact = getTargetRect(this.$refs.placeholderNode);\n      var fixedTop = getFixedTop(placeholderReact, targetRect, offsetTop);\n      var fixedBottom = getFixedBottom(placeholderReact, targetRect, offsetBottom);\n      if (fixedTop !== undefined) {\n        newState.affixStyle = {\n          position: 'fixed',\n          top: fixedTop,\n          width: placeholderReact.width + 'px',\n          height: placeholderReact.height + 'px'\n        };\n        newState.placeholderStyle = {\n          width: placeholderReact.width + 'px',\n          height: placeholderReact.height + 'px'\n        };\n      } else if (fixedBottom !== undefined) {\n        newState.affixStyle = {\n          position: 'fixed',\n          bottom: fixedBottom,\n          width: placeholderReact.width + 'px',\n          height: placeholderReact.height + 'px'\n        };\n        newState.placeholderStyle = {\n          width: placeholderReact.width + 'px',\n          height: placeholderReact.height + 'px'\n        };\n      }\n\n      newState.lastAffix = !!newState.affixStyle;\n      if (lastAffix !== newState.lastAffix) {\n        this.$emit('change', newState.lastAffix);\n      }\n\n      this.setState(newState);\n    },\n\n\n    // @ts-ignore TS6133\n    prepareMeasure: function prepareMeasure() {\n      this.setState({\n        status: AffixStatus.Prepare,\n        affixStyle: undefined,\n        placeholderStyle: undefined\n      });\n      this.$forceUpdate();\n\n      // Test if `updatePosition` called\n      if (process.env.NODE_ENV === 'test') {\n        this.$emit('testUpdatePosition');\n      }\n    },\n    updatePosition: function updatePosition() {\n      this.prepareMeasure();\n    },\n    lazyUpdatePosition: function lazyUpdatePosition() {\n      var target = this.target;\n      var affixStyle = this.affixStyle;\n\n      // Check position change before measure to make Safari smooth\n\n      if (target && affixStyle) {\n        var offsetTop = this.getOffsetTop();\n        var offsetBottom = this.getOffsetBottom();\n\n        var targetNode = target();\n        if (targetNode && this.$refs.placeholderNode) {\n          var targetRect = getTargetRect(targetNode);\n          var placeholderReact = getTargetRect(this.$refs.placeholderNode);\n          var fixedTop = getFixedTop(placeholderReact, targetRect, offsetTop);\n          var fixedBottom = getFixedBottom(placeholderReact, targetRect, offsetBottom);\n\n          if (fixedTop !== undefined && affixStyle.top === fixedTop || fixedBottom !== undefined && affixStyle.bottom === fixedBottom) {\n            return;\n          }\n        }\n      }\n      // Directly call prepare measure since it's already throttled.\n      this.prepareMeasure();\n    }\n  },\n\n  render: function render() {\n    var _this2 = this;\n\n    var h = arguments[0];\n    var prefixCls = this.prefixCls,\n        affixStyle = this.affixStyle,\n        placeholderStyle = this.placeholderStyle,\n        $slots = this.$slots,\n        $props = this.$props;\n\n    var getPrefixCls = this.configProvider.getPrefixCls;\n    var className = classNames(_defineProperty({}, getPrefixCls('affix', prefixCls), affixStyle));\n\n    var props = {\n      attrs: omit($props, ['prefixCls', 'offsetTop', 'offsetBottom', 'target'])\n    };\n    return h(\n      ResizeObserver,\n      {\n        on: {\n          'resize': function resize() {\n            _this2.updatePosition();\n          }\n        }\n      },\n      [h(\n        'div',\n        _mergeJSXProps([props, { style: placeholderStyle, ref: 'placeholderNode' }]),\n        [h(\n          'div',\n          { 'class': className, ref: 'fixedNode', style: affixStyle },\n          [$slots['default']]\n        )]\n      )]\n    );\n  }\n};\n\n/* istanbul ignore next */\nAffix.install = function (Vue) {\n  Vue.use(Base);\n  Vue.component(Affix.name, Affix);\n};\n\nexport default Affix;"]},"metadata":{},"sourceType":"module"}