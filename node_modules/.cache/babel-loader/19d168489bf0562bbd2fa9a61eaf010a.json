{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _toConsumableArray from 'babel-runtime/helpers/toConsumableArray';\nimport PropTypes from '../../_util/vue-types';\nimport BaseMixin from '../../_util/BaseMixin';\nimport shallowEqual from 'shallowequal';\nimport TableRow from './TableRow';\nimport { remove } from './utils';\nimport { initDefaultProps, getOptionProps, getListeners } from '../../_util/props-util';\nexport var ExpandableTableProps = function ExpandableTableProps() {\n  return {\n    expandIconAsCell: PropTypes.bool,\n    expandRowByClick: PropTypes.bool,\n    expandedRowKeys: PropTypes.array,\n    expandedRowClassName: PropTypes.func,\n    defaultExpandAllRows: PropTypes.bool,\n    defaultExpandedRowKeys: PropTypes.array,\n    expandIconColumnIndex: PropTypes.number,\n    expandedRowRender: PropTypes.func,\n    expandIcon: PropTypes.func,\n    childrenColumnName: PropTypes.string,\n    indentSize: PropTypes.number,\n    // onExpand: PropTypes.func,\n    // onExpandedRowsChange: PropTypes.func,\n    columnManager: PropTypes.object.isRequired,\n    prefixCls: PropTypes.string.isRequired,\n    data: PropTypes.array,\n    getRowKey: PropTypes.func\n  };\n};\nvar ExpandableTable = {\n  name: 'ExpandableTable',\n  mixins: [BaseMixin],\n  props: initDefaultProps(ExpandableTableProps(), {\n    expandIconAsCell: false,\n    expandedRowClassName: function expandedRowClassName() {\n      return '';\n    },\n    expandIconColumnIndex: 0,\n    defaultExpandAllRows: false,\n    defaultExpandedRowKeys: [],\n    childrenColumnName: 'children',\n    indentSize: 15\n  }),\n  inject: {\n    store: {\n      from: 'table-store',\n      'default': function _default() {\n        return {};\n      }\n    }\n  },\n  data: function data() {\n    var data = this.data,\n        childrenColumnName = this.childrenColumnName,\n        defaultExpandAllRows = this.defaultExpandAllRows,\n        expandedRowKeys = this.expandedRowKeys,\n        defaultExpandedRowKeys = this.defaultExpandedRowKeys,\n        getRowKey = this.getRowKey;\n    var finalExpandedRowKeys = [];\n    var rows = [].concat(_toConsumableArray(data));\n\n    if (defaultExpandAllRows) {\n      for (var i = 0; i < rows.length; i += 1) {\n        var row = rows[i];\n        finalExpandedRowKeys.push(getRowKey(row, i));\n        rows = rows.concat(row[childrenColumnName] || []);\n      }\n    } else {\n      finalExpandedRowKeys = expandedRowKeys || defaultExpandedRowKeys;\n    } // this.columnManager = props.columnManager\n    // this.store = props.store\n\n\n    this.store.expandedRowsHeight = {};\n    this.store.expandedRowKeys = finalExpandedRowKeys;\n    return {};\n  },\n  mounted: function mounted() {\n    this.handleUpdated();\n  },\n  updated: function updated() {\n    this.handleUpdated();\n  },\n  watch: {\n    expandedRowKeys: function expandedRowKeys(val) {\n      var _this = this;\n\n      this.$nextTick(function () {\n        _this.store.expandedRowKeys = val;\n      });\n    }\n  },\n  methods: {\n    handleUpdated: function handleUpdated() {\n      // We should record latest expanded rows to avoid multiple rows remove cause `onExpandedRowsChange` trigger many times\n      this.latestExpandedRows = null;\n    },\n    handleExpandChange: function handleExpandChange(expanded, record, event, rowKey) {\n      var destroy = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n\n      if (event) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n\n      var expandedRowKeys = this.store.expandedRowKeys;\n\n      if (expanded) {\n        // row was expaned\n        expandedRowKeys = [].concat(_toConsumableArray(expandedRowKeys), [rowKey]);\n      } else {\n        // row was collapse\n        var expandedRowIndex = expandedRowKeys.indexOf(rowKey);\n\n        if (expandedRowIndex !== -1) {\n          expandedRowKeys = remove(expandedRowKeys, rowKey);\n        }\n      }\n\n      if (!this.expandedRowKeys) {\n        this.store.expandedRowKeys = expandedRowKeys;\n      } // De-dup of repeat call\n\n\n      if (!this.latestExpandedRows || !shallowEqual(this.latestExpandedRows, expandedRowKeys)) {\n        this.latestExpandedRows = expandedRowKeys;\n\n        this.__emit('expandedRowsChange', expandedRowKeys);\n\n        this.__emit('update:expandedRowKeys', expandedRowKeys);\n      }\n\n      if (!destroy) {\n        this.__emit('expand', expanded, record);\n      }\n    },\n    renderExpandIndentCell: function renderExpandIndentCell(rows, fixed) {\n      var prefixCls = this.prefixCls,\n          expandIconAsCell = this.expandIconAsCell;\n\n      if (!expandIconAsCell || fixed === 'right' || !rows.length) {\n        return;\n      }\n\n      var iconColumn = {\n        key: 'rc-table-expand-icon-cell',\n        className: prefixCls + '-expand-icon-th',\n        title: '',\n        rowSpan: rows.length\n      };\n      rows[0].unshift(_extends({}, iconColumn, {\n        column: iconColumn\n      }));\n    },\n    renderExpandedRow: function renderExpandedRow(record, index, expandedRowRender, className, ancestorKeys, indent, fixed) {\n      var _this2 = this;\n\n      var h = this.$createElement;\n      var prefixCls = this.prefixCls,\n          expandIconAsCell = this.expandIconAsCell,\n          indentSize = this.indentSize;\n      var parentKey = ancestorKeys[ancestorKeys.length - 1];\n      var rowKey = parentKey + '-extra-row';\n      var components = {\n        body: {\n          row: 'tr',\n          cell: 'td'\n        }\n      };\n      var colCount = void 0;\n\n      if (fixed === 'left') {\n        colCount = this.columnManager.leftLeafColumns().length;\n      } else if (fixed === 'right') {\n        colCount = this.columnManager.rightLeafColumns().length;\n      } else {\n        colCount = this.columnManager.leafColumns().length;\n      }\n\n      var columns = [{\n        key: 'extra-row',\n        customRender: function customRender() {\n          var expandedRowKeys = _this2.store.expandedRowKeys;\n          var expanded = expandedRowKeys.includes(parentKey);\n          return {\n            attrs: {\n              colSpan: colCount\n            },\n            children: fixed !== 'right' ? expandedRowRender(record, index, indent, expanded) : '&nbsp;'\n          };\n        }\n      }];\n\n      if (expandIconAsCell && fixed !== 'right') {\n        columns.unshift({\n          key: 'expand-icon-placeholder',\n          customRender: function customRender() {\n            return null;\n          }\n        });\n      }\n\n      return h(TableRow, {\n        key: rowKey,\n        attrs: {\n          columns: columns,\n          rowKey: rowKey,\n          ancestorKeys: ancestorKeys,\n          prefixCls: prefixCls + '-expanded-row',\n          indentSize: indentSize,\n          indent: indent,\n          fixed: fixed,\n          components: components,\n          expandedRow: true,\n          hasExpandIcon: function hasExpandIcon() {}\n        },\n        'class': className\n      });\n    },\n    renderRows: function renderRows(_renderRows, rows, record, index, indent, fixed, parentKey, ancestorKeys) {\n      var expandedRowClassName = this.expandedRowClassName,\n          expandedRowRender = this.expandedRowRender,\n          childrenColumnName = this.childrenColumnName;\n      var childrenData = record[childrenColumnName];\n      var nextAncestorKeys = [].concat(_toConsumableArray(ancestorKeys), [parentKey]);\n      var nextIndent = indent + 1;\n\n      if (expandedRowRender) {\n        rows.push(this.renderExpandedRow(record, index, expandedRowRender, expandedRowClassName(record, index, indent), nextAncestorKeys, nextIndent, fixed));\n      }\n\n      if (childrenData) {\n        rows.push.apply(rows, _toConsumableArray(_renderRows(childrenData, nextIndent, nextAncestorKeys)));\n      }\n    }\n  },\n  render: function render() {\n    var data = this.data,\n        childrenColumnName = this.childrenColumnName,\n        $scopedSlots = this.$scopedSlots;\n    var props = getOptionProps(this);\n    var needIndentSpaced = data.some(function (record) {\n      return record[childrenColumnName];\n    });\n    return $scopedSlots['default'] && $scopedSlots['default']({\n      props: props,\n      on: getListeners(this),\n      needIndentSpaced: needIndentSpaced,\n      renderRows: this.renderRows,\n      handleExpandChange: this.handleExpandChange,\n      renderExpandIndentCell: this.renderExpandIndentCell\n    });\n  }\n};\nexport default ExpandableTable;","map":{"version":3,"sources":["/Users/liulu/刘璐/vue3/hello-vue3/node_modules/ant-design-vue/es/vc-table/src/ExpandableTable.js"],"names":["_extends","_toConsumableArray","PropTypes","BaseMixin","shallowEqual","TableRow","remove","initDefaultProps","getOptionProps","getListeners","ExpandableTableProps","expandIconAsCell","bool","expandRowByClick","expandedRowKeys","array","expandedRowClassName","func","defaultExpandAllRows","defaultExpandedRowKeys","expandIconColumnIndex","number","expandedRowRender","expandIcon","childrenColumnName","string","indentSize","columnManager","object","isRequired","prefixCls","data","getRowKey","ExpandableTable","name","mixins","props","inject","store","from","_default","finalExpandedRowKeys","rows","concat","i","length","row","push","expandedRowsHeight","mounted","handleUpdated","updated","watch","val","_this","$nextTick","methods","latestExpandedRows","handleExpandChange","expanded","record","event","rowKey","destroy","arguments","undefined","preventDefault","stopPropagation","expandedRowIndex","indexOf","__emit","renderExpandIndentCell","fixed","iconColumn","key","className","title","rowSpan","unshift","column","renderExpandedRow","index","ancestorKeys","indent","_this2","h","$createElement","parentKey","components","body","cell","colCount","leftLeafColumns","rightLeafColumns","leafColumns","columns","customRender","includes","attrs","colSpan","children","expandedRow","hasExpandIcon","renderRows","_renderRows","childrenData","nextAncestorKeys","nextIndent","apply","render","$scopedSlots","needIndentSpaced","some","on"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _toConsumableArray from 'babel-runtime/helpers/toConsumableArray';\nimport PropTypes from '../../_util/vue-types';\nimport BaseMixin from '../../_util/BaseMixin';\nimport shallowEqual from 'shallowequal';\nimport TableRow from './TableRow';\nimport { remove } from './utils';\nimport { initDefaultProps, getOptionProps, getListeners } from '../../_util/props-util';\n\nexport var ExpandableTableProps = function ExpandableTableProps() {\n  return {\n    expandIconAsCell: PropTypes.bool,\n    expandRowByClick: PropTypes.bool,\n    expandedRowKeys: PropTypes.array,\n    expandedRowClassName: PropTypes.func,\n    defaultExpandAllRows: PropTypes.bool,\n    defaultExpandedRowKeys: PropTypes.array,\n    expandIconColumnIndex: PropTypes.number,\n    expandedRowRender: PropTypes.func,\n    expandIcon: PropTypes.func,\n    childrenColumnName: PropTypes.string,\n    indentSize: PropTypes.number,\n    // onExpand: PropTypes.func,\n    // onExpandedRowsChange: PropTypes.func,\n    columnManager: PropTypes.object.isRequired,\n    prefixCls: PropTypes.string.isRequired,\n    data: PropTypes.array,\n    getRowKey: PropTypes.func\n  };\n};\n\nvar ExpandableTable = {\n  name: 'ExpandableTable',\n  mixins: [BaseMixin],\n  props: initDefaultProps(ExpandableTableProps(), {\n    expandIconAsCell: false,\n    expandedRowClassName: function expandedRowClassName() {\n      return '';\n    },\n    expandIconColumnIndex: 0,\n    defaultExpandAllRows: false,\n    defaultExpandedRowKeys: [],\n    childrenColumnName: 'children',\n    indentSize: 15\n  }),\n  inject: {\n    store: { from: 'table-store', 'default': function _default() {\n        return {};\n      } }\n  },\n  data: function data() {\n    var data = this.data,\n        childrenColumnName = this.childrenColumnName,\n        defaultExpandAllRows = this.defaultExpandAllRows,\n        expandedRowKeys = this.expandedRowKeys,\n        defaultExpandedRowKeys = this.defaultExpandedRowKeys,\n        getRowKey = this.getRowKey;\n\n\n    var finalExpandedRowKeys = [];\n    var rows = [].concat(_toConsumableArray(data));\n\n    if (defaultExpandAllRows) {\n      for (var i = 0; i < rows.length; i += 1) {\n        var row = rows[i];\n        finalExpandedRowKeys.push(getRowKey(row, i));\n        rows = rows.concat(row[childrenColumnName] || []);\n      }\n    } else {\n      finalExpandedRowKeys = expandedRowKeys || defaultExpandedRowKeys;\n    }\n\n    // this.columnManager = props.columnManager\n    // this.store = props.store\n\n    this.store.expandedRowsHeight = {};\n    this.store.expandedRowKeys = finalExpandedRowKeys;\n    return {};\n  },\n  mounted: function mounted() {\n    this.handleUpdated();\n  },\n  updated: function updated() {\n    this.handleUpdated();\n  },\n\n  watch: {\n    expandedRowKeys: function expandedRowKeys(val) {\n      var _this = this;\n\n      this.$nextTick(function () {\n        _this.store.expandedRowKeys = val;\n      });\n    }\n  },\n  methods: {\n    handleUpdated: function handleUpdated() {\n      // We should record latest expanded rows to avoid multiple rows remove cause `onExpandedRowsChange` trigger many times\n      this.latestExpandedRows = null;\n    },\n    handleExpandChange: function handleExpandChange(expanded, record, event, rowKey) {\n      var destroy = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n\n      if (event) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n\n      var expandedRowKeys = this.store.expandedRowKeys;\n\n\n      if (expanded) {\n        // row was expaned\n        expandedRowKeys = [].concat(_toConsumableArray(expandedRowKeys), [rowKey]);\n      } else {\n        // row was collapse\n        var expandedRowIndex = expandedRowKeys.indexOf(rowKey);\n        if (expandedRowIndex !== -1) {\n          expandedRowKeys = remove(expandedRowKeys, rowKey);\n        }\n      }\n\n      if (!this.expandedRowKeys) {\n        this.store.expandedRowKeys = expandedRowKeys;\n      }\n      // De-dup of repeat call\n      if (!this.latestExpandedRows || !shallowEqual(this.latestExpandedRows, expandedRowKeys)) {\n        this.latestExpandedRows = expandedRowKeys;\n        this.__emit('expandedRowsChange', expandedRowKeys);\n        this.__emit('update:expandedRowKeys', expandedRowKeys);\n      }\n\n      if (!destroy) {\n        this.__emit('expand', expanded, record);\n      }\n    },\n    renderExpandIndentCell: function renderExpandIndentCell(rows, fixed) {\n      var prefixCls = this.prefixCls,\n          expandIconAsCell = this.expandIconAsCell;\n\n      if (!expandIconAsCell || fixed === 'right' || !rows.length) {\n        return;\n      }\n\n      var iconColumn = {\n        key: 'rc-table-expand-icon-cell',\n        className: prefixCls + '-expand-icon-th',\n        title: '',\n        rowSpan: rows.length\n      };\n\n      rows[0].unshift(_extends({}, iconColumn, { column: iconColumn }));\n    },\n    renderExpandedRow: function renderExpandedRow(record, index, expandedRowRender, className, ancestorKeys, indent, fixed) {\n      var _this2 = this;\n\n      var h = this.$createElement;\n      var prefixCls = this.prefixCls,\n          expandIconAsCell = this.expandIconAsCell,\n          indentSize = this.indentSize;\n\n      var parentKey = ancestorKeys[ancestorKeys.length - 1];\n      var rowKey = parentKey + '-extra-row';\n      var components = {\n        body: {\n          row: 'tr',\n          cell: 'td'\n        }\n      };\n      var colCount = void 0;\n      if (fixed === 'left') {\n        colCount = this.columnManager.leftLeafColumns().length;\n      } else if (fixed === 'right') {\n        colCount = this.columnManager.rightLeafColumns().length;\n      } else {\n        colCount = this.columnManager.leafColumns().length;\n      }\n      var columns = [{\n        key: 'extra-row',\n        customRender: function customRender() {\n          var expandedRowKeys = _this2.store.expandedRowKeys;\n\n          var expanded = expandedRowKeys.includes(parentKey);\n          return {\n            attrs: {\n              colSpan: colCount\n            },\n            children: fixed !== 'right' ? expandedRowRender(record, index, indent, expanded) : '&nbsp;'\n          };\n        }\n      }];\n      if (expandIconAsCell && fixed !== 'right') {\n        columns.unshift({\n          key: 'expand-icon-placeholder',\n          customRender: function customRender() {\n            return null;\n          }\n        });\n      }\n\n      return h(TableRow, {\n        key: rowKey,\n        attrs: { columns: columns,\n\n          rowKey: rowKey,\n          ancestorKeys: ancestorKeys,\n          prefixCls: prefixCls + '-expanded-row',\n          indentSize: indentSize,\n          indent: indent,\n          fixed: fixed,\n          components: components,\n          expandedRow: true,\n          hasExpandIcon: function hasExpandIcon() {}\n        },\n        'class': className });\n    },\n    renderRows: function renderRows(_renderRows, rows, record, index, indent, fixed, parentKey, ancestorKeys) {\n      var expandedRowClassName = this.expandedRowClassName,\n          expandedRowRender = this.expandedRowRender,\n          childrenColumnName = this.childrenColumnName;\n\n      var childrenData = record[childrenColumnName];\n      var nextAncestorKeys = [].concat(_toConsumableArray(ancestorKeys), [parentKey]);\n      var nextIndent = indent + 1;\n\n      if (expandedRowRender) {\n        rows.push(this.renderExpandedRow(record, index, expandedRowRender, expandedRowClassName(record, index, indent), nextAncestorKeys, nextIndent, fixed));\n      }\n\n      if (childrenData) {\n        rows.push.apply(rows, _toConsumableArray(_renderRows(childrenData, nextIndent, nextAncestorKeys)));\n      }\n    }\n  },\n\n  render: function render() {\n    var data = this.data,\n        childrenColumnName = this.childrenColumnName,\n        $scopedSlots = this.$scopedSlots;\n\n    var props = getOptionProps(this);\n    var needIndentSpaced = data.some(function (record) {\n      return record[childrenColumnName];\n    });\n\n    return $scopedSlots['default'] && $scopedSlots['default']({\n      props: props,\n      on: getListeners(this),\n      needIndentSpaced: needIndentSpaced,\n      renderRows: this.renderRows,\n      handleExpandChange: this.handleExpandChange,\n      renderExpandIndentCell: this.renderExpandIndentCell\n    });\n  }\n};\n\nexport default ExpandableTable;"]},"metadata":{},"sourceType":"module"}