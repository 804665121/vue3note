{"ast":null,"code":"import _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport PropTypes from '../../../_util/vue-types';\nimport BaseMixin from '../../../_util/BaseMixin';\nimport { hasProp } from '../../../_util/props-util';\nimport moment from 'moment';\nimport { isAllowedDate as _isAllowedDate, getTodayTime } from '../util/index';\n\nfunction noop() {}\n\nexport function getNowByCurrentStateValue(value) {\n  var ret = void 0;\n\n  if (value) {\n    ret = getTodayTime(value);\n  } else {\n    ret = moment();\n  }\n\n  return ret;\n}\n\nfunction isMoment(value) {\n  if (Array.isArray(value)) {\n    return value.length === 0 || value.findIndex(function (val) {\n      return val === undefined || moment.isMoment(val);\n    }) !== -1;\n  } else {\n    return value === undefined || moment.isMoment(value);\n  }\n}\n\nvar MomentType = PropTypes.custom(isMoment);\nvar CalendarMixin = {\n  mixins: [BaseMixin],\n  name: 'CalendarMixinWrapper',\n  props: {\n    value: MomentType,\n    defaultValue: MomentType\n  },\n  data: function data() {\n    var props = this.$props;\n    var sValue = props.value || props.defaultValue || getNowByCurrentStateValue();\n    return {\n      sValue: sValue,\n      sSelectedValue: props.selectedValue || props.defaultSelectedValue\n    };\n  },\n  watch: {\n    value: function value(val) {\n      var sValue = val || this.defaultValue || getNowByCurrentStateValue(this.sValue);\n      this.setState({\n        sValue: sValue\n      });\n    },\n    selectedValue: function selectedValue(val) {\n      this.setState({\n        sSelectedValue: val\n      });\n    }\n  },\n  methods: {\n    onSelect: function onSelect(value, cause) {\n      if (value) {\n        this.setValue(value);\n      }\n\n      this.setSelectedValue(value, cause);\n    },\n    renderRoot: function renderRoot(newProps) {\n      var _className;\n\n      var h = this.$createElement;\n      var props = this.$props;\n      var prefixCls = props.prefixCls;\n      var className = (_className = {}, _defineProperty(_className, prefixCls, 1), _defineProperty(_className, prefixCls + '-hidden', !props.visible), _defineProperty(_className, newProps['class'], !!newProps['class']), _className);\n      return h('div', {\n        ref: 'rootInstance',\n        'class': className,\n        attrs: {\n          tabIndex: '0'\n        },\n        on: {\n          'keydown': this.onKeyDown || noop,\n          'blur': this.onBlur || noop\n        }\n      }, [newProps.children]);\n    },\n    setSelectedValue: function setSelectedValue(selectedValue, cause) {\n      // if (this.isAllowedDate(selectedValue)) {\n      if (!hasProp(this, 'selectedValue')) {\n        this.setState({\n          sSelectedValue: selectedValue\n        });\n      }\n\n      this.__emit('select', selectedValue, cause); // }\n\n    },\n    setValue: function setValue(value) {\n      var originalValue = this.sValue;\n\n      if (!hasProp(this, 'value')) {\n        this.setState({\n          sValue: value\n        });\n      }\n\n      if (originalValue && value && !originalValue.isSame(value) || !originalValue && value || originalValue && !value) {\n        this.__emit('change', value);\n      }\n    },\n    isAllowedDate: function isAllowedDate(value) {\n      var disabledDate = this.disabledDate;\n      var disabledTime = this.disabledTime;\n      return _isAllowedDate(value, disabledDate, disabledTime);\n    }\n  }\n};\nexport default CalendarMixin;","map":{"version":3,"sources":["/Users/liulu/刘璐/vue3/hello-vue3/node_modules/ant-design-vue/es/vc-calendar/src/mixin/CalendarMixin.js"],"names":["_defineProperty","PropTypes","BaseMixin","hasProp","moment","isAllowedDate","_isAllowedDate","getTodayTime","noop","getNowByCurrentStateValue","value","ret","isMoment","Array","isArray","length","findIndex","val","undefined","MomentType","custom","CalendarMixin","mixins","name","props","defaultValue","data","$props","sValue","sSelectedValue","selectedValue","defaultSelectedValue","watch","setState","methods","onSelect","cause","setValue","setSelectedValue","renderRoot","newProps","_className","h","$createElement","prefixCls","className","visible","ref","attrs","tabIndex","on","onKeyDown","onBlur","children","__emit","originalValue","isSame","disabledDate","disabledTime"],"mappings":"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","sourcesContent":["import _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport PropTypes from '../../../_util/vue-types';\nimport BaseMixin from '../../../_util/BaseMixin';\nimport { hasProp } from '../../../_util/props-util';\nimport moment from 'moment';\nimport { isAllowedDate as _isAllowedDate, getTodayTime } from '../util/index';\nfunction noop() {}\n\nexport function getNowByCurrentStateValue(value) {\n  var ret = void 0;\n  if (value) {\n    ret = getTodayTime(value);\n  } else {\n    ret = moment();\n  }\n  return ret;\n}\nfunction isMoment(value) {\n  if (Array.isArray(value)) {\n    return value.length === 0 || value.findIndex(function (val) {\n      return val === undefined || moment.isMoment(val);\n    }) !== -1;\n  } else {\n    return value === undefined || moment.isMoment(value);\n  }\n}\nvar MomentType = PropTypes.custom(isMoment);\nvar CalendarMixin = {\n  mixins: [BaseMixin],\n  name: 'CalendarMixinWrapper',\n  props: {\n    value: MomentType,\n    defaultValue: MomentType\n  },\n\n  data: function data() {\n    var props = this.$props;\n    var sValue = props.value || props.defaultValue || getNowByCurrentStateValue();\n    return {\n      sValue: sValue,\n      sSelectedValue: props.selectedValue || props.defaultSelectedValue\n    };\n  },\n\n  watch: {\n    value: function value(val) {\n      var sValue = val || this.defaultValue || getNowByCurrentStateValue(this.sValue);\n      this.setState({\n        sValue: sValue\n      });\n    },\n    selectedValue: function selectedValue(val) {\n      this.setState({\n        sSelectedValue: val\n      });\n    }\n  },\n  methods: {\n    onSelect: function onSelect(value, cause) {\n      if (value) {\n        this.setValue(value);\n      }\n      this.setSelectedValue(value, cause);\n    },\n    renderRoot: function renderRoot(newProps) {\n      var _className;\n\n      var h = this.$createElement;\n\n      var props = this.$props;\n      var prefixCls = props.prefixCls;\n\n      var className = (_className = {}, _defineProperty(_className, prefixCls, 1), _defineProperty(_className, prefixCls + '-hidden', !props.visible), _defineProperty(_className, newProps['class'], !!newProps['class']), _className);\n      return h(\n        'div',\n        {\n          ref: 'rootInstance',\n          'class': className,\n          attrs: { tabIndex: '0'\n          },\n          on: {\n            'keydown': this.onKeyDown || noop,\n            'blur': this.onBlur || noop\n          }\n        },\n        [newProps.children]\n      );\n    },\n    setSelectedValue: function setSelectedValue(selectedValue, cause) {\n      // if (this.isAllowedDate(selectedValue)) {\n      if (!hasProp(this, 'selectedValue')) {\n        this.setState({\n          sSelectedValue: selectedValue\n        });\n      }\n      this.__emit('select', selectedValue, cause);\n      // }\n    },\n    setValue: function setValue(value) {\n      var originalValue = this.sValue;\n      if (!hasProp(this, 'value')) {\n        this.setState({\n          sValue: value\n        });\n      }\n      if (originalValue && value && !originalValue.isSame(value) || !originalValue && value || originalValue && !value) {\n        this.__emit('change', value);\n      }\n    },\n    isAllowedDate: function isAllowedDate(value) {\n      var disabledDate = this.disabledDate;\n      var disabledTime = this.disabledTime;\n      return _isAllowedDate(value, disabledDate, disabledTime);\n    }\n  }\n};\n\nexport default CalendarMixin;"]},"metadata":{},"sourceType":"module"}