{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport _extends from 'babel-runtime/helpers/extends';\nimport AsyncValidator from 'async-validator';\nimport cloneDeep from 'lodash/cloneDeep';\nimport PropTypes from '../_util/vue-types';\nimport { ColProps } from '../grid/Col';\nimport { initDefaultProps, getComponentFromProp, getOptionProps, getEvents, filterEmpty, isValidElement } from '../_util/props-util';\nimport BaseMixin from '../_util/BaseMixin';\nimport { ConfigConsumerProps } from '../config-provider/configConsumerProps';\nimport FormItem from '../form/FormItem';\nimport { cloneElement } from '../_util/vnode';\n\nfunction noop() {}\n\nfunction getPropByPath(obj, path, strict) {\n  var tempObj = obj;\n  path = path.replace(/\\[(\\w+)\\]/g, '.$1');\n  path = path.replace(/^\\./, '');\n  var keyArr = path.split('.');\n  var i = 0;\n\n  for (var len = keyArr.length; i < len - 1; ++i) {\n    if (!tempObj && !strict) break;\n    var key = keyArr[i];\n\n    if (key in tempObj) {\n      tempObj = tempObj[key];\n    } else {\n      if (strict) {\n        throw new Error('please transfer a valid prop path to form item!');\n      }\n\n      break;\n    }\n  }\n\n  return {\n    o: tempObj,\n    k: keyArr[i],\n    v: tempObj ? tempObj[keyArr[i]] : null\n  };\n}\n\nexport var FormItemProps = {\n  id: PropTypes.string,\n  htmlFor: PropTypes.string,\n  prefixCls: PropTypes.string,\n  label: PropTypes.any,\n  help: PropTypes.any,\n  extra: PropTypes.any,\n  labelCol: PropTypes.shape(ColProps).loose,\n  wrapperCol: PropTypes.shape(ColProps).loose,\n  hasFeedback: PropTypes.bool,\n  colon: PropTypes.bool,\n  labelAlign: PropTypes.oneOf(['left', 'right']),\n  prop: PropTypes.string,\n  rules: PropTypes.oneOfType([Array, Object]),\n  autoLink: PropTypes.bool,\n  required: PropTypes.bool,\n  validateStatus: PropTypes.oneOf(['', 'success', 'warning', 'error', 'validating'])\n};\nexport default {\n  name: 'AFormModelItem',\n  __ANT_NEW_FORM_ITEM: true,\n  mixins: [BaseMixin],\n  props: initDefaultProps(FormItemProps, {\n    hasFeedback: false,\n    autoLink: true\n  }),\n  inject: {\n    configProvider: {\n      'default': function _default() {\n        return ConfigConsumerProps;\n      }\n    },\n    FormContext: {\n      'default': function _default() {\n        return {};\n      }\n    }\n  },\n  data: function data() {\n    return {\n      validateState: this.validateStatus,\n      validateMessage: '',\n      validateDisabled: false,\n      validator: {}\n    };\n  },\n  computed: {\n    fieldValue: function fieldValue() {\n      var model = this.FormContext.model;\n\n      if (!model || !this.prop) {\n        return;\n      }\n\n      var path = this.prop;\n\n      if (path.indexOf(':') !== -1) {\n        path = path.replace(/:/g, '.');\n      }\n\n      return getPropByPath(model, path, true).v;\n    },\n    isRequired: function isRequired() {\n      var rules = this.getRules();\n      var isRequired = false;\n\n      if (rules && rules.length) {\n        rules.every(function (rule) {\n          if (rule.required) {\n            isRequired = true;\n            return false;\n          }\n\n          return true;\n        });\n      }\n\n      return isRequired;\n    }\n  },\n  watch: {\n    validateStatus: function validateStatus(val) {\n      this.validateState = val;\n    }\n  },\n  mounted: function mounted() {\n    if (this.prop) {\n      var addField = this.FormContext.addField;\n      addField && addField(this);\n      this.initialValue = cloneDeep(this.fieldValue);\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    var removeField = this.FormContext.removeField;\n    removeField && removeField(this);\n  },\n  methods: {\n    validate: function validate(trigger) {\n      var _this = this;\n\n      var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : noop;\n      this.validateDisabled = false;\n      var rules = this.getFilteredRule(trigger);\n\n      if (!rules || rules.length === 0) {\n        callback();\n        return true;\n      }\n\n      this.validateState = 'validating';\n      var descriptor = {};\n\n      if (rules && rules.length > 0) {\n        rules.forEach(function (rule) {\n          delete rule.trigger;\n        });\n      }\n\n      descriptor[this.prop] = rules;\n      var validator = new AsyncValidator(descriptor);\n\n      if (this.FormContext && this.FormContext.validateMessages) {\n        validator.messages(this.FormContext.validateMessages);\n      }\n\n      var model = {};\n      model[this.prop] = this.fieldValue;\n      validator.validate(model, {\n        firstFields: true\n      }, function (errors, invalidFields) {\n        _this.validateState = errors ? 'error' : 'success';\n        _this.validateMessage = errors ? errors[0].message : '';\n        callback(_this.validateMessage, invalidFields);\n        _this.FormContext && _this.FormContext.$emit && _this.FormContext.$emit('validate', _this.prop, !errors, _this.validateMessage || null);\n      });\n    },\n    getRules: function getRules() {\n      var formRules = this.FormContext.rules;\n      var selfRules = this.rules;\n      var requiredRule = this.required !== undefined ? {\n        required: !!this.required,\n        trigger: 'change'\n      } : [];\n      var prop = getPropByPath(formRules, this.prop || '');\n      formRules = formRules ? prop.o[this.prop || ''] || prop.v : [];\n      return [].concat(selfRules || formRules || []).concat(requiredRule);\n    },\n    getFilteredRule: function getFilteredRule(trigger) {\n      var rules = this.getRules();\n      return rules.filter(function (rule) {\n        if (!rule.trigger || trigger === '') return true;\n\n        if (Array.isArray(rule.trigger)) {\n          return rule.trigger.indexOf(trigger) > -1;\n        } else {\n          return rule.trigger === trigger;\n        }\n      }).map(function (rule) {\n        return _extends({}, rule);\n      });\n    },\n    onFieldBlur: function onFieldBlur() {\n      this.validate('blur');\n    },\n    onFieldChange: function onFieldChange() {\n      if (this.validateDisabled) {\n        this.validateDisabled = false;\n        return;\n      }\n\n      this.validate('change');\n    },\n    clearValidate: function clearValidate() {\n      this.validateState = '';\n      this.validateMessage = '';\n      this.validateDisabled = false;\n    },\n    resetField: function resetField() {\n      var _this2 = this;\n\n      this.validateState = '';\n      this.validateMessage = '';\n      var model = this.FormContext.model || {};\n      var value = this.fieldValue;\n      var path = this.prop;\n\n      if (path.indexOf(':') !== -1) {\n        path = path.replace(/:/, '.');\n      }\n\n      var prop = getPropByPath(model, path, true);\n      this.validateDisabled = true;\n\n      if (Array.isArray(value)) {\n        prop.o[prop.k] = [].concat(this.initialValue);\n      } else {\n        prop.o[prop.k] = this.initialValue;\n      } // reset validateDisabled after onFieldChange triggered\n\n\n      this.$nextTick(function () {\n        _this2.validateDisabled = false;\n      });\n    }\n  },\n  render: function render() {\n    var _this3 = this;\n\n    var h = arguments[0];\n    var $slots = this.$slots,\n        $scopedSlots = this.$scopedSlots;\n    var props = getOptionProps(this);\n    var label = getComponentFromProp(this, 'label');\n    var extra = getComponentFromProp(this, 'extra');\n    var help = getComponentFromProp(this, 'help');\n    var formProps = {\n      props: _extends({}, props, {\n        label: label,\n        extra: extra,\n        validateStatus: this.validateState,\n        help: this.validateMessage || help,\n        required: this.isRequired || props.required\n      })\n    };\n    var children = filterEmpty($scopedSlots['default'] ? $scopedSlots['default']() : $slots['default']);\n    var firstChildren = children[0];\n\n    if (this.prop && this.autoLink && isValidElement(firstChildren)) {\n      var originalEvents = getEvents(firstChildren);\n      var originalBlur = originalEvents.blur;\n      var originalChange = originalEvents.change;\n      firstChildren = cloneElement(firstChildren, {\n        on: {\n          blur: function blur() {\n            originalBlur && originalBlur.apply(undefined, arguments);\n\n            _this3.onFieldBlur();\n          },\n          change: function change() {\n            if (Array.isArray(originalChange)) {\n              for (var i = 0, l = originalChange.length; i < l; i++) {\n                originalChange[i].apply(originalChange, arguments);\n              }\n            } else if (originalChange) {\n              originalChange.apply(undefined, arguments);\n            }\n\n            _this3.onFieldChange();\n          }\n        }\n      });\n    }\n\n    return h(FormItem, formProps, [firstChildren, children.slice(1)]);\n  }\n};","map":{"version":3,"sources":["/Users/liulu/刘璐/vue3/hello-vue3/node_modules/ant-design-vue/es/form-model/FormItem.js"],"names":["_extends","AsyncValidator","cloneDeep","PropTypes","ColProps","initDefaultProps","getComponentFromProp","getOptionProps","getEvents","filterEmpty","isValidElement","BaseMixin","ConfigConsumerProps","FormItem","cloneElement","noop","getPropByPath","obj","path","strict","tempObj","replace","keyArr","split","i","len","length","key","Error","o","k","v","FormItemProps","id","string","htmlFor","prefixCls","label","any","help","extra","labelCol","shape","loose","wrapperCol","hasFeedback","bool","colon","labelAlign","oneOf","prop","rules","oneOfType","Array","Object","autoLink","required","validateStatus","name","__ANT_NEW_FORM_ITEM","mixins","props","inject","configProvider","_default","FormContext","data","validateState","validateMessage","validateDisabled","validator","computed","fieldValue","model","indexOf","isRequired","getRules","every","rule","watch","val","mounted","addField","initialValue","beforeDestroy","removeField","methods","validate","trigger","_this","callback","arguments","undefined","getFilteredRule","descriptor","forEach","validateMessages","messages","firstFields","errors","invalidFields","message","$emit","formRules","selfRules","requiredRule","concat","filter","isArray","map","onFieldBlur","onFieldChange","clearValidate","resetField","_this2","value","$nextTick","render","_this3","h","$slots","$scopedSlots","formProps","children","firstChildren","originalEvents","originalBlur","blur","originalChange","change","on","apply","l","slice"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport AsyncValidator from 'async-validator';\nimport cloneDeep from 'lodash/cloneDeep';\nimport PropTypes from '../_util/vue-types';\nimport { ColProps } from '../grid/Col';\nimport { initDefaultProps, getComponentFromProp, getOptionProps, getEvents, filterEmpty, isValidElement } from '../_util/props-util';\nimport BaseMixin from '../_util/BaseMixin';\nimport { ConfigConsumerProps } from '../config-provider/configConsumerProps';\nimport FormItem from '../form/FormItem';\nimport { cloneElement } from '../_util/vnode';\n\nfunction noop() {}\n\nfunction getPropByPath(obj, path, strict) {\n  var tempObj = obj;\n  path = path.replace(/\\[(\\w+)\\]/g, '.$1');\n  path = path.replace(/^\\./, '');\n\n  var keyArr = path.split('.');\n  var i = 0;\n  for (var len = keyArr.length; i < len - 1; ++i) {\n    if (!tempObj && !strict) break;\n    var key = keyArr[i];\n    if (key in tempObj) {\n      tempObj = tempObj[key];\n    } else {\n      if (strict) {\n        throw new Error('please transfer a valid prop path to form item!');\n      }\n      break;\n    }\n  }\n  return {\n    o: tempObj,\n    k: keyArr[i],\n    v: tempObj ? tempObj[keyArr[i]] : null\n  };\n}\nexport var FormItemProps = {\n  id: PropTypes.string,\n  htmlFor: PropTypes.string,\n  prefixCls: PropTypes.string,\n  label: PropTypes.any,\n  help: PropTypes.any,\n  extra: PropTypes.any,\n  labelCol: PropTypes.shape(ColProps).loose,\n  wrapperCol: PropTypes.shape(ColProps).loose,\n  hasFeedback: PropTypes.bool,\n  colon: PropTypes.bool,\n  labelAlign: PropTypes.oneOf(['left', 'right']),\n  prop: PropTypes.string,\n  rules: PropTypes.oneOfType([Array, Object]),\n  autoLink: PropTypes.bool,\n  required: PropTypes.bool,\n  validateStatus: PropTypes.oneOf(['', 'success', 'warning', 'error', 'validating'])\n};\n\nexport default {\n  name: 'AFormModelItem',\n  __ANT_NEW_FORM_ITEM: true,\n  mixins: [BaseMixin],\n  props: initDefaultProps(FormItemProps, {\n    hasFeedback: false,\n    autoLink: true\n  }),\n  inject: {\n    configProvider: { 'default': function _default() {\n        return ConfigConsumerProps;\n      } },\n    FormContext: { 'default': function _default() {\n        return {};\n      } }\n  },\n  data: function data() {\n    return {\n      validateState: this.validateStatus,\n      validateMessage: '',\n      validateDisabled: false,\n      validator: {}\n    };\n  },\n\n\n  computed: {\n    fieldValue: function fieldValue() {\n      var model = this.FormContext.model;\n      if (!model || !this.prop) {\n        return;\n      }\n      var path = this.prop;\n      if (path.indexOf(':') !== -1) {\n        path = path.replace(/:/g, '.');\n      }\n      return getPropByPath(model, path, true).v;\n    },\n    isRequired: function isRequired() {\n      var rules = this.getRules();\n      var isRequired = false;\n      if (rules && rules.length) {\n        rules.every(function (rule) {\n          if (rule.required) {\n            isRequired = true;\n            return false;\n          }\n          return true;\n        });\n      }\n      return isRequired;\n    }\n  },\n  watch: {\n    validateStatus: function validateStatus(val) {\n      this.validateState = val;\n    }\n  },\n  mounted: function mounted() {\n    if (this.prop) {\n      var addField = this.FormContext.addField;\n\n      addField && addField(this);\n      this.initialValue = cloneDeep(this.fieldValue);\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    var removeField = this.FormContext.removeField;\n\n    removeField && removeField(this);\n  },\n\n  methods: {\n    validate: function validate(trigger) {\n      var _this = this;\n\n      var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : noop;\n\n      this.validateDisabled = false;\n      var rules = this.getFilteredRule(trigger);\n      if (!rules || rules.length === 0) {\n        callback();\n        return true;\n      }\n      this.validateState = 'validating';\n      var descriptor = {};\n      if (rules && rules.length > 0) {\n        rules.forEach(function (rule) {\n          delete rule.trigger;\n        });\n      }\n      descriptor[this.prop] = rules;\n      var validator = new AsyncValidator(descriptor);\n      if (this.FormContext && this.FormContext.validateMessages) {\n        validator.messages(this.FormContext.validateMessages);\n      }\n      var model = {};\n      model[this.prop] = this.fieldValue;\n      validator.validate(model, { firstFields: true }, function (errors, invalidFields) {\n        _this.validateState = errors ? 'error' : 'success';\n        _this.validateMessage = errors ? errors[0].message : '';\n        callback(_this.validateMessage, invalidFields);\n        _this.FormContext && _this.FormContext.$emit && _this.FormContext.$emit('validate', _this.prop, !errors, _this.validateMessage || null);\n      });\n    },\n    getRules: function getRules() {\n      var formRules = this.FormContext.rules;\n      var selfRules = this.rules;\n      var requiredRule = this.required !== undefined ? { required: !!this.required, trigger: 'change' } : [];\n      var prop = getPropByPath(formRules, this.prop || '');\n      formRules = formRules ? prop.o[this.prop || ''] || prop.v : [];\n      return [].concat(selfRules || formRules || []).concat(requiredRule);\n    },\n    getFilteredRule: function getFilteredRule(trigger) {\n      var rules = this.getRules();\n      return rules.filter(function (rule) {\n        if (!rule.trigger || trigger === '') return true;\n        if (Array.isArray(rule.trigger)) {\n          return rule.trigger.indexOf(trigger) > -1;\n        } else {\n          return rule.trigger === trigger;\n        }\n      }).map(function (rule) {\n        return _extends({}, rule);\n      });\n    },\n    onFieldBlur: function onFieldBlur() {\n      this.validate('blur');\n    },\n    onFieldChange: function onFieldChange() {\n      if (this.validateDisabled) {\n        this.validateDisabled = false;\n        return;\n      }\n      this.validate('change');\n    },\n    clearValidate: function clearValidate() {\n      this.validateState = '';\n      this.validateMessage = '';\n      this.validateDisabled = false;\n    },\n    resetField: function resetField() {\n      var _this2 = this;\n\n      this.validateState = '';\n      this.validateMessage = '';\n      var model = this.FormContext.model || {};\n      var value = this.fieldValue;\n      var path = this.prop;\n      if (path.indexOf(':') !== -1) {\n        path = path.replace(/:/, '.');\n      }\n      var prop = getPropByPath(model, path, true);\n      this.validateDisabled = true;\n      if (Array.isArray(value)) {\n        prop.o[prop.k] = [].concat(this.initialValue);\n      } else {\n        prop.o[prop.k] = this.initialValue;\n      }\n      // reset validateDisabled after onFieldChange triggered\n      this.$nextTick(function () {\n        _this2.validateDisabled = false;\n      });\n    }\n  },\n  render: function render() {\n    var _this3 = this;\n\n    var h = arguments[0];\n    var $slots = this.$slots,\n        $scopedSlots = this.$scopedSlots;\n\n    var props = getOptionProps(this);\n    var label = getComponentFromProp(this, 'label');\n    var extra = getComponentFromProp(this, 'extra');\n    var help = getComponentFromProp(this, 'help');\n    var formProps = {\n      props: _extends({}, props, {\n        label: label,\n        extra: extra,\n        validateStatus: this.validateState,\n        help: this.validateMessage || help,\n        required: this.isRequired || props.required\n      })\n    };\n    var children = filterEmpty($scopedSlots['default'] ? $scopedSlots['default']() : $slots['default']);\n    var firstChildren = children[0];\n    if (this.prop && this.autoLink && isValidElement(firstChildren)) {\n      var originalEvents = getEvents(firstChildren);\n      var originalBlur = originalEvents.blur;\n      var originalChange = originalEvents.change;\n      firstChildren = cloneElement(firstChildren, {\n        on: {\n          blur: function blur() {\n            originalBlur && originalBlur.apply(undefined, arguments);\n            _this3.onFieldBlur();\n          },\n          change: function change() {\n            if (Array.isArray(originalChange)) {\n              for (var i = 0, l = originalChange.length; i < l; i++) {\n                originalChange[i].apply(originalChange, arguments);\n              }\n            } else if (originalChange) {\n              originalChange.apply(undefined, arguments);\n            }\n            _this3.onFieldChange();\n          }\n        }\n      });\n    }\n    return h(\n      FormItem,\n      formProps,\n      [firstChildren, children.slice(1)]\n    );\n  }\n};"]},"metadata":{},"sourceType":"module"}