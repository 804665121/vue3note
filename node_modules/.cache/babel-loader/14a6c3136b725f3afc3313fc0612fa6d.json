{"ast":null,"code":"import _mergeJSXProps from 'babel-helper-vue-jsx-merge-props';\nimport _extends from 'babel-runtime/helpers/extends';\nimport shallowEqual from 'shallowequal';\nimport omit from 'omit.js';\nimport { getOptionProps, getListeners } from '../props-util';\nimport PropTypes from '../vue-types';\nimport proxyComponent from '../proxyComponent';\n\nfunction getDisplayName(WrappedComponent) {\n  return WrappedComponent.name || 'Component';\n}\n\nvar defaultMapStateToProps = function defaultMapStateToProps() {\n  return {};\n};\n\nexport default function connect(mapStateToProps) {\n  var shouldSubscribe = !!mapStateToProps;\n  var finalMapStateToProps = mapStateToProps || defaultMapStateToProps;\n  return function wrapWithConnect(WrappedComponent) {\n    var tempProps = omit(WrappedComponent.props || {}, ['store']);\n    var props = {\n      __propsSymbol__: PropTypes.any\n    };\n    Object.keys(tempProps).forEach(function (k) {\n      props[k] = _extends({}, tempProps[k], {\n        required: false\n      });\n    });\n    var Connect = {\n      name: 'Connect_' + getDisplayName(WrappedComponent),\n      props: props,\n      inject: {\n        storeContext: {\n          'default': function _default() {\n            return {};\n          }\n        }\n      },\n      data: function data() {\n        this.store = this.storeContext.store;\n        this.preProps = omit(getOptionProps(this), ['__propsSymbol__']);\n        return {\n          subscribed: finalMapStateToProps(this.store.getState(), this.$props)\n        };\n      },\n      watch: {\n        __propsSymbol__: function __propsSymbol__() {\n          if (mapStateToProps && mapStateToProps.length === 2) {\n            this.subscribed = finalMapStateToProps(this.store.getState(), this.$props);\n          }\n        }\n      },\n      mounted: function mounted() {\n        this.trySubscribe();\n      },\n      beforeDestroy: function beforeDestroy() {\n        this.tryUnsubscribe();\n      },\n      methods: {\n        handleChange: function handleChange() {\n          if (!this.unsubscribe) {\n            return;\n          }\n\n          var props = omit(getOptionProps(this), ['__propsSymbol__']);\n          var nextSubscribed = finalMapStateToProps(this.store.getState(), props);\n\n          if (!shallowEqual(this.preProps, props) || !shallowEqual(this.subscribed, nextSubscribed)) {\n            this.subscribed = nextSubscribed;\n          }\n        },\n        trySubscribe: function trySubscribe() {\n          if (shouldSubscribe) {\n            this.unsubscribe = this.store.subscribe(this.handleChange);\n            this.handleChange();\n          }\n        },\n        tryUnsubscribe: function tryUnsubscribe() {\n          if (this.unsubscribe) {\n            this.unsubscribe();\n            this.unsubscribe = null;\n          }\n        },\n        getWrappedInstance: function getWrappedInstance() {\n          return this.$refs.wrappedInstance;\n        }\n      },\n      render: function render() {\n        var h = arguments[0];\n        var _$slots = this.$slots,\n            $slots = _$slots === undefined ? {} : _$slots,\n            $scopedSlots = this.$scopedSlots,\n            subscribed = this.subscribed,\n            store = this.store;\n        var props = getOptionProps(this);\n        this.preProps = _extends({}, omit(props, ['__propsSymbol__']));\n        var wrapProps = {\n          props: _extends({}, props, subscribed, {\n            store: store\n          }),\n          on: getListeners(this),\n          scopedSlots: $scopedSlots\n        };\n        return h(WrappedComponent, _mergeJSXProps([wrapProps, {\n          ref: 'wrappedInstance'\n        }]), [Object.keys($slots).map(function (name) {\n          return h('template', {\n            slot: name\n          }, [$slots[name]]);\n        })]);\n      }\n    };\n    return proxyComponent(Connect);\n  };\n}","map":{"version":3,"sources":["/Users/liulu/刘璐/vue3/hello-vue3/node_modules/ant-design-vue/es/_util/store/connect.js"],"names":["_mergeJSXProps","_extends","shallowEqual","omit","getOptionProps","getListeners","PropTypes","proxyComponent","getDisplayName","WrappedComponent","name","defaultMapStateToProps","connect","mapStateToProps","shouldSubscribe","finalMapStateToProps","wrapWithConnect","tempProps","props","__propsSymbol__","any","Object","keys","forEach","k","required","Connect","inject","storeContext","_default","data","store","preProps","subscribed","getState","$props","watch","length","mounted","trySubscribe","beforeDestroy","tryUnsubscribe","methods","handleChange","unsubscribe","nextSubscribed","subscribe","getWrappedInstance","$refs","wrappedInstance","render","h","arguments","_$slots","$slots","undefined","$scopedSlots","wrapProps","on","scopedSlots","ref","map","slot"],"mappings":"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","sourcesContent":["import _mergeJSXProps from 'babel-helper-vue-jsx-merge-props';\nimport _extends from 'babel-runtime/helpers/extends';\nimport shallowEqual from 'shallowequal';\nimport omit from 'omit.js';\nimport { getOptionProps, getListeners } from '../props-util';\nimport PropTypes from '../vue-types';\nimport proxyComponent from '../proxyComponent';\n\nfunction getDisplayName(WrappedComponent) {\n  return WrappedComponent.name || 'Component';\n}\n\nvar defaultMapStateToProps = function defaultMapStateToProps() {\n  return {};\n};\nexport default function connect(mapStateToProps) {\n  var shouldSubscribe = !!mapStateToProps;\n  var finalMapStateToProps = mapStateToProps || defaultMapStateToProps;\n  return function wrapWithConnect(WrappedComponent) {\n    var tempProps = omit(WrappedComponent.props || {}, ['store']);\n    var props = {\n      __propsSymbol__: PropTypes.any\n    };\n    Object.keys(tempProps).forEach(function (k) {\n      props[k] = _extends({}, tempProps[k], { required: false });\n    });\n    var Connect = {\n      name: 'Connect_' + getDisplayName(WrappedComponent),\n      props: props,\n      inject: {\n        storeContext: { 'default': function _default() {\n            return {};\n          } }\n      },\n      data: function data() {\n        this.store = this.storeContext.store;\n        this.preProps = omit(getOptionProps(this), ['__propsSymbol__']);\n        return {\n          subscribed: finalMapStateToProps(this.store.getState(), this.$props)\n        };\n      },\n\n      watch: {\n        __propsSymbol__: function __propsSymbol__() {\n          if (mapStateToProps && mapStateToProps.length === 2) {\n            this.subscribed = finalMapStateToProps(this.store.getState(), this.$props);\n          }\n        }\n      },\n      mounted: function mounted() {\n        this.trySubscribe();\n      },\n      beforeDestroy: function beforeDestroy() {\n        this.tryUnsubscribe();\n      },\n\n      methods: {\n        handleChange: function handleChange() {\n          if (!this.unsubscribe) {\n            return;\n          }\n          var props = omit(getOptionProps(this), ['__propsSymbol__']);\n          var nextSubscribed = finalMapStateToProps(this.store.getState(), props);\n          if (!shallowEqual(this.preProps, props) || !shallowEqual(this.subscribed, nextSubscribed)) {\n            this.subscribed = nextSubscribed;\n          }\n        },\n        trySubscribe: function trySubscribe() {\n          if (shouldSubscribe) {\n            this.unsubscribe = this.store.subscribe(this.handleChange);\n            this.handleChange();\n          }\n        },\n        tryUnsubscribe: function tryUnsubscribe() {\n          if (this.unsubscribe) {\n            this.unsubscribe();\n            this.unsubscribe = null;\n          }\n        },\n        getWrappedInstance: function getWrappedInstance() {\n          return this.$refs.wrappedInstance;\n        }\n      },\n      render: function render() {\n        var h = arguments[0];\n        var _$slots = this.$slots,\n            $slots = _$slots === undefined ? {} : _$slots,\n            $scopedSlots = this.$scopedSlots,\n            subscribed = this.subscribed,\n            store = this.store;\n\n        var props = getOptionProps(this);\n        this.preProps = _extends({}, omit(props, ['__propsSymbol__']));\n        var wrapProps = {\n          props: _extends({}, props, subscribed, {\n            store: store\n          }),\n          on: getListeners(this),\n          scopedSlots: $scopedSlots\n        };\n        return h(\n          WrappedComponent,\n          _mergeJSXProps([wrapProps, { ref: 'wrappedInstance' }]),\n          [Object.keys($slots).map(function (name) {\n            return h(\n              'template',\n              { slot: name },\n              [$slots[name]]\n            );\n          })]\n        );\n      }\n    };\n    return proxyComponent(Connect);\n  };\n}"]},"metadata":{},"sourceType":"module"}