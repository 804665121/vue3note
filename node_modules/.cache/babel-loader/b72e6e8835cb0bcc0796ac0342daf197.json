{"ast":null,"code":"import _mergeJSXProps from 'babel-helper-vue-jsx-merge-props';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _extends from 'babel-runtime/helpers/extends';\nimport { getComponentFromProp, initDefaultProps } from '../_util/props-util';\nimport KeyCode from '../_util/KeyCode';\nimport contains from '../vc-util/Dom/contains';\nimport LazyRenderBox from './LazyRenderBox';\nimport BaseMixin from '../_util/BaseMixin';\nimport getTransitionProps from '../_util/getTransitionProps';\nimport _switchScrollingEffect from '../_util/switchScrollingEffect';\nimport getDialogPropTypes from './IDialogPropTypes';\nvar IDialogPropTypes = getDialogPropTypes();\nvar uuid = 0;\n\nfunction noop() {}\n\nfunction getScroll(w, top) {\n  var ret = w['page' + (top ? 'Y' : 'X') + 'Offset'];\n  var method = 'scroll' + (top ? 'Top' : 'Left');\n\n  if (typeof ret !== 'number') {\n    var d = w.document;\n    ret = d.documentElement[method];\n\n    if (typeof ret !== 'number') {\n      ret = d.body[method];\n    }\n  }\n\n  return ret;\n}\n\nfunction setTransformOrigin(node, value) {\n  var style = node.style;\n  ['Webkit', 'Moz', 'Ms', 'ms'].forEach(function (prefix) {\n    style[prefix + 'TransformOrigin'] = value;\n  });\n  style['transformOrigin'] = value;\n}\n\nfunction offset(el) {\n  var rect = el.getBoundingClientRect();\n  var pos = {\n    left: rect.left,\n    top: rect.top\n  };\n  var doc = el.ownerDocument;\n  var w = doc.defaultView || doc.parentWindow;\n  pos.left += getScroll(w);\n  pos.top += getScroll(w, true);\n  return pos;\n}\n\nvar cacheOverflow = {};\nexport default {\n  mixins: [BaseMixin],\n  props: initDefaultProps(IDialogPropTypes, {\n    mask: true,\n    visible: false,\n    keyboard: true,\n    closable: true,\n    maskClosable: true,\n    destroyOnClose: false,\n    prefixCls: 'rc-dialog',\n    getOpenCount: function getOpenCount() {\n      return null;\n    },\n    focusTriggerAfterClose: true\n  }),\n  data: function data() {\n    return {\n      destroyPopup: false\n    };\n  },\n  provide: function provide() {\n    return {\n      dialogContext: this\n    };\n  },\n  watch: {\n    visible: function visible(val) {\n      var _this = this;\n\n      if (val) {\n        this.destroyPopup = false;\n      }\n\n      this.$nextTick(function () {\n        _this.updatedCallback(!val);\n      });\n    }\n  },\n  beforeMount: function beforeMount() {\n    this.inTransition = false;\n    this.titleId = 'rcDialogTitle' + uuid++;\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    this.$nextTick(function () {\n      _this2.updatedCallback(false); // if forceRender is true, set element style display to be none;\n\n\n      if ((_this2.forceRender || _this2.getContainer === false && !_this2.visible) && _this2.$refs.wrap) {\n        _this2.$refs.wrap.style.display = 'none';\n      }\n    });\n  },\n  beforeDestroy: function beforeDestroy() {\n    var visible = this.visible,\n        getOpenCount = this.getOpenCount;\n\n    if ((visible || this.inTransition) && !getOpenCount()) {\n      this.switchScrollingEffect();\n    }\n\n    clearTimeout(this.timeoutId);\n  },\n  methods: {\n    // 对外暴露的 api 不要更改名称或删除\n    getDialogWrap: function getDialogWrap() {\n      return this.$refs.wrap;\n    },\n    updatedCallback: function updatedCallback(visible) {\n      var mousePosition = this.mousePosition;\n      var mask = this.mask,\n          focusTriggerAfterClose = this.focusTriggerAfterClose;\n\n      if (this.visible) {\n        // first show\n        if (!visible) {\n          this.openTime = Date.now(); // this.lastOutSideFocusNode = document.activeElement\n\n          this.switchScrollingEffect(); // this.$refs.wrap.focus()\n\n          this.tryFocus();\n          var dialogNode = this.$refs.dialog.$el;\n\n          if (mousePosition) {\n            var elOffset = offset(dialogNode);\n            setTransformOrigin(dialogNode, mousePosition.x - elOffset.left + 'px ' + (mousePosition.y - elOffset.top) + 'px');\n          } else {\n            setTransformOrigin(dialogNode, '');\n          }\n        }\n      } else if (visible) {\n        this.inTransition = true;\n\n        if (mask && this.lastOutSideFocusNode && focusTriggerAfterClose) {\n          try {\n            this.lastOutSideFocusNode.focus();\n          } catch (e) {\n            this.lastOutSideFocusNode = null;\n          }\n\n          this.lastOutSideFocusNode = null;\n        }\n      }\n    },\n    tryFocus: function tryFocus() {\n      if (!contains(this.$refs.wrap, document.activeElement)) {\n        this.lastOutSideFocusNode = document.activeElement;\n        this.$refs.sentinelStart.focus();\n      }\n    },\n    onAnimateLeave: function onAnimateLeave() {\n      var afterClose = this.afterClose,\n          destroyOnClose = this.destroyOnClose; // need demo?\n      // https://github.com/react-component/dialog/pull/28\n\n      if (this.$refs.wrap) {\n        this.$refs.wrap.style.display = 'none';\n      }\n\n      if (destroyOnClose) {\n        this.destroyPopup = true;\n      }\n\n      this.inTransition = false;\n      this.switchScrollingEffect();\n\n      if (afterClose) {\n        afterClose();\n      }\n    },\n    onDialogMouseDown: function onDialogMouseDown() {\n      this.dialogMouseDown = true;\n    },\n    onMaskMouseUp: function onMaskMouseUp() {\n      var _this3 = this;\n\n      if (this.dialogMouseDown) {\n        this.timeoutId = setTimeout(function () {\n          _this3.dialogMouseDown = false;\n        }, 0);\n      }\n    },\n    onMaskClick: function onMaskClick(e) {\n      // android trigger click on open (fastclick??)\n      if (Date.now() - this.openTime < 300) {\n        return;\n      }\n\n      if (e.target === e.currentTarget && !this.dialogMouseDown) {\n        this.close(e);\n      }\n    },\n    onKeydown: function onKeydown(e) {\n      var props = this.$props;\n\n      if (props.keyboard && e.keyCode === KeyCode.ESC) {\n        e.stopPropagation();\n        this.close(e);\n        return;\n      } // keep focus inside dialog\n\n\n      if (props.visible) {\n        if (e.keyCode === KeyCode.TAB) {\n          var activeElement = document.activeElement;\n          var sentinelStart = this.$refs.sentinelStart;\n\n          if (e.shiftKey) {\n            if (activeElement === sentinelStart) {\n              this.$refs.sentinelEnd.focus();\n            }\n          } else if (activeElement === this.$refs.sentinelEnd) {\n            sentinelStart.focus();\n          }\n        }\n      }\n    },\n    getDialogElement: function getDialogElement() {\n      var h = this.$createElement;\n      var closable = this.closable,\n          prefixCls = this.prefixCls,\n          width = this.width,\n          height = this.height,\n          title = this.title,\n          tempFooter = this.footer,\n          bodyStyle = this.bodyStyle,\n          visible = this.visible,\n          bodyProps = this.bodyProps,\n          forceRender = this.forceRender,\n          dialogStyle = this.dialogStyle,\n          dialogClass = this.dialogClass;\n\n      var dest = _extends({}, dialogStyle);\n\n      if (width !== undefined) {\n        dest.width = typeof width === 'number' ? width + 'px' : width;\n      }\n\n      if (height !== undefined) {\n        dest.height = typeof height === 'number' ? height + 'px' : height;\n      }\n\n      var footer = void 0;\n\n      if (tempFooter) {\n        footer = h('div', {\n          key: 'footer',\n          'class': prefixCls + '-footer',\n          ref: 'footer'\n        }, [tempFooter]);\n      }\n\n      var header = void 0;\n\n      if (title) {\n        header = h('div', {\n          key: 'header',\n          'class': prefixCls + '-header',\n          ref: 'header'\n        }, [h('div', {\n          'class': prefixCls + '-title',\n          attrs: {\n            id: this.titleId\n          }\n        }, [title])]);\n      }\n\n      var closer = void 0;\n\n      if (closable) {\n        var closeIcon = getComponentFromProp(this, 'closeIcon');\n        closer = h('button', {\n          attrs: {\n            type: 'button',\n            'aria-label': 'Close'\n          },\n          key: 'close',\n          on: {\n            'click': this.close || noop\n          },\n          'class': prefixCls + '-close'\n        }, [closeIcon || h('span', {\n          'class': prefixCls + '-close-x'\n        })]);\n      }\n\n      var style = dest;\n      var sentinelStyle = {\n        width: 0,\n        height: 0,\n        overflow: 'hidden'\n      };\n\n      var cls = _defineProperty({}, prefixCls, true);\n\n      var transitionName = this.getTransitionName();\n      var dialogElement = h(LazyRenderBox, {\n        directives: [{\n          name: 'show',\n          value: visible\n        }],\n        key: 'dialog-element',\n        attrs: {\n          role: 'document',\n          forceRender: forceRender\n        },\n        ref: 'dialog',\n        style: style,\n        'class': [cls, dialogClass],\n        on: {\n          'mousedown': this.onDialogMouseDown\n        }\n      }, [h('div', {\n        attrs: {\n          tabIndex: 0,\n          'aria-hidden': 'true'\n        },\n        ref: 'sentinelStart',\n        style: sentinelStyle\n      }), h('div', {\n        'class': prefixCls + '-content'\n      }, [closer, header, h('div', _mergeJSXProps([{\n        key: 'body',\n        'class': prefixCls + '-body',\n        style: bodyStyle,\n        ref: 'body'\n      }, bodyProps]), [this.$slots['default']]), footer]), h('div', {\n        attrs: {\n          tabIndex: 0,\n          'aria-hidden': 'true'\n        },\n        ref: 'sentinelEnd',\n        style: sentinelStyle\n      })]);\n      var dialogTransitionProps = getTransitionProps(transitionName, {\n        afterLeave: this.onAnimateLeave\n      });\n      return h('transition', _mergeJSXProps([{\n        key: 'dialog'\n      }, dialogTransitionProps]), [visible || !this.destroyPopup ? dialogElement : null]);\n    },\n    getZIndexStyle: function getZIndexStyle() {\n      var style = {};\n      var props = this.$props;\n\n      if (props.zIndex !== undefined) {\n        style.zIndex = props.zIndex;\n      }\n\n      return style;\n    },\n    getWrapStyle: function getWrapStyle() {\n      return _extends({}, this.getZIndexStyle(), this.wrapStyle);\n    },\n    getMaskStyle: function getMaskStyle() {\n      return _extends({}, this.getZIndexStyle(), this.maskStyle);\n    },\n    getMaskElement: function getMaskElement() {\n      var h = this.$createElement;\n      var props = this.$props;\n      var maskElement = void 0;\n\n      if (props.mask) {\n        var maskTransition = this.getMaskTransitionName();\n        maskElement = h(LazyRenderBox, _mergeJSXProps([{\n          directives: [{\n            name: 'show',\n            value: props.visible\n          }],\n          style: this.getMaskStyle(),\n          key: 'mask',\n          'class': props.prefixCls + '-mask'\n        }, props.maskProps]));\n\n        if (maskTransition) {\n          var maskTransitionProps = getTransitionProps(maskTransition);\n          maskElement = h('transition', _mergeJSXProps([{\n            key: 'mask'\n          }, maskTransitionProps]), [maskElement]);\n        }\n      }\n\n      return maskElement;\n    },\n    getMaskTransitionName: function getMaskTransitionName() {\n      var props = this.$props;\n      var transitionName = props.maskTransitionName;\n      var animation = props.maskAnimation;\n\n      if (!transitionName && animation) {\n        transitionName = props.prefixCls + '-' + animation;\n      }\n\n      return transitionName;\n    },\n    getTransitionName: function getTransitionName() {\n      var props = this.$props;\n      var transitionName = props.transitionName;\n      var animation = props.animation;\n\n      if (!transitionName && animation) {\n        transitionName = props.prefixCls + '-' + animation;\n      }\n\n      return transitionName;\n    },\n    // setScrollbar() {\n    //   if (this.bodyIsOverflowing && this.scrollbarWidth !== undefined) {\n    //     document.body.style.paddingRight = `${this.scrollbarWidth}px`;\n    //   }\n    // },\n    switchScrollingEffect: function switchScrollingEffect() {\n      var getOpenCount = this.getOpenCount;\n      var openCount = getOpenCount();\n\n      if (openCount === 1) {\n        if (cacheOverflow.hasOwnProperty('overflowX')) {\n          return;\n        }\n\n        cacheOverflow = {\n          overflowX: document.body.style.overflowX,\n          overflowY: document.body.style.overflowY,\n          overflow: document.body.style.overflow\n        };\n\n        _switchScrollingEffect(); // Must be set after switchScrollingEffect\n\n\n        document.body.style.overflow = 'hidden';\n      } else if (!openCount) {\n        // IE browser doesn't merge overflow style, need to set it separately\n        // https://github.com/ant-design/ant-design/issues/19393\n        if (cacheOverflow.overflow !== undefined) {\n          document.body.style.overflow = cacheOverflow.overflow;\n        }\n\n        if (cacheOverflow.overflowX !== undefined) {\n          document.body.style.overflowX = cacheOverflow.overflowX;\n        }\n\n        if (cacheOverflow.overflowY !== undefined) {\n          document.body.style.overflowY = cacheOverflow.overflowY;\n        }\n\n        cacheOverflow = {};\n\n        _switchScrollingEffect(true);\n      }\n    },\n    // removeScrollingEffect() {\n    //   const { getOpenCount } = this;\n    //   const openCount = getOpenCount();\n    //   if (openCount !== 0) {\n    //     return;\n    //   }\n    //   document.body.style.overflow = '';\n    //   switchScrollingEffect(true);\n    //   // this.resetAdjustments();\n    // },\n    close: function close(e) {\n      this.__emit('close', e);\n    }\n  },\n  render: function render() {\n    var h = arguments[0];\n    var prefixCls = this.prefixCls,\n        maskClosable = this.maskClosable,\n        visible = this.visible,\n        wrapClassName = this.wrapClassName,\n        title = this.title,\n        wrapProps = this.wrapProps;\n    var style = this.getWrapStyle(); // clear hide display\n    // and only set display after async anim, not here for hide\n\n    if (visible) {\n      style.display = null;\n    }\n\n    return h('div', {\n      'class': prefixCls + '-root'\n    }, [this.getMaskElement(), h('div', _mergeJSXProps([{\n      attrs: {\n        tabIndex: -1,\n        role: 'dialog',\n        'aria-labelledby': title ? this.titleId : null\n      },\n      on: {\n        'keydown': this.onKeydown,\n        'click': maskClosable ? this.onMaskClick : noop,\n        'mouseup': maskClosable ? this.onMaskMouseUp : noop\n      },\n      'class': prefixCls + '-wrap ' + (wrapClassName || ''),\n      ref: 'wrap',\n      style: style\n    }, wrapProps]), [this.getDialogElement()])]);\n  }\n};","map":{"version":3,"sources":["/Users/liulu/刘璐/vue3/hello-vue3/node_modules/ant-design-vue/es/vc-dialog/Dialog.js"],"names":["_mergeJSXProps","_defineProperty","_extends","getComponentFromProp","initDefaultProps","KeyCode","contains","LazyRenderBox","BaseMixin","getTransitionProps","_switchScrollingEffect","getDialogPropTypes","IDialogPropTypes","uuid","noop","getScroll","w","top","ret","method","d","document","documentElement","body","setTransformOrigin","node","value","style","forEach","prefix","offset","el","rect","getBoundingClientRect","pos","left","doc","ownerDocument","defaultView","parentWindow","cacheOverflow","mixins","props","mask","visible","keyboard","closable","maskClosable","destroyOnClose","prefixCls","getOpenCount","focusTriggerAfterClose","data","destroyPopup","provide","dialogContext","watch","val","_this","$nextTick","updatedCallback","beforeMount","inTransition","titleId","mounted","_this2","forceRender","getContainer","$refs","wrap","display","beforeDestroy","switchScrollingEffect","clearTimeout","timeoutId","methods","getDialogWrap","mousePosition","openTime","Date","now","tryFocus","dialogNode","dialog","$el","elOffset","x","y","lastOutSideFocusNode","focus","e","activeElement","sentinelStart","onAnimateLeave","afterClose","onDialogMouseDown","dialogMouseDown","onMaskMouseUp","_this3","setTimeout","onMaskClick","target","currentTarget","close","onKeydown","$props","keyCode","ESC","stopPropagation","TAB","shiftKey","sentinelEnd","getDialogElement","h","$createElement","width","height","title","tempFooter","footer","bodyStyle","bodyProps","dialogStyle","dialogClass","dest","undefined","key","ref","header","attrs","id","closer","closeIcon","type","on","sentinelStyle","overflow","cls","transitionName","getTransitionName","dialogElement","directives","name","role","tabIndex","$slots","dialogTransitionProps","afterLeave","getZIndexStyle","zIndex","getWrapStyle","wrapStyle","getMaskStyle","maskStyle","getMaskElement","maskElement","maskTransition","getMaskTransitionName","maskProps","maskTransitionProps","maskTransitionName","animation","maskAnimation","openCount","hasOwnProperty","overflowX","overflowY","__emit","render","arguments","wrapClassName","wrapProps"],"mappings":"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","sourcesContent":["import _mergeJSXProps from 'babel-helper-vue-jsx-merge-props';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _extends from 'babel-runtime/helpers/extends';\nimport { getComponentFromProp, initDefaultProps } from '../_util/props-util';\nimport KeyCode from '../_util/KeyCode';\nimport contains from '../vc-util/Dom/contains';\nimport LazyRenderBox from './LazyRenderBox';\nimport BaseMixin from '../_util/BaseMixin';\nimport getTransitionProps from '../_util/getTransitionProps';\nimport _switchScrollingEffect from '../_util/switchScrollingEffect';\nimport getDialogPropTypes from './IDialogPropTypes';\nvar IDialogPropTypes = getDialogPropTypes();\n\nvar uuid = 0;\n\nfunction noop() {}\nfunction getScroll(w, top) {\n  var ret = w['page' + (top ? 'Y' : 'X') + 'Offset'];\n  var method = 'scroll' + (top ? 'Top' : 'Left');\n  if (typeof ret !== 'number') {\n    var d = w.document;\n    ret = d.documentElement[method];\n    if (typeof ret !== 'number') {\n      ret = d.body[method];\n    }\n  }\n  return ret;\n}\n\nfunction setTransformOrigin(node, value) {\n  var style = node.style;\n  ['Webkit', 'Moz', 'Ms', 'ms'].forEach(function (prefix) {\n    style[prefix + 'TransformOrigin'] = value;\n  });\n  style['transformOrigin'] = value;\n}\n\nfunction offset(el) {\n  var rect = el.getBoundingClientRect();\n  var pos = {\n    left: rect.left,\n    top: rect.top\n  };\n  var doc = el.ownerDocument;\n  var w = doc.defaultView || doc.parentWindow;\n  pos.left += getScroll(w);\n  pos.top += getScroll(w, true);\n  return pos;\n}\n\nvar cacheOverflow = {};\n\nexport default {\n  mixins: [BaseMixin],\n  props: initDefaultProps(IDialogPropTypes, {\n    mask: true,\n    visible: false,\n    keyboard: true,\n    closable: true,\n    maskClosable: true,\n    destroyOnClose: false,\n    prefixCls: 'rc-dialog',\n    getOpenCount: function getOpenCount() {\n      return null;\n    },\n    focusTriggerAfterClose: true\n  }),\n  data: function data() {\n    return {\n      destroyPopup: false\n    };\n  },\n  provide: function provide() {\n    return {\n      dialogContext: this\n    };\n  },\n\n\n  watch: {\n    visible: function visible(val) {\n      var _this = this;\n\n      if (val) {\n        this.destroyPopup = false;\n      }\n      this.$nextTick(function () {\n        _this.updatedCallback(!val);\n      });\n    }\n  },\n\n  beforeMount: function beforeMount() {\n    this.inTransition = false;\n    this.titleId = 'rcDialogTitle' + uuid++;\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    this.$nextTick(function () {\n      _this2.updatedCallback(false);\n      // if forceRender is true, set element style display to be none;\n      if ((_this2.forceRender || _this2.getContainer === false && !_this2.visible) && _this2.$refs.wrap) {\n        _this2.$refs.wrap.style.display = 'none';\n      }\n    });\n  },\n  beforeDestroy: function beforeDestroy() {\n    var visible = this.visible,\n        getOpenCount = this.getOpenCount;\n\n    if ((visible || this.inTransition) && !getOpenCount()) {\n      this.switchScrollingEffect();\n    }\n    clearTimeout(this.timeoutId);\n  },\n\n  methods: {\n    // 对外暴露的 api 不要更改名称或删除\n    getDialogWrap: function getDialogWrap() {\n      return this.$refs.wrap;\n    },\n    updatedCallback: function updatedCallback(visible) {\n      var mousePosition = this.mousePosition;\n      var mask = this.mask,\n          focusTriggerAfterClose = this.focusTriggerAfterClose;\n\n      if (this.visible) {\n        // first show\n        if (!visible) {\n          this.openTime = Date.now();\n          // this.lastOutSideFocusNode = document.activeElement\n          this.switchScrollingEffect();\n          // this.$refs.wrap.focus()\n          this.tryFocus();\n          var dialogNode = this.$refs.dialog.$el;\n          if (mousePosition) {\n            var elOffset = offset(dialogNode);\n            setTransformOrigin(dialogNode, mousePosition.x - elOffset.left + 'px ' + (mousePosition.y - elOffset.top) + 'px');\n          } else {\n            setTransformOrigin(dialogNode, '');\n          }\n        }\n      } else if (visible) {\n        this.inTransition = true;\n        if (mask && this.lastOutSideFocusNode && focusTriggerAfterClose) {\n          try {\n            this.lastOutSideFocusNode.focus();\n          } catch (e) {\n            this.lastOutSideFocusNode = null;\n          }\n          this.lastOutSideFocusNode = null;\n        }\n      }\n    },\n    tryFocus: function tryFocus() {\n      if (!contains(this.$refs.wrap, document.activeElement)) {\n        this.lastOutSideFocusNode = document.activeElement;\n        this.$refs.sentinelStart.focus();\n      }\n    },\n    onAnimateLeave: function onAnimateLeave() {\n      var afterClose = this.afterClose,\n          destroyOnClose = this.destroyOnClose;\n      // need demo?\n      // https://github.com/react-component/dialog/pull/28\n\n      if (this.$refs.wrap) {\n        this.$refs.wrap.style.display = 'none';\n      }\n      if (destroyOnClose) {\n        this.destroyPopup = true;\n      }\n      this.inTransition = false;\n      this.switchScrollingEffect();\n      if (afterClose) {\n        afterClose();\n      }\n    },\n    onDialogMouseDown: function onDialogMouseDown() {\n      this.dialogMouseDown = true;\n    },\n    onMaskMouseUp: function onMaskMouseUp() {\n      var _this3 = this;\n\n      if (this.dialogMouseDown) {\n        this.timeoutId = setTimeout(function () {\n          _this3.dialogMouseDown = false;\n        }, 0);\n      }\n    },\n    onMaskClick: function onMaskClick(e) {\n      // android trigger click on open (fastclick??)\n      if (Date.now() - this.openTime < 300) {\n        return;\n      }\n      if (e.target === e.currentTarget && !this.dialogMouseDown) {\n        this.close(e);\n      }\n    },\n    onKeydown: function onKeydown(e) {\n      var props = this.$props;\n      if (props.keyboard && e.keyCode === KeyCode.ESC) {\n        e.stopPropagation();\n        this.close(e);\n        return;\n      }\n      // keep focus inside dialog\n      if (props.visible) {\n        if (e.keyCode === KeyCode.TAB) {\n          var activeElement = document.activeElement;\n          var sentinelStart = this.$refs.sentinelStart;\n          if (e.shiftKey) {\n            if (activeElement === sentinelStart) {\n              this.$refs.sentinelEnd.focus();\n            }\n          } else if (activeElement === this.$refs.sentinelEnd) {\n            sentinelStart.focus();\n          }\n        }\n      }\n    },\n    getDialogElement: function getDialogElement() {\n      var h = this.$createElement;\n      var closable = this.closable,\n          prefixCls = this.prefixCls,\n          width = this.width,\n          height = this.height,\n          title = this.title,\n          tempFooter = this.footer,\n          bodyStyle = this.bodyStyle,\n          visible = this.visible,\n          bodyProps = this.bodyProps,\n          forceRender = this.forceRender,\n          dialogStyle = this.dialogStyle,\n          dialogClass = this.dialogClass;\n\n      var dest = _extends({}, dialogStyle);\n      if (width !== undefined) {\n        dest.width = typeof width === 'number' ? width + 'px' : width;\n      }\n      if (height !== undefined) {\n        dest.height = typeof height === 'number' ? height + 'px' : height;\n      }\n\n      var footer = void 0;\n      if (tempFooter) {\n        footer = h(\n          'div',\n          { key: 'footer', 'class': prefixCls + '-footer', ref: 'footer' },\n          [tempFooter]\n        );\n      }\n\n      var header = void 0;\n      if (title) {\n        header = h(\n          'div',\n          { key: 'header', 'class': prefixCls + '-header', ref: 'header' },\n          [h(\n            'div',\n            { 'class': prefixCls + '-title', attrs: { id: this.titleId }\n            },\n            [title]\n          )]\n        );\n      }\n\n      var closer = void 0;\n      if (closable) {\n        var closeIcon = getComponentFromProp(this, 'closeIcon');\n        closer = h(\n          'button',\n          {\n            attrs: {\n              type: 'button',\n\n              'aria-label': 'Close'\n            },\n            key: 'close',\n            on: {\n              'click': this.close || noop\n            },\n            'class': prefixCls + '-close'\n          },\n          [closeIcon || h('span', { 'class': prefixCls + '-close-x' })]\n        );\n      }\n\n      var style = dest;\n      var sentinelStyle = { width: 0, height: 0, overflow: 'hidden' };\n      var cls = _defineProperty({}, prefixCls, true);\n      var transitionName = this.getTransitionName();\n      var dialogElement = h(\n        LazyRenderBox,\n        {\n          directives: [{\n            name: 'show',\n            value: visible\n          }],\n\n          key: 'dialog-element',\n          attrs: { role: 'document',\n\n            forceRender: forceRender\n          },\n          ref: 'dialog',\n          style: style,\n          'class': [cls, dialogClass], on: {\n            'mousedown': this.onDialogMouseDown\n          }\n        },\n        [h('div', {\n          attrs: { tabIndex: 0, 'aria-hidden': 'true' },\n          ref: 'sentinelStart', style: sentinelStyle }), h(\n          'div',\n          { 'class': prefixCls + '-content' },\n          [closer, header, h(\n            'div',\n            _mergeJSXProps([{ key: 'body', 'class': prefixCls + '-body', style: bodyStyle, ref: 'body' }, bodyProps]),\n            [this.$slots['default']]\n          ), footer]\n        ), h('div', {\n          attrs: { tabIndex: 0, 'aria-hidden': 'true' },\n          ref: 'sentinelEnd', style: sentinelStyle })]\n      );\n      var dialogTransitionProps = getTransitionProps(transitionName, {\n        afterLeave: this.onAnimateLeave\n      });\n      return h(\n        'transition',\n        _mergeJSXProps([{ key: 'dialog' }, dialogTransitionProps]),\n        [visible || !this.destroyPopup ? dialogElement : null]\n      );\n    },\n    getZIndexStyle: function getZIndexStyle() {\n      var style = {};\n      var props = this.$props;\n      if (props.zIndex !== undefined) {\n        style.zIndex = props.zIndex;\n      }\n      return style;\n    },\n    getWrapStyle: function getWrapStyle() {\n      return _extends({}, this.getZIndexStyle(), this.wrapStyle);\n    },\n    getMaskStyle: function getMaskStyle() {\n      return _extends({}, this.getZIndexStyle(), this.maskStyle);\n    },\n    getMaskElement: function getMaskElement() {\n      var h = this.$createElement;\n\n      var props = this.$props;\n      var maskElement = void 0;\n      if (props.mask) {\n        var maskTransition = this.getMaskTransitionName();\n        maskElement = h(LazyRenderBox, _mergeJSXProps([{\n          directives: [{\n            name: 'show',\n            value: props.visible\n          }],\n\n          style: this.getMaskStyle(),\n          key: 'mask',\n          'class': props.prefixCls + '-mask'\n        }, props.maskProps]));\n        if (maskTransition) {\n          var maskTransitionProps = getTransitionProps(maskTransition);\n          maskElement = h(\n            'transition',\n            _mergeJSXProps([{ key: 'mask' }, maskTransitionProps]),\n            [maskElement]\n          );\n        }\n      }\n      return maskElement;\n    },\n    getMaskTransitionName: function getMaskTransitionName() {\n      var props = this.$props;\n      var transitionName = props.maskTransitionName;\n      var animation = props.maskAnimation;\n      if (!transitionName && animation) {\n        transitionName = props.prefixCls + '-' + animation;\n      }\n      return transitionName;\n    },\n    getTransitionName: function getTransitionName() {\n      var props = this.$props;\n      var transitionName = props.transitionName;\n      var animation = props.animation;\n      if (!transitionName && animation) {\n        transitionName = props.prefixCls + '-' + animation;\n      }\n      return transitionName;\n    },\n\n    // setScrollbar() {\n    //   if (this.bodyIsOverflowing && this.scrollbarWidth !== undefined) {\n    //     document.body.style.paddingRight = `${this.scrollbarWidth}px`;\n    //   }\n    // },\n    switchScrollingEffect: function switchScrollingEffect() {\n      var getOpenCount = this.getOpenCount;\n\n      var openCount = getOpenCount();\n      if (openCount === 1) {\n        if (cacheOverflow.hasOwnProperty('overflowX')) {\n          return;\n        }\n        cacheOverflow = {\n          overflowX: document.body.style.overflowX,\n          overflowY: document.body.style.overflowY,\n          overflow: document.body.style.overflow\n        };\n        _switchScrollingEffect();\n        // Must be set after switchScrollingEffect\n        document.body.style.overflow = 'hidden';\n      } else if (!openCount) {\n        // IE browser doesn't merge overflow style, need to set it separately\n        // https://github.com/ant-design/ant-design/issues/19393\n        if (cacheOverflow.overflow !== undefined) {\n          document.body.style.overflow = cacheOverflow.overflow;\n        }\n        if (cacheOverflow.overflowX !== undefined) {\n          document.body.style.overflowX = cacheOverflow.overflowX;\n        }\n        if (cacheOverflow.overflowY !== undefined) {\n          document.body.style.overflowY = cacheOverflow.overflowY;\n        }\n        cacheOverflow = {};\n        _switchScrollingEffect(true);\n      }\n    },\n\n    // removeScrollingEffect() {\n    //   const { getOpenCount } = this;\n    //   const openCount = getOpenCount();\n    //   if (openCount !== 0) {\n    //     return;\n    //   }\n    //   document.body.style.overflow = '';\n    //   switchScrollingEffect(true);\n    //   // this.resetAdjustments();\n    // },\n    close: function close(e) {\n      this.__emit('close', e);\n    }\n  },\n  render: function render() {\n    var h = arguments[0];\n    var prefixCls = this.prefixCls,\n        maskClosable = this.maskClosable,\n        visible = this.visible,\n        wrapClassName = this.wrapClassName,\n        title = this.title,\n        wrapProps = this.wrapProps;\n\n    var style = this.getWrapStyle();\n    // clear hide display\n    // and only set display after async anim, not here for hide\n    if (visible) {\n      style.display = null;\n    }\n    return h(\n      'div',\n      { 'class': prefixCls + '-root' },\n      [this.getMaskElement(), h(\n        'div',\n        _mergeJSXProps([{\n          attrs: {\n            tabIndex: -1,\n\n            role: 'dialog',\n            'aria-labelledby': title ? this.titleId : null\n          },\n          on: {\n            'keydown': this.onKeydown,\n            'click': maskClosable ? this.onMaskClick : noop,\n            'mouseup': maskClosable ? this.onMaskMouseUp : noop\n          },\n\n          'class': prefixCls + '-wrap ' + (wrapClassName || ''),\n          ref: 'wrap',\n          style: style\n        }, wrapProps]),\n        [this.getDialogElement()]\n      )]\n    );\n  }\n};"]},"metadata":{},"sourceType":"module"}