{"ast":null,"code":"import _mergeJSXProps from 'babel-helper-vue-jsx-merge-props';\nimport _toConsumableArray from 'babel-runtime/helpers/toConsumableArray';\nimport _extends from 'babel-runtime/helpers/extends';\n/**\n * ARIA: https://www.w3.org/TR/wai-aria/#combobox\n * Sample 1: https://www.w3.org/TR/2017/NOTE-wai-aria-practices-1.1-20171214/examples/combobox/aria1.1pattern/listbox-combo.html\n * Sample 2: https://www.w3.org/blog/wai-components-gallery/widget/combobox-with-aria-autocompleteinline/\n *\n * Tab logic:\n * Popup is close\n * 1. Focus input (mark component as focused)\n * 2. Press enter to show the popup\n * 3. If popup has input, focus it\n *\n * Popup is open\n * 1. press tab to close the popup\n * 2. Focus back to the selection input box\n * 3. Let the native tab going on\n *\n * TreeSelect use 2 design type.\n * In single mode, we should focus on the `span`\n * In multiple mode, we should focus on the `input`\n */\n\nimport shallowEqual from 'shallowequal';\nimport raf from 'raf';\nimport scrollIntoView from 'dom-scroll-into-view';\nimport warning from 'warning';\nimport PropTypes from '../../_util/vue-types';\nimport KeyCode from '../../_util/KeyCode';\nimport SelectTrigger from './SelectTrigger';\nimport SingleSelector from './Selector/SingleSelector';\nimport MultipleSelector from './Selector/MultipleSelector';\nimport SinglePopup from './Popup/SinglePopup';\nimport MultiplePopup from './Popup/MultiplePopup';\nimport { SHOW_ALL, SHOW_PARENT, SHOW_CHILD } from './strategies';\nimport BaseMixin from '../../_util/BaseMixin';\nimport { createRef, generateAriaId, formatInternalValue, formatSelectorValue, parseSimpleTreeData, convertDataToTree, convertTreeToEntities, conductCheck, getHalfCheckedKeys, flatToHierarchy, isPosRelated, isLabelInValue as _isLabelInValue, getFilterTree, cleanEntity, findPopupContainer } from './util';\nimport SelectNode from './SelectNode';\nimport { initDefaultProps, getOptionProps, mergeProps, getPropsData, filterEmpty, getListeners } from '../../_util/props-util';\n\nfunction getWatch() {\n  var keys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var watch = {};\n  keys.forEach(function (k) {\n    watch[k] = function () {\n      this.needSyncKeys[k] = true;\n    };\n  });\n  return watch;\n}\n\nvar Select = {\n  name: 'Select',\n  mixins: [BaseMixin],\n  props: initDefaultProps({\n    prefixCls: PropTypes.string,\n    prefixAria: PropTypes.string,\n    multiple: PropTypes.bool,\n    showArrow: PropTypes.bool,\n    open: PropTypes.bool,\n    value: PropTypes.any,\n    autoFocus: PropTypes.bool,\n    defaultOpen: PropTypes.bool,\n    defaultValue: PropTypes.any,\n    showSearch: PropTypes.bool,\n    placeholder: PropTypes.any,\n    inputValue: PropTypes.string,\n    // [Legacy] Deprecated. Use `searchValue` instead.\n    searchValue: PropTypes.string,\n    autoClearSearchValue: PropTypes.bool,\n    searchPlaceholder: PropTypes.any,\n    // [Legacy] Confuse with placeholder\n    disabled: PropTypes.bool,\n    children: PropTypes.any,\n    labelInValue: PropTypes.bool,\n    maxTagCount: PropTypes.number,\n    maxTagPlaceholder: PropTypes.oneOfType([PropTypes.any, PropTypes.func]),\n    maxTagTextLength: PropTypes.number,\n    showCheckedStrategy: PropTypes.oneOf([SHOW_ALL, SHOW_PARENT, SHOW_CHILD]),\n    dropdownClassName: PropTypes.string,\n    dropdownStyle: PropTypes.object,\n    dropdownVisibleChange: PropTypes.func,\n    dropdownMatchSelectWidth: PropTypes.bool,\n    treeData: PropTypes.array,\n    treeDataSimpleMode: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]),\n    treeNodeFilterProp: PropTypes.string,\n    treeNodeLabelProp: PropTypes.string,\n    treeCheckable: PropTypes.oneOfType([PropTypes.any, PropTypes.object, PropTypes.bool]),\n    // treeCheckable: PropTypes.any,\n    treeCheckStrictly: PropTypes.bool,\n    treeIcon: PropTypes.bool,\n    treeLine: PropTypes.bool,\n    treeDefaultExpandAll: PropTypes.bool,\n    treeDefaultExpandedKeys: PropTypes.array,\n    treeExpandedKeys: PropTypes.array,\n    loadData: PropTypes.func,\n    filterTreeNode: PropTypes.oneOfType([PropTypes.func, PropTypes.bool]),\n    notFoundContent: PropTypes.any,\n    getPopupContainer: PropTypes.func,\n    // onSearch: PropTypes.func,\n    // onSelect: PropTypes.func,\n    // onDeselect: PropTypes.func,\n    // onChange: PropTypes.func,\n    // onDropdownVisibleChange: PropTypes.func,\n    // onTreeExpand: PropTypes.func,\n    allowClear: PropTypes.bool,\n    transitionName: PropTypes.string,\n    animation: PropTypes.string,\n    choiceTransitionName: PropTypes.string,\n    inputIcon: PropTypes.any,\n    clearIcon: PropTypes.any,\n    removeIcon: PropTypes.any,\n    switcherIcon: PropTypes.any,\n    __propsSymbol__: PropTypes.any\n  }, {\n    prefixCls: 'rc-tree-select',\n    prefixAria: 'rc-tree-select',\n    showSearch: true,\n    autoClearSearchValue: true,\n    showCheckedStrategy: SHOW_CHILD,\n    // dropdownMatchSelectWidth change the origin design, set to false now\n    // ref: https://github.com/react-component/select/blob/4cad95e098a341a09de239ad6981067188842020/src/Select.jsx#L344\n    // ref: https://github.com/react-component/select/pull/71\n    treeNodeFilterProp: 'value',\n    treeNodeLabelProp: 'title',\n    treeIcon: false,\n    notFoundContent: 'Not Found',\n    dropdownStyle: {},\n    dropdownVisibleChange: function dropdownVisibleChange() {\n      return true;\n    }\n  }),\n  data: function data() {\n    warning(this.$props.__propsSymbol__, 'must pass __propsSymbol__');\n    var _$props = this.$props,\n        prefixAria = _$props.prefixAria,\n        defaultOpen = _$props.defaultOpen,\n        open = _$props.open;\n    this.needSyncKeys = {};\n    this.selectorRef = createRef();\n    this.selectTriggerRef = createRef(); // ARIA need `aria-controls` props mapping\n    // Since this need user input. Let's generate ourselves\n\n    this.ariaId = generateAriaId(prefixAria + '-list');\n    var state = {\n      _open: open || defaultOpen,\n      _valueList: [],\n      _searchHalfCheckedKeys: [],\n      _missValueList: [],\n      // Contains the value not in the tree\n      _selectorValueList: [],\n      // Used for multiple selector\n      _valueEntities: {},\n      _posEntities: new Map(),\n      _keyEntities: new Map(),\n      _searchValue: '',\n      _prevProps: {},\n      _init: true,\n      _focused: undefined,\n      _treeNodes: undefined,\n      _filteredTreeNodes: undefined\n    };\n    var newState = this.getDerivedState(this.$props, state);\n    return _extends({}, state, newState);\n  },\n  provide: function provide() {\n    return {\n      vcTreeSelect: {\n        onSelectorFocus: this.onSelectorFocus,\n        onSelectorBlur: this.onSelectorBlur,\n        onSelectorKeyDown: this.onComponentKeyDown,\n        onSelectorClear: this.onSelectorClear,\n        onMultipleSelectorRemove: this.onMultipleSelectorRemove,\n        onTreeNodeSelect: this.onTreeNodeSelect,\n        onTreeNodeCheck: this.onTreeNodeCheck,\n        onPopupKeyDown: this.onComponentKeyDown,\n        onSearchInputChange: this.onSearchInputChange,\n        onSearchInputKeyDown: this.onSearchInputKeyDown\n      }\n    };\n  },\n  watch: _extends({}, getWatch(['treeData', 'defaultValue', 'value']), {\n    __propsSymbol__: function __propsSymbol__() {\n      var state = this.getDerivedState(this.$props, this.$data);\n      this.setState(state);\n      this.needSyncKeys = {};\n    },\n    '$data._valueList': function $data_valueList() {\n      var _this = this;\n\n      this.$nextTick(function () {\n        _this.forcePopupAlign();\n      });\n    },\n    '$data._open': function $data_open(open) {\n      var _this2 = this;\n\n      setTimeout(function () {\n        var prefixCls = _this2.$props.prefixCls;\n        var _$data = _this2.$data,\n            selectorValueList = _$data._selectorValueList,\n            valueEntities = _$data._valueEntities;\n\n        var isMultiple = _this2.isMultiple(); // Scroll to value position, only need sync on single mode\n\n\n        if (!isMultiple && selectorValueList.length && open && _this2.popup) {\n          var value = selectorValueList[0].value;\n\n          var _popup$getTree = _this2.popup.getTree(),\n              domTreeNodes = _popup$getTree.domTreeNodes;\n\n          var _ref = valueEntities[value] || {},\n              key = _ref.key;\n\n          var treeNode = domTreeNodes[key];\n\n          if (treeNode) {\n            var domNode = treeNode.$el;\n            raf(function () {\n              var popupNode = _this2.popup.$el;\n              var triggerContainer = findPopupContainer(popupNode, prefixCls + '-dropdown');\n              var searchNode = _this2.popup.searchRef.current;\n\n              if (domNode && triggerContainer && searchNode) {\n                scrollIntoView(domNode, triggerContainer, {\n                  onlyScrollIfNeeded: true,\n                  offsetTop: searchNode.offsetHeight\n                });\n              }\n            });\n          }\n        }\n      });\n    }\n  }),\n  mounted: function mounted() {\n    var _this3 = this;\n\n    this.$nextTick(function () {\n      var _$props2 = _this3.$props,\n          autoFocus = _$props2.autoFocus,\n          disabled = _$props2.disabled;\n\n      if (autoFocus && !disabled) {\n        _this3.focus();\n      }\n    });\n  },\n  methods: {\n    getDerivedState: function getDerivedState(nextProps, prevState) {\n      var h = this.$createElement;\n      var _prevState$_prevProps = prevState._prevProps,\n          prevProps = _prevState$_prevProps === undefined ? {} : _prevState$_prevProps;\n      var treeCheckable = nextProps.treeCheckable,\n          treeCheckStrictly = nextProps.treeCheckStrictly,\n          filterTreeNode = nextProps.filterTreeNode,\n          treeNodeFilterProp = nextProps.treeNodeFilterProp,\n          treeDataSimpleMode = nextProps.treeDataSimpleMode;\n      var newState = {\n        _prevProps: _extends({}, nextProps),\n        _init: false\n      };\n      var self = this; // Process the state when props updated\n\n      function processState(propName, updater) {\n        if (prevProps[propName] !== nextProps[propName] || self.needSyncKeys[propName]) {\n          updater(nextProps[propName], prevProps[propName]);\n          return true;\n        }\n\n        return false;\n      }\n\n      var valueRefresh = false; // Open\n\n      processState('open', function (propValue) {\n        newState._open = propValue;\n      }); // Tree Nodes\n\n      var treeNodes = void 0;\n      var treeDataChanged = false;\n      var treeDataModeChanged = false;\n      processState('treeData', function (propValue) {\n        treeNodes = convertDataToTree(h, propValue);\n        treeDataChanged = true;\n      });\n      processState('treeDataSimpleMode', function (propValue, prevValue) {\n        if (!propValue) return;\n        var prev = !prevValue || prevValue === true ? {} : prevValue; // Shallow equal to avoid dynamic prop object\n\n        if (!shallowEqual(propValue, prev)) {\n          treeDataModeChanged = true;\n        }\n      }); // Parse by `treeDataSimpleMode`\n\n      if (treeDataSimpleMode && (treeDataChanged || treeDataModeChanged)) {\n        var simpleMapper = _extends({\n          id: 'id',\n          pId: 'pId',\n          rootPId: null\n        }, treeDataSimpleMode !== true ? treeDataSimpleMode : {});\n\n        treeNodes = convertDataToTree(h, parseSimpleTreeData(nextProps.treeData, simpleMapper));\n      } // If `treeData` not provide, use children TreeNodes\n\n\n      if (!nextProps.treeData) {\n        // processState('children', (propValue) => {\n        //   treeNodes = Array.isArray(propValue) ? propValue : [propValue]\n        // })\n        treeNodes = filterEmpty(this.$slots['default']);\n      } // Convert `treeData` to entities\n\n\n      if (treeNodes) {\n        var entitiesMap = convertTreeToEntities(treeNodes);\n        newState._treeNodes = treeNodes;\n        newState._posEntities = entitiesMap.posEntities;\n        newState._valueEntities = entitiesMap.valueEntities;\n        newState._keyEntities = entitiesMap.keyEntities;\n        valueRefresh = true;\n      } // Value List\n\n\n      if (prevState._init) {\n        processState('defaultValue', function (propValue) {\n          newState._valueList = formatInternalValue(propValue, nextProps);\n          valueRefresh = true;\n        });\n      }\n\n      processState('value', function (propValue) {\n        newState._valueList = formatInternalValue(propValue, nextProps);\n        valueRefresh = true;\n      }); // Selector Value List\n\n      if (valueRefresh) {\n        // Find out that value not exist in the tree\n        var missValueList = [];\n        var filteredValueList = [];\n        var keyList = []; // Get latest value list\n\n        var latestValueList = newState._valueList;\n\n        if (!latestValueList) {\n          // Also need add prev missValueList to avoid new treeNodes contains the value\n          latestValueList = [].concat(_toConsumableArray(prevState._valueList), _toConsumableArray(prevState._missValueList));\n        } // Get key by value\n\n\n        var valueLabels = {};\n        latestValueList.forEach(function (wrapperValue) {\n          var value = wrapperValue.value,\n              label = wrapperValue.label;\n          var entity = (newState._valueEntities || prevState._valueEntities)[value];\n          valueLabels[value] = label;\n\n          if (entity) {\n            keyList.push(entity.key);\n            filteredValueList.push(wrapperValue);\n            return;\n          } // If not match, it may caused by ajax load. We need keep this\n\n\n          missValueList.push(wrapperValue);\n        }); // We need calculate the value when tree is checked tree\n\n        if (treeCheckable && !treeCheckStrictly) {\n          // Calculate the keys need to be checked\n          var _conductCheck = conductCheck(keyList, true, newState._keyEntities || prevState._keyEntities),\n              checkedKeys = _conductCheck.checkedKeys; // Format value list again for internal usage\n\n\n          newState._valueList = checkedKeys.map(function (key) {\n            var val = (newState._keyEntities || prevState._keyEntities).get(key).value;\n\n            var wrappedValue = {\n              value: val\n            };\n\n            if (valueLabels[val] !== undefined) {\n              wrappedValue.label = valueLabels[val];\n            }\n\n            return wrappedValue;\n          });\n        } else {\n          newState._valueList = filteredValueList;\n        } // Fill the missValueList, we still need display in the selector\n\n\n        newState._missValueList = missValueList; // Calculate the value list for `Selector` usage\n\n        newState._selectorValueList = formatSelectorValue(newState._valueList, nextProps, newState._valueEntities || prevState._valueEntities);\n      } // [Legacy] To align with `Select` component,\n      // We use `searchValue` instead of `inputValue` but still keep the api\n      // `inputValue` support `null` to work as `autoClearSearchValue`\n\n\n      processState('inputValue', function (propValue) {\n        if (propValue !== null) {\n          newState._searchValue = propValue;\n        }\n      }); // Search value\n\n      processState('searchValue', function (propValue) {\n        newState._searchValue = propValue;\n      }); // Do the search logic\n\n      if (newState._searchValue !== undefined || prevState._searchValue && treeNodes) {\n        var searchValue = newState._searchValue !== undefined ? newState._searchValue : prevState._searchValue;\n        var upperSearchValue = String(searchValue).toUpperCase();\n        var filterTreeNodeFn = filterTreeNode;\n\n        if (filterTreeNode === false) {\n          // Don't filter if is false\n          filterTreeNodeFn = function filterTreeNodeFn() {\n            return true;\n          };\n        } else if (typeof filterTreeNodeFn !== 'function') {\n          // When is not function (true or undefined), use inner filter\n          filterTreeNodeFn = function filterTreeNodeFn(_, node) {\n            var nodeValue = String(getPropsData(node)[treeNodeFilterProp]).toUpperCase();\n            return nodeValue.indexOf(upperSearchValue) !== -1;\n          };\n        }\n\n        newState._filteredTreeNodes = getFilterTree(this.$createElement, newState._treeNodes || prevState._treeNodes, searchValue, filterTreeNodeFn, newState._valueEntities || prevState._valueEntities, SelectNode);\n      } // We should re-calculate the halfCheckedKeys when in search mode\n\n\n      if (valueRefresh && treeCheckable && !treeCheckStrictly && (newState._searchValue || prevState._searchValue)) {\n        newState._searchHalfCheckedKeys = getHalfCheckedKeys(newState._valueList, newState._valueEntities || prevState._valueEntities);\n      } // Checked Strategy\n\n\n      processState('showCheckedStrategy', function () {\n        newState._selectorValueList = newState._selectorValueList || formatSelectorValue(newState._valueList || prevState._valueList, nextProps, newState._valueEntities || prevState._valueEntities);\n      });\n      return newState;\n    },\n    // ==================== Selector ====================\n    onSelectorFocus: function onSelectorFocus() {\n      this.setState({\n        _focused: true\n      });\n    },\n    onSelectorBlur: function onSelectorBlur() {\n      this.setState({\n        _focused: false\n      }); // TODO: Close when Popup is also not focused\n      // this.setState({ open: false });\n    },\n    // Handle key board event in both Selector and Popup\n    onComponentKeyDown: function onComponentKeyDown(event) {\n      var open = this.$data._open;\n      var keyCode = event.keyCode;\n\n      if (!open) {\n        if ([KeyCode.ENTER, KeyCode.DOWN].indexOf(keyCode) !== -1) {\n          this.setOpenState(true);\n        }\n      } else if (KeyCode.ESC === keyCode) {\n        this.setOpenState(false);\n      } else if ([KeyCode.UP, KeyCode.DOWN, KeyCode.LEFT, KeyCode.RIGHT].indexOf(keyCode) !== -1) {\n        // TODO: Handle `open` state\n        event.stopPropagation();\n      }\n    },\n    onDeselect: function onDeselect(wrappedValue, node, nodeEventInfo) {\n      this.__emit('deselect', wrappedValue, node, nodeEventInfo);\n    },\n    onSelectorClear: function onSelectorClear(event) {\n      var disabled = this.$props.disabled;\n      if (disabled) return;\n      this.triggerChange([], []);\n\n      if (!this.isSearchValueControlled()) {\n        this.setUncontrolledState({\n          _searchValue: '',\n          _filteredTreeNodes: null\n        });\n      }\n\n      event.stopPropagation();\n    },\n    onMultipleSelectorRemove: function onMultipleSelectorRemove(event, removeValue) {\n      event.stopPropagation();\n      var _$data2 = this.$data,\n          valueList = _$data2._valueList,\n          missValueList = _$data2._missValueList,\n          valueEntities = _$data2._valueEntities;\n      var _$props3 = this.$props,\n          treeCheckable = _$props3.treeCheckable,\n          treeCheckStrictly = _$props3.treeCheckStrictly,\n          treeNodeLabelProp = _$props3.treeNodeLabelProp,\n          disabled = _$props3.disabled;\n      if (disabled) return; // Find trigger entity\n\n      var triggerEntity = valueEntities[removeValue]; // Clean up value\n\n      var newValueList = valueList;\n\n      if (triggerEntity) {\n        // If value is in tree\n        if (treeCheckable && !treeCheckStrictly) {\n          newValueList = valueList.filter(function (_ref2) {\n            var value = _ref2.value;\n            var entity = valueEntities[value];\n            return !isPosRelated(entity.pos, triggerEntity.pos);\n          });\n        } else {\n          newValueList = valueList.filter(function (_ref3) {\n            var value = _ref3.value;\n            return value !== removeValue;\n          });\n        }\n      }\n\n      var triggerNode = triggerEntity ? triggerEntity.node : null;\n      var extraInfo = {\n        triggerValue: removeValue,\n        triggerNode: triggerNode\n      };\n      var deselectInfo = {\n        node: triggerNode\n      }; // [Legacy] Little hack on this to make same action as `onCheck` event.\n\n      if (treeCheckable) {\n        var filteredEntityList = newValueList.map(function (_ref4) {\n          var value = _ref4.value;\n          return valueEntities[value];\n        });\n        deselectInfo.event = 'check';\n        deselectInfo.checked = false;\n        deselectInfo.checkedNodes = filteredEntityList.map(function (_ref5) {\n          var node = _ref5.node;\n          return node;\n        });\n        deselectInfo.checkedNodesPositions = filteredEntityList.map(function (_ref6) {\n          var node = _ref6.node,\n              pos = _ref6.pos;\n          return {\n            node: node,\n            pos: pos\n          };\n        });\n\n        if (treeCheckStrictly) {\n          extraInfo.allCheckedNodes = deselectInfo.checkedNodes;\n        } else {\n          // TODO: It's too expansive to get `halfCheckedKeys` in onDeselect. Not pass this.\n          extraInfo.allCheckedNodes = flatToHierarchy(filteredEntityList).map(function (_ref7) {\n            var node = _ref7.node;\n            return node;\n          });\n        }\n      } else {\n        deselectInfo.event = 'select';\n        deselectInfo.selected = false;\n        deselectInfo.selectedNodes = newValueList.map(function (_ref8) {\n          var value = _ref8.value;\n          return (valueEntities[value] || {}).node;\n        });\n      } // Some value user pass prop is not in the tree, we also need clean it\n\n\n      var newMissValueList = missValueList.filter(function (_ref9) {\n        var value = _ref9.value;\n        return value !== removeValue;\n      });\n      var wrappedValue = void 0;\n\n      if (this.isLabelInValue()) {\n        wrappedValue = {\n          label: triggerNode ? getPropsData(triggerNode)[treeNodeLabelProp] : null,\n          value: removeValue\n        };\n      } else {\n        wrappedValue = removeValue;\n      }\n\n      this.onDeselect(wrappedValue, triggerNode, deselectInfo);\n      this.triggerChange(newMissValueList, newValueList, extraInfo);\n    },\n    // ===================== Popup ======================\n    onValueTrigger: function onValueTrigger(isAdd, nodeList, nodeEventInfo, nodeExtraInfo) {\n      var node = nodeEventInfo.node;\n      var value = node.$props.value;\n      var _$data3 = this.$data,\n          missValueList = _$data3._missValueList,\n          valueEntities = _$data3._valueEntities,\n          keyEntities = _$data3._keyEntities,\n          searchValue = _$data3._searchValue;\n      var _$props4 = this.$props,\n          disabled = _$props4.disabled,\n          inputValue = _$props4.inputValue,\n          treeNodeLabelProp = _$props4.treeNodeLabelProp,\n          multiple = _$props4.multiple,\n          treeCheckable = _$props4.treeCheckable,\n          treeCheckStrictly = _$props4.treeCheckStrictly,\n          autoClearSearchValue = _$props4.autoClearSearchValue;\n      var label = node.$props[treeNodeLabelProp];\n      if (disabled) return; // Wrap the return value for user\n\n      var wrappedValue = void 0;\n\n      if (this.isLabelInValue()) {\n        wrappedValue = {\n          value: value,\n          label: label\n        };\n      } else {\n        wrappedValue = value;\n      } // [Legacy] Origin code not trigger `onDeselect` every time. Let's align the behaviour.\n\n\n      if (isAdd) {\n        this.__emit('select', wrappedValue, node, nodeEventInfo);\n      } else {\n        this.__emit('deselect', wrappedValue, node, nodeEventInfo);\n      } // Get wrapped value list.\n      // This is a bit hack cause we use key to match the value.\n\n\n      var newValueList = nodeList.map(function (node) {\n        var props = getPropsData(node);\n        return {\n          value: props.value,\n          label: props[treeNodeLabelProp]\n        };\n      }); // When is `treeCheckable` and with `searchValue`, `valueList` is not full filled.\n      // We need calculate the missing nodes.\n\n      if (treeCheckable && !treeCheckStrictly) {\n        var keyList = newValueList.map(function (_ref10) {\n          var val = _ref10.value;\n          return valueEntities[val].key;\n        });\n\n        if (isAdd) {\n          keyList = conductCheck(keyList, true, keyEntities).checkedKeys;\n        } else {\n          keyList = conductCheck([valueEntities[value].key], false, keyEntities, {\n            checkedKeys: keyList\n          }).checkedKeys;\n        }\n\n        newValueList = keyList.map(function (key) {\n          var props = getPropsData(keyEntities.get(key).node);\n          return {\n            value: props.value,\n            label: props[treeNodeLabelProp]\n          };\n        });\n      } // Clean up `searchValue` when this prop is set\n\n\n      if (autoClearSearchValue || inputValue === null) {\n        // Clean state `searchValue` if uncontrolled\n        if (!this.isSearchValueControlled() && (multiple || treeCheckable)) {\n          this.setUncontrolledState({\n            _searchValue: '',\n            _filteredTreeNodes: null\n          });\n        } // Trigger onSearch if `searchValue` to be empty.\n        // We should also trigger onSearch with empty string here\n        // since if user use `treeExpandedKeys`, it need user have the ability to reset it.\n\n\n        if (searchValue && searchValue.length) {\n          this.__emit('update:searchValue', '');\n\n          this.__emit('search', '');\n        }\n      } // [Legacy] Provide extra info\n\n\n      var extraInfo = _extends({}, nodeExtraInfo, {\n        triggerValue: value,\n        triggerNode: node\n      });\n\n      this.triggerChange(missValueList, newValueList, extraInfo);\n    },\n    onTreeNodeSelect: function onTreeNodeSelect(_, nodeEventInfo) {\n      var _$data4 = this.$data,\n          valueList = _$data4._valueList,\n          valueEntities = _$data4._valueEntities;\n      var _$props5 = this.$props,\n          treeCheckable = _$props5.treeCheckable,\n          multiple = _$props5.multiple;\n      if (treeCheckable) return;\n\n      if (!multiple) {\n        this.setOpenState(false);\n      }\n\n      var isAdd = nodeEventInfo.selected;\n      var selectedValue = nodeEventInfo.node.$props.value;\n      var newValueList = void 0;\n\n      if (!multiple) {\n        newValueList = [{\n          value: selectedValue\n        }];\n      } else {\n        newValueList = valueList.filter(function (_ref11) {\n          var value = _ref11.value;\n          return value !== selectedValue;\n        });\n\n        if (isAdd) {\n          newValueList.push({\n            value: selectedValue\n          });\n        }\n      }\n\n      var selectedNodes = newValueList.map(function (_ref12) {\n        var value = _ref12.value;\n        return valueEntities[value];\n      }).filter(function (entity) {\n        return entity;\n      }).map(function (_ref13) {\n        var node = _ref13.node;\n        return node;\n      });\n      this.onValueTrigger(isAdd, selectedNodes, nodeEventInfo, {\n        selected: isAdd\n      });\n    },\n    onTreeNodeCheck: function onTreeNodeCheck(_, nodeEventInfo) {\n      var _$data5 = this.$data,\n          searchValue = _$data5._searchValue,\n          keyEntities = _$data5._keyEntities,\n          valueEntities = _$data5._valueEntities,\n          valueList = _$data5._valueList;\n      var treeCheckStrictly = this.$props.treeCheckStrictly;\n      var checkedNodes = nodeEventInfo.checkedNodes,\n          checkedNodesPositions = nodeEventInfo.checkedNodesPositions;\n      var isAdd = nodeEventInfo.checked;\n      var extraInfo = {\n        checked: isAdd\n      };\n      var checkedNodeList = checkedNodes; // [Legacy] Check event provide `allCheckedNodes`.\n      // When `treeCheckStrictly` or internal `searchValue` is set, TreeNode will be unrelated:\n      // - Related: Show the top checked nodes and has children prop.\n      // - Unrelated: Show all the checked nodes.\n\n      if (searchValue) {\n        var oriKeyList = valueList.map(function (_ref14) {\n          var value = _ref14.value;\n          return valueEntities[value];\n        }).filter(function (entity) {\n          return entity;\n        }).map(function (_ref15) {\n          var key = _ref15.key;\n          return key;\n        });\n        var keyList = void 0;\n\n        if (isAdd) {\n          keyList = Array.from(new Set([].concat(_toConsumableArray(oriKeyList), _toConsumableArray(checkedNodeList.map(function (node) {\n            var _getPropsData = getPropsData(node),\n                value = _getPropsData.value;\n\n            return valueEntities[value].key;\n          })))));\n        } else {\n          keyList = conductCheck([getPropsData(nodeEventInfo.node).eventKey], false, keyEntities, {\n            checkedKeys: oriKeyList\n          }).checkedKeys;\n        }\n\n        checkedNodeList = keyList.map(function (key) {\n          return keyEntities.get(key).node;\n        }); // Let's follow as not `treeCheckStrictly` format\n\n        extraInfo.allCheckedNodes = keyList.map(function (key) {\n          return cleanEntity(keyEntities.get(key));\n        });\n      } else if (treeCheckStrictly) {\n        extraInfo.allCheckedNodes = nodeEventInfo.checkedNodes;\n      } else {\n        extraInfo.allCheckedNodes = flatToHierarchy(checkedNodesPositions);\n      }\n\n      this.onValueTrigger(isAdd, checkedNodeList, nodeEventInfo, extraInfo);\n    },\n    // ==================== Trigger =====================\n    onDropdownVisibleChange: function onDropdownVisibleChange(open) {\n      var _$props6 = this.$props,\n          multiple = _$props6.multiple,\n          treeCheckable = _$props6.treeCheckable;\n      var _searchValue = this.$data._searchValue; // When set open success and single mode,\n      // we will reset the input content.\n\n      if (open && !multiple && !treeCheckable && _searchValue) {\n        this.setUncontrolledState({\n          _searchValue: '',\n          _filteredTreeNodes: null\n        });\n      }\n\n      this.setOpenState(open, true);\n    },\n    onSearchInputChange: function onSearchInputChange(event) {\n      var value = event.target.value;\n      var _$data6 = this.$data,\n          treeNodes = _$data6._treeNodes,\n          valueEntities = _$data6._valueEntities;\n      var _$props7 = this.$props,\n          filterTreeNode = _$props7.filterTreeNode,\n          treeNodeFilterProp = _$props7.treeNodeFilterProp;\n\n      this.__emit('update:searchValue', value);\n\n      this.__emit('search', value);\n\n      var isSet = false;\n\n      if (!this.isSearchValueControlled()) {\n        isSet = this.setUncontrolledState({\n          _searchValue: value\n        });\n        this.setOpenState(true);\n      }\n\n      if (isSet) {\n        // Do the search logic\n        var upperSearchValue = String(value).toUpperCase();\n        var filterTreeNodeFn = filterTreeNode;\n\n        if (filterTreeNode === false) {\n          filterTreeNodeFn = function filterTreeNodeFn() {\n            return true;\n          };\n        } else if (!filterTreeNodeFn) {\n          filterTreeNodeFn = function filterTreeNodeFn(_, node) {\n            var nodeValue = String(getPropsData(node)[treeNodeFilterProp]).toUpperCase();\n            return nodeValue.indexOf(upperSearchValue) !== -1;\n          };\n        }\n\n        this.setState({\n          _filteredTreeNodes: getFilterTree(this.$createElement, treeNodes, value, filterTreeNodeFn, valueEntities, SelectNode)\n        });\n      }\n    },\n    onSearchInputKeyDown: function onSearchInputKeyDown(event) {\n      var _$data7 = this.$data,\n          searchValue = _$data7._searchValue,\n          valueList = _$data7._valueList;\n      var keyCode = event.keyCode;\n\n      if (KeyCode.BACKSPACE === keyCode && this.isMultiple() && !searchValue && valueList.length) {\n        var lastValue = valueList[valueList.length - 1].value;\n        this.onMultipleSelectorRemove(event, lastValue);\n      }\n    },\n    onChoiceAnimationLeave: function onChoiceAnimationLeave() {\n      var _this4 = this;\n\n      raf(function () {\n        _this4.forcePopupAlign();\n      });\n    },\n    setPopupRef: function setPopupRef(popup) {\n      this.popup = popup;\n    },\n\n    /**\n     * Only update the value which is not in props\n     */\n    setUncontrolledState: function setUncontrolledState(state) {\n      var needSync = false;\n      var newState = {};\n      var props = getOptionProps(this);\n      Object.keys(state).forEach(function (name) {\n        if (name.slice(1) in props) return;\n        needSync = true;\n        newState[name] = state[name];\n      });\n\n      if (needSync) {\n        this.setState(newState);\n      }\n\n      return needSync;\n    },\n    // [Legacy] Origin provide `documentClickClose` which triggered by `Trigger`\n    // Currently `TreeSelect` align the hide popup logic as `Select` which blur to hide.\n    // `documentClickClose` is not accurate anymore. Let's just keep the key word.\n    setOpenState: function setOpenState(open) {\n      var byTrigger = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var dropdownVisibleChange = this.$props.dropdownVisibleChange;\n\n      if (dropdownVisibleChange && dropdownVisibleChange(open, {\n        documentClickClose: !open && byTrigger\n      }) === false) {\n        return;\n      }\n\n      this.setUncontrolledState({\n        _open: open\n      });\n    },\n    // Tree checkable is also a multiple case\n    isMultiple: function isMultiple() {\n      var _$props8 = this.$props,\n          multiple = _$props8.multiple,\n          treeCheckable = _$props8.treeCheckable;\n      return !!(multiple || treeCheckable);\n    },\n    isLabelInValue: function isLabelInValue() {\n      return _isLabelInValue(this.$props);\n    },\n    // [Legacy] To align with `Select` component,\n    // We use `searchValue` instead of `inputValue`\n    // but currently still need support that.\n    // Add this method the check if is controlled\n    isSearchValueControlled: function isSearchValueControlled() {\n      var props = getOptionProps(this);\n      var inputValue = props.inputValue;\n      if ('searchValue' in props) return true;\n      return 'inputValue' in props && inputValue !== null;\n    },\n    forcePopupAlign: function forcePopupAlign() {\n      var $trigger = this.selectTriggerRef.current;\n\n      if ($trigger) {\n        $trigger.forcePopupAlign();\n      }\n    },\n    delayForcePopupAlign: function delayForcePopupAlign() {\n      var _this5 = this; // Wait 2 frame to avoid dom update & dom algin in the same time\n      // https://github.com/ant-design/ant-design/issues/12031\n\n\n      raf(function () {\n        raf(_this5.forcePopupAlign);\n      });\n    },\n\n    /**\n     * 1. Update state valueList.\n     * 2. Fire `onChange` event to user.\n     */\n    triggerChange: function triggerChange(missValueList, valueList) {\n      var extraInfo = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var _$data8 = this.$data,\n          valueEntities = _$data8._valueEntities,\n          searchValue = _$data8._searchValue,\n          prevSelectorValueList = _$data8._selectorValueList;\n      var props = getOptionProps(this);\n      var disabled = props.disabled,\n          treeCheckable = props.treeCheckable,\n          treeCheckStrictly = props.treeCheckStrictly;\n      if (disabled) return; // Trigger\n\n      var extra = _extends({\n        // [Legacy] Always return as array contains label & value\n        preValue: prevSelectorValueList.map(function (_ref16) {\n          var label = _ref16.label,\n              value = _ref16.value;\n          return {\n            label: label,\n            value: value\n          };\n        })\n      }, extraInfo); // Format value by `treeCheckStrictly`\n\n\n      var selectorValueList = formatSelectorValue(valueList, props, valueEntities);\n\n      if (!('value' in props)) {\n        var newState = {\n          _missValueList: missValueList,\n          _valueList: valueList,\n          _selectorValueList: selectorValueList\n        };\n\n        if (searchValue && treeCheckable && !treeCheckStrictly) {\n          newState._searchHalfCheckedKeys = getHalfCheckedKeys(valueList, valueEntities);\n        }\n\n        this.setState(newState);\n      } // Only do the logic when `onChange` function provided\n\n\n      if (getListeners(this).change) {\n        var connectValueList = void 0; // Get value by mode\n\n        if (this.isMultiple()) {\n          connectValueList = [].concat(_toConsumableArray(missValueList), _toConsumableArray(selectorValueList));\n        } else {\n          connectValueList = selectorValueList.slice(0, 1);\n        }\n\n        var labelList = null;\n        var returnValue = void 0;\n\n        if (this.isLabelInValue()) {\n          returnValue = connectValueList.map(function (_ref17) {\n            var label = _ref17.label,\n                value = _ref17.value;\n            return {\n              label: label,\n              value: value\n            };\n          });\n        } else {\n          labelList = [];\n          returnValue = connectValueList.map(function (_ref18) {\n            var label = _ref18.label,\n                value = _ref18.value;\n            labelList.push(label);\n            return value;\n          });\n        }\n\n        if (!this.isMultiple()) {\n          returnValue = returnValue[0];\n        }\n\n        this.__emit('change', returnValue, labelList, extra);\n      }\n    },\n    focus: function focus() {\n      this.selectorRef.current.focus();\n    },\n    blur: function blur() {\n      this.selectorRef.current.blur();\n    }\n  },\n  // ===================== Render =====================\n  render: function render() {\n    var h = arguments[0];\n    var _$data9 = this.$data,\n        valueList = _$data9._valueList,\n        missValueList = _$data9._missValueList,\n        selectorValueList = _$data9._selectorValueList,\n        searchHalfCheckedKeys = _$data9._searchHalfCheckedKeys,\n        valueEntities = _$data9._valueEntities,\n        keyEntities = _$data9._keyEntities,\n        searchValue = _$data9._searchValue,\n        open = _$data9._open,\n        focused = _$data9._focused,\n        treeNodes = _$data9._treeNodes,\n        filteredTreeNodes = _$data9._filteredTreeNodes;\n    var props = getOptionProps(this);\n    var prefixCls = props.prefixCls,\n        treeExpandedKeys = props.treeExpandedKeys;\n    var isMultiple = this.isMultiple();\n    var passProps = {\n      props: _extends({}, props, {\n        isMultiple: isMultiple,\n        valueList: valueList,\n        searchHalfCheckedKeys: searchHalfCheckedKeys,\n        selectorValueList: [].concat(_toConsumableArray(missValueList), _toConsumableArray(selectorValueList)),\n        valueEntities: valueEntities,\n        keyEntities: keyEntities,\n        searchValue: searchValue,\n        upperSearchValue: (searchValue || '').toUpperCase(),\n        // Perf save\n        open: open,\n        focused: focused,\n        dropdownPrefixCls: prefixCls + '-dropdown',\n        ariaId: this.ariaId\n      }),\n      on: _extends({}, getListeners(this), {\n        choiceAnimationLeave: this.onChoiceAnimationLeave\n      }),\n      scopedSlots: this.$scopedSlots\n    };\n    var popupProps = mergeProps(passProps, {\n      props: {\n        treeNodes: treeNodes,\n        filteredTreeNodes: filteredTreeNodes,\n        // Tree expanded control\n        treeExpandedKeys: treeExpandedKeys,\n        __propsSymbol__: Symbol()\n      },\n      on: {\n        treeExpanded: this.delayForcePopupAlign\n      },\n      directives: [{\n        name: 'ant-ref',\n        value: this.setPopupRef\n      }]\n    });\n    var Popup = isMultiple ? MultiplePopup : SinglePopup;\n    var $popup = h(Popup, popupProps);\n    var Selector = isMultiple ? MultipleSelector : SingleSelector;\n    var $selector = h(Selector, _mergeJSXProps([passProps, {\n      directives: [{\n        name: 'ant-ref',\n        value: this.selectorRef\n      }]\n    }]));\n    var selectTriggerProps = mergeProps(passProps, {\n      props: {\n        popupElement: $popup,\n        dropdownVisibleChange: this.onDropdownVisibleChange\n      },\n      directives: [{\n        name: 'ant-ref',\n        value: this.selectTriggerRef\n      }]\n    });\n    return h(SelectTrigger, selectTriggerProps, [$selector]);\n  }\n};\nSelect.TreeNode = SelectNode;\nSelect.SHOW_ALL = SHOW_ALL;\nSelect.SHOW_PARENT = SHOW_PARENT;\nSelect.SHOW_CHILD = SHOW_CHILD; // Let warning show correct component name\n\nSelect.name = 'TreeSelect';\nexport default Select;","map":{"version":3,"sources":["/Users/liulu/刘璐/vue3/hello-vue3/node_modules/ant-design-vue/es/vc-tree-select/src/Select.js"],"names":["_mergeJSXProps","_toConsumableArray","_extends","shallowEqual","raf","scrollIntoView","warning","PropTypes","KeyCode","SelectTrigger","SingleSelector","MultipleSelector","SinglePopup","MultiplePopup","SHOW_ALL","SHOW_PARENT","SHOW_CHILD","BaseMixin","createRef","generateAriaId","formatInternalValue","formatSelectorValue","parseSimpleTreeData","convertDataToTree","convertTreeToEntities","conductCheck","getHalfCheckedKeys","flatToHierarchy","isPosRelated","isLabelInValue","_isLabelInValue","getFilterTree","cleanEntity","findPopupContainer","SelectNode","initDefaultProps","getOptionProps","mergeProps","getPropsData","filterEmpty","getListeners","getWatch","keys","arguments","length","undefined","watch","forEach","k","needSyncKeys","Select","name","mixins","props","prefixCls","string","prefixAria","multiple","bool","showArrow","open","value","any","autoFocus","defaultOpen","defaultValue","showSearch","placeholder","inputValue","searchValue","autoClearSearchValue","searchPlaceholder","disabled","children","labelInValue","maxTagCount","number","maxTagPlaceholder","oneOfType","func","maxTagTextLength","showCheckedStrategy","oneOf","dropdownClassName","dropdownStyle","object","dropdownVisibleChange","dropdownMatchSelectWidth","treeData","array","treeDataSimpleMode","treeNodeFilterProp","treeNodeLabelProp","treeCheckable","treeCheckStrictly","treeIcon","treeLine","treeDefaultExpandAll","treeDefaultExpandedKeys","treeExpandedKeys","loadData","filterTreeNode","notFoundContent","getPopupContainer","allowClear","transitionName","animation","choiceTransitionName","inputIcon","clearIcon","removeIcon","switcherIcon","__propsSymbol__","data","$props","_$props","selectorRef","selectTriggerRef","ariaId","state","_open","_valueList","_searchHalfCheckedKeys","_missValueList","_selectorValueList","_valueEntities","_posEntities","Map","_keyEntities","_searchValue","_prevProps","_init","_focused","_treeNodes","_filteredTreeNodes","newState","getDerivedState","provide","vcTreeSelect","onSelectorFocus","onSelectorBlur","onSelectorKeyDown","onComponentKeyDown","onSelectorClear","onMultipleSelectorRemove","onTreeNodeSelect","onTreeNodeCheck","onPopupKeyDown","onSearchInputChange","onSearchInputKeyDown","$data","setState","$data_valueList","_this","$nextTick","forcePopupAlign","$data_open","_this2","setTimeout","_$data","selectorValueList","valueEntities","isMultiple","popup","_popup$getTree","getTree","domTreeNodes","_ref","key","treeNode","domNode","$el","popupNode","triggerContainer","searchNode","searchRef","current","onlyScrollIfNeeded","offsetTop","offsetHeight","mounted","_this3","_$props2","focus","methods","nextProps","prevState","h","$createElement","_prevState$_prevProps","prevProps","self","processState","propName","updater","valueRefresh","propValue","treeNodes","treeDataChanged","treeDataModeChanged","prevValue","prev","simpleMapper","id","pId","rootPId","$slots","entitiesMap","posEntities","keyEntities","missValueList","filteredValueList","keyList","latestValueList","concat","valueLabels","wrapperValue","label","entity","push","_conductCheck","checkedKeys","map","val","get","wrappedValue","upperSearchValue","String","toUpperCase","filterTreeNodeFn","_","node","nodeValue","indexOf","event","keyCode","ENTER","DOWN","setOpenState","ESC","UP","LEFT","RIGHT","stopPropagation","onDeselect","nodeEventInfo","__emit","triggerChange","isSearchValueControlled","setUncontrolledState","removeValue","_$data2","valueList","_$props3","triggerEntity","newValueList","filter","_ref2","pos","_ref3","triggerNode","extraInfo","triggerValue","deselectInfo","filteredEntityList","_ref4","checked","checkedNodes","_ref5","checkedNodesPositions","_ref6","allCheckedNodes","_ref7","selected","selectedNodes","_ref8","newMissValueList","_ref9","onValueTrigger","isAdd","nodeList","nodeExtraInfo","_$data3","_$props4","_ref10","_$data4","_$props5","selectedValue","_ref11","_ref12","_ref13","_$data5","checkedNodeList","oriKeyList","_ref14","_ref15","Array","from","Set","_getPropsData","eventKey","onDropdownVisibleChange","_$props6","target","_$data6","_$props7","isSet","_$data7","BACKSPACE","lastValue","onChoiceAnimationLeave","_this4","setPopupRef","needSync","Object","slice","byTrigger","documentClickClose","_$props8","$trigger","delayForcePopupAlign","_this5","_$data8","prevSelectorValueList","extra","preValue","_ref16","change","connectValueList","labelList","returnValue","_ref17","_ref18","blur","render","_$data9","searchHalfCheckedKeys","focused","filteredTreeNodes","passProps","dropdownPrefixCls","on","choiceAnimationLeave","scopedSlots","$scopedSlots","popupProps","Symbol","treeExpanded","directives","Popup","$popup","Selector","$selector","selectTriggerProps","popupElement","TreeNode"],"mappings":"AAAA,OAAOA,cAAP,MAA2B,kCAA3B;AACA,OAAOC,kBAAP,MAA+B,yCAA/B;AACA,OAAOC,QAAP,MAAqB,+BAArB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAOC,YAAP,MAAyB,cAAzB;AACA,OAAOC,GAAP,MAAgB,KAAhB;AACA,OAAOC,cAAP,MAA2B,sBAA3B;AACA,OAAOC,OAAP,MAAoB,SAApB;AACA,OAAOC,SAAP,MAAsB,uBAAtB;AACA,OAAOC,OAAP,MAAoB,qBAApB;AAEA,OAAOC,aAAP,MAA0B,iBAA1B;AACA,OAAOC,cAAP,MAA2B,2BAA3B;AACA,OAAOC,gBAAP,MAA6B,6BAA7B;AACA,OAAOC,WAAP,MAAwB,qBAAxB;AACA,OAAOC,aAAP,MAA0B,uBAA1B;AAEA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,UAAhC,QAAkD,cAAlD;AACA,OAAOC,SAAP,MAAsB,uBAAtB;AACA,SAASC,SAAT,EAAoBC,cAApB,EAAoCC,mBAApC,EAAyDC,mBAAzD,EAA8EC,mBAA9E,EAAmGC,iBAAnG,EAAsHC,qBAAtH,EAA6IC,YAA7I,EAA2JC,kBAA3J,EAA+KC,eAA/K,EAAgMC,YAAhM,EAA8MC,cAAc,IAAIC,eAAhO,EAAiPC,aAAjP,EAAgQC,WAAhQ,EAA6QC,kBAA7Q,QAAuS,QAAvS;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,SAASC,gBAAT,EAA2BC,cAA3B,EAA2CC,UAA3C,EAAuDC,YAAvD,EAAqEC,WAArE,EAAkFC,YAAlF,QAAsG,wBAAtG;;AACA,SAASC,QAAT,GAAoB;AAClB,MAAIC,IAAI,GAAGC,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBE,SAAzC,GAAqDF,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAA/E;AAEA,MAAIG,KAAK,GAAG,EAAZ;AACAJ,EAAAA,IAAI,CAACK,OAAL,CAAa,UAAUC,CAAV,EAAa;AACxBF,IAAAA,KAAK,CAACE,CAAD,CAAL,GAAW,YAAY;AACrB,WAAKC,YAAL,CAAkBD,CAAlB,IAAuB,IAAvB;AACD,KAFD;AAGD,GAJD;AAKA,SAAOF,KAAP;AACD;;AACD,IAAII,MAAM,GAAG;AACXC,EAAAA,IAAI,EAAE,QADK;AAEXC,EAAAA,MAAM,EAAE,CAACnC,SAAD,CAFG;AAGXoC,EAAAA,KAAK,EAAElB,gBAAgB,CAAC;AACtBmB,IAAAA,SAAS,EAAE/C,SAAS,CAACgD,MADC;AAEtBC,IAAAA,UAAU,EAAEjD,SAAS,CAACgD,MAFA;AAGtBE,IAAAA,QAAQ,EAAElD,SAAS,CAACmD,IAHE;AAItBC,IAAAA,SAAS,EAAEpD,SAAS,CAACmD,IAJC;AAKtBE,IAAAA,IAAI,EAAErD,SAAS,CAACmD,IALM;AAMtBG,IAAAA,KAAK,EAAEtD,SAAS,CAACuD,GANK;AAQtBC,IAAAA,SAAS,EAAExD,SAAS,CAACmD,IARC;AAUtBM,IAAAA,WAAW,EAAEzD,SAAS,CAACmD,IAVD;AAWtBO,IAAAA,YAAY,EAAE1D,SAAS,CAACuD,GAXF;AAatBI,IAAAA,UAAU,EAAE3D,SAAS,CAACmD,IAbA;AActBS,IAAAA,WAAW,EAAE5D,SAAS,CAACuD,GAdD;AAetBM,IAAAA,UAAU,EAAE7D,SAAS,CAACgD,MAfA;AAeQ;AAC9Bc,IAAAA,WAAW,EAAE9D,SAAS,CAACgD,MAhBD;AAiBtBe,IAAAA,oBAAoB,EAAE/D,SAAS,CAACmD,IAjBV;AAkBtBa,IAAAA,iBAAiB,EAAEhE,SAAS,CAACuD,GAlBP;AAkBY;AAClCU,IAAAA,QAAQ,EAAEjE,SAAS,CAACmD,IAnBE;AAoBtBe,IAAAA,QAAQ,EAAElE,SAAS,CAACuD,GApBE;AAqBtBY,IAAAA,YAAY,EAAEnE,SAAS,CAACmD,IArBF;AAsBtBiB,IAAAA,WAAW,EAAEpE,SAAS,CAACqE,MAtBD;AAuBtBC,IAAAA,iBAAiB,EAAEtE,SAAS,CAACuE,SAAV,CAAoB,CAACvE,SAAS,CAACuD,GAAX,EAAgBvD,SAAS,CAACwE,IAA1B,CAApB,CAvBG;AAwBtBC,IAAAA,gBAAgB,EAAEzE,SAAS,CAACqE,MAxBN;AAyBtBK,IAAAA,mBAAmB,EAAE1E,SAAS,CAAC2E,KAAV,CAAgB,CAACpE,QAAD,EAAWC,WAAX,EAAwBC,UAAxB,CAAhB,CAzBC;AA0BtBmE,IAAAA,iBAAiB,EAAE5E,SAAS,CAACgD,MA1BP;AA2BtB6B,IAAAA,aAAa,EAAE7E,SAAS,CAAC8E,MA3BH;AA4BtBC,IAAAA,qBAAqB,EAAE/E,SAAS,CAACwE,IA5BX;AA6BtBQ,IAAAA,wBAAwB,EAAEhF,SAAS,CAACmD,IA7Bd;AA8BtB8B,IAAAA,QAAQ,EAAEjF,SAAS,CAACkF,KA9BE;AA+BtBC,IAAAA,kBAAkB,EAAEnF,SAAS,CAACuE,SAAV,CAAoB,CAACvE,SAAS,CAACmD,IAAX,EAAiBnD,SAAS,CAAC8E,MAA3B,CAApB,CA/BE;AAgCtBM,IAAAA,kBAAkB,EAAEpF,SAAS,CAACgD,MAhCR;AAiCtBqC,IAAAA,iBAAiB,EAAErF,SAAS,CAACgD,MAjCP;AAkCtBsC,IAAAA,aAAa,EAAEtF,SAAS,CAACuE,SAAV,CAAoB,CAACvE,SAAS,CAACuD,GAAX,EAAgBvD,SAAS,CAAC8E,MAA1B,EAAkC9E,SAAS,CAACmD,IAA5C,CAApB,CAlCO;AAmCtB;AACAoC,IAAAA,iBAAiB,EAAEvF,SAAS,CAACmD,IApCP;AAqCtBqC,IAAAA,QAAQ,EAAExF,SAAS,CAACmD,IArCE;AAsCtBsC,IAAAA,QAAQ,EAAEzF,SAAS,CAACmD,IAtCE;AAuCtBuC,IAAAA,oBAAoB,EAAE1F,SAAS,CAACmD,IAvCV;AAwCtBwC,IAAAA,uBAAuB,EAAE3F,SAAS,CAACkF,KAxCb;AAyCtBU,IAAAA,gBAAgB,EAAE5F,SAAS,CAACkF,KAzCN;AA0CtBW,IAAAA,QAAQ,EAAE7F,SAAS,CAACwE,IA1CE;AA2CtBsB,IAAAA,cAAc,EAAE9F,SAAS,CAACuE,SAAV,CAAoB,CAACvE,SAAS,CAACwE,IAAX,EAAiBxE,SAAS,CAACmD,IAA3B,CAApB,CA3CM;AA6CtB4C,IAAAA,eAAe,EAAE/F,SAAS,CAACuD,GA7CL;AA8CtByC,IAAAA,iBAAiB,EAAEhG,SAAS,CAACwE,IA9CP;AAgDtB;AACA;AACA;AACA;AACA;AAEA;AACAyB,IAAAA,UAAU,EAAEjG,SAAS,CAACmD,IAvDA;AAwDtB+C,IAAAA,cAAc,EAAElG,SAAS,CAACgD,MAxDJ;AAyDtBmD,IAAAA,SAAS,EAAEnG,SAAS,CAACgD,MAzDC;AA0DtBoD,IAAAA,oBAAoB,EAAEpG,SAAS,CAACgD,MA1DV;AA2DtBqD,IAAAA,SAAS,EAAErG,SAAS,CAACuD,GA3DC;AA4DtB+C,IAAAA,SAAS,EAAEtG,SAAS,CAACuD,GA5DC;AA6DtBgD,IAAAA,UAAU,EAAEvG,SAAS,CAACuD,GA7DA;AA8DtBiD,IAAAA,YAAY,EAAExG,SAAS,CAACuD,GA9DF;AA+DtBkD,IAAAA,eAAe,EAAEzG,SAAS,CAACuD;AA/DL,GAAD,EAgEpB;AACDR,IAAAA,SAAS,EAAE,gBADV;AAEDE,IAAAA,UAAU,EAAE,gBAFX;AAGDU,IAAAA,UAAU,EAAE,IAHX;AAIDI,IAAAA,oBAAoB,EAAE,IAJrB;AAKDW,IAAAA,mBAAmB,EAAEjE,UALpB;AAOD;AACA;AACA;AACA2E,IAAAA,kBAAkB,EAAE,OAVnB;AAWDC,IAAAA,iBAAiB,EAAE,OAXlB;AAYDG,IAAAA,QAAQ,EAAE,KAZT;AAaDO,IAAAA,eAAe,EAAE,WAbhB;AAcDlB,IAAAA,aAAa,EAAE,EAdd;AAeDE,IAAAA,qBAAqB,EAAE,SAASA,qBAAT,GAAiC;AACtD,aAAO,IAAP;AACD;AAjBA,GAhEoB,CAHZ;AAuFX2B,EAAAA,IAAI,EAAE,SAASA,IAAT,GAAgB;AACpB3G,IAAAA,OAAO,CAAC,KAAK4G,MAAL,CAAYF,eAAb,EAA8B,2BAA9B,CAAP;AACA,QAAIG,OAAO,GAAG,KAAKD,MAAnB;AAAA,QACI1D,UAAU,GAAG2D,OAAO,CAAC3D,UADzB;AAAA,QAEIQ,WAAW,GAAGmD,OAAO,CAACnD,WAF1B;AAAA,QAGIJ,IAAI,GAAGuD,OAAO,CAACvD,IAHnB;AAKA,SAAKX,YAAL,GAAoB,EAApB;AACA,SAAKmE,WAAL,GAAmBlG,SAAS,EAA5B;AACA,SAAKmG,gBAAL,GAAwBnG,SAAS,EAAjC,CAToB,CAWpB;AACA;;AACA,SAAKoG,MAAL,GAAcnG,cAAc,CAACqC,UAAU,GAAG,OAAd,CAA5B;AAEA,QAAI+D,KAAK,GAAG;AACVC,MAAAA,KAAK,EAAE5D,IAAI,IAAII,WADL;AAEVyD,MAAAA,UAAU,EAAE,EAFF;AAGVC,MAAAA,sBAAsB,EAAE,EAHd;AAIVC,MAAAA,cAAc,EAAE,EAJN;AAIU;AACpBC,MAAAA,kBAAkB,EAAE,EALV;AAKc;AACxBC,MAAAA,cAAc,EAAE,EANN;AAOVC,MAAAA,YAAY,EAAE,IAAIC,GAAJ,EAPJ;AAQVC,MAAAA,YAAY,EAAE,IAAID,GAAJ,EARJ;AASVE,MAAAA,YAAY,EAAE,EATJ;AAUVC,MAAAA,UAAU,EAAE,EAVF;AAWVC,MAAAA,KAAK,EAAE,IAXG;AAYVC,MAAAA,QAAQ,EAAEvF,SAZA;AAaVwF,MAAAA,UAAU,EAAExF,SAbF;AAcVyF,MAAAA,kBAAkB,EAAEzF;AAdV,KAAZ;AAgBA,QAAI0F,QAAQ,GAAG,KAAKC,eAAL,CAAqB,KAAKtB,MAA1B,EAAkCK,KAAlC,CAAf;AACA,WAAOrH,QAAQ,CAAC,EAAD,EAAKqH,KAAL,EAAYgB,QAAZ,CAAf;AACD,GAxHU;AAyHXE,EAAAA,OAAO,EAAE,SAASA,OAAT,GAAmB;AAC1B,WAAO;AACLC,MAAAA,YAAY,EAAE;AACZC,QAAAA,eAAe,EAAE,KAAKA,eADV;AAEZC,QAAAA,cAAc,EAAE,KAAKA,cAFT;AAGZC,QAAAA,iBAAiB,EAAE,KAAKC,kBAHZ;AAIZC,QAAAA,eAAe,EAAE,KAAKA,eAJV;AAKZC,QAAAA,wBAAwB,EAAE,KAAKA,wBALnB;AAOZC,QAAAA,gBAAgB,EAAE,KAAKA,gBAPX;AAQZC,QAAAA,eAAe,EAAE,KAAKA,eARV;AASZC,QAAAA,cAAc,EAAE,KAAKL,kBATT;AAWZM,QAAAA,mBAAmB,EAAE,KAAKA,mBAXd;AAYZC,QAAAA,oBAAoB,EAAE,KAAKA;AAZf;AADT,KAAP;AAgBD,GA1IU;AA4IXvG,EAAAA,KAAK,EAAE5C,QAAQ,CAAC,EAAD,EAAKuC,QAAQ,CAAC,CAAC,UAAD,EAAa,cAAb,EAA6B,OAA7B,CAAD,CAAb,EAAsD;AACnEuE,IAAAA,eAAe,EAAE,SAASA,eAAT,GAA2B;AAC1C,UAAIO,KAAK,GAAG,KAAKiB,eAAL,CAAqB,KAAKtB,MAA1B,EAAkC,KAAKoC,KAAvC,CAAZ;AACA,WAAKC,QAAL,CAAchC,KAAd;AACA,WAAKtE,YAAL,GAAoB,EAApB;AACD,KALkE;AAMnE,wBAAoB,SAASuG,eAAT,GAA2B;AAC7C,UAAIC,KAAK,GAAG,IAAZ;;AAEA,WAAKC,SAAL,CAAe,YAAY;AACzBD,QAAAA,KAAK,CAACE,eAAN;AACD,OAFD;AAGD,KAZkE;AAanE,mBAAe,SAASC,UAAT,CAAoBhG,IAApB,EAA0B;AACvC,UAAIiG,MAAM,GAAG,IAAb;;AAEAC,MAAAA,UAAU,CAAC,YAAY;AACrB,YAAIxG,SAAS,GAAGuG,MAAM,CAAC3C,MAAP,CAAc5D,SAA9B;AACA,YAAIyG,MAAM,GAAGF,MAAM,CAACP,KAApB;AAAA,YACIU,iBAAiB,GAAGD,MAAM,CAACnC,kBAD/B;AAAA,YAEIqC,aAAa,GAAGF,MAAM,CAAClC,cAF3B;;AAIA,YAAIqC,UAAU,GAAGL,MAAM,CAACK,UAAP,EAAjB,CANqB,CAQrB;;;AACA,YAAI,CAACA,UAAD,IAAeF,iBAAiB,CAACpH,MAAjC,IAA2CgB,IAA3C,IAAmDiG,MAAM,CAACM,KAA9D,EAAqE;AACnE,cAAItG,KAAK,GAAGmG,iBAAiB,CAAC,CAAD,CAAjB,CAAqBnG,KAAjC;;AAEA,cAAIuG,cAAc,GAAGP,MAAM,CAACM,KAAP,CAAaE,OAAb,EAArB;AAAA,cACIC,YAAY,GAAGF,cAAc,CAACE,YADlC;;AAGA,cAAIC,IAAI,GAAGN,aAAa,CAACpG,KAAD,CAAb,IAAwB,EAAnC;AAAA,cACI2G,GAAG,GAAGD,IAAI,CAACC,GADf;;AAGA,cAAIC,QAAQ,GAAGH,YAAY,CAACE,GAAD,CAA3B;;AAEA,cAAIC,QAAJ,EAAc;AACZ,gBAAIC,OAAO,GAAGD,QAAQ,CAACE,GAAvB;AACAvK,YAAAA,GAAG,CAAC,YAAY;AACd,kBAAIwK,SAAS,GAAGf,MAAM,CAACM,KAAP,CAAaQ,GAA7B;AACA,kBAAIE,gBAAgB,GAAG5I,kBAAkB,CAAC2I,SAAD,EAAYtH,SAAS,GAAG,WAAxB,CAAzC;AACA,kBAAIwH,UAAU,GAAGjB,MAAM,CAACM,KAAP,CAAaY,SAAb,CAAuBC,OAAxC;;AAEA,kBAAIN,OAAO,IAAIG,gBAAX,IAA+BC,UAAnC,EAA+C;AAC7CzK,gBAAAA,cAAc,CAACqK,OAAD,EAAUG,gBAAV,EAA4B;AACxCI,kBAAAA,kBAAkB,EAAE,IADoB;AAExCC,kBAAAA,SAAS,EAAEJ,UAAU,CAACK;AAFkB,iBAA5B,CAAd;AAID;AACF,aAXE,CAAH;AAYD;AACF;AACF,OApCS,CAAV;AAqCD;AArDkE,GAAtD,CA5IJ;AAmMXC,EAAAA,OAAO,EAAE,SAASA,OAAT,GAAmB;AAC1B,QAAIC,MAAM,GAAG,IAAb;;AAEA,SAAK3B,SAAL,CAAe,YAAY;AACzB,UAAI4B,QAAQ,GAAGD,MAAM,CAACnE,MAAtB;AAAA,UACInD,SAAS,GAAGuH,QAAQ,CAACvH,SADzB;AAAA,UAEIS,QAAQ,GAAG8G,QAAQ,CAAC9G,QAFxB;;AAIA,UAAIT,SAAS,IAAI,CAACS,QAAlB,EAA4B;AAC1B6G,QAAAA,MAAM,CAACE,KAAP;AACD;AACF,KARD;AASD,GA/MU;AAkNXC,EAAAA,OAAO,EAAE;AACPhD,IAAAA,eAAe,EAAE,SAASA,eAAT,CAAyBiD,SAAzB,EAAoCC,SAApC,EAA+C;AAC9D,UAAIC,CAAC,GAAG,KAAKC,cAAb;AACA,UAAIC,qBAAqB,GAAGH,SAAS,CAACxD,UAAtC;AAAA,UACI4D,SAAS,GAAGD,qBAAqB,KAAKhJ,SAA1B,GAAsC,EAAtC,GAA2CgJ,qBAD3D;AAEA,UAAIhG,aAAa,GAAG4F,SAAS,CAAC5F,aAA9B;AAAA,UACIC,iBAAiB,GAAG2F,SAAS,CAAC3F,iBADlC;AAAA,UAEIO,cAAc,GAAGoF,SAAS,CAACpF,cAF/B;AAAA,UAGIV,kBAAkB,GAAG8F,SAAS,CAAC9F,kBAHnC;AAAA,UAIID,kBAAkB,GAAG+F,SAAS,CAAC/F,kBAJnC;AAMA,UAAI6C,QAAQ,GAAG;AACbL,QAAAA,UAAU,EAAEhI,QAAQ,CAAC,EAAD,EAAKuL,SAAL,CADP;AAEbtD,QAAAA,KAAK,EAAE;AAFM,OAAf;AAIA,UAAI4D,IAAI,GAAG,IAAX,CAd8D,CAe9D;;AACA,eAASC,YAAT,CAAsBC,QAAtB,EAAgCC,OAAhC,EAAyC;AACvC,YAAIJ,SAAS,CAACG,QAAD,CAAT,KAAwBR,SAAS,CAACQ,QAAD,CAAjC,IAA+CF,IAAI,CAAC9I,YAAL,CAAkBgJ,QAAlB,CAAnD,EAAgF;AAC9EC,UAAAA,OAAO,CAACT,SAAS,CAACQ,QAAD,CAAV,EAAsBH,SAAS,CAACG,QAAD,CAA/B,CAAP;AACA,iBAAO,IAAP;AACD;;AACD,eAAO,KAAP;AACD;;AAED,UAAIE,YAAY,GAAG,KAAnB,CAxB8D,CA0B9D;;AACAH,MAAAA,YAAY,CAAC,MAAD,EAAS,UAAUI,SAAV,EAAqB;AACxC7D,QAAAA,QAAQ,CAACf,KAAT,GAAiB4E,SAAjB;AACD,OAFW,CAAZ,CA3B8D,CA+B9D;;AACA,UAAIC,SAAS,GAAG,KAAK,CAArB;AACA,UAAIC,eAAe,GAAG,KAAtB;AACA,UAAIC,mBAAmB,GAAG,KAA1B;AACAP,MAAAA,YAAY,CAAC,UAAD,EAAa,UAAUI,SAAV,EAAqB;AAC5CC,QAAAA,SAAS,GAAG9K,iBAAiB,CAACoK,CAAD,EAAIS,SAAJ,CAA7B;AACAE,QAAAA,eAAe,GAAG,IAAlB;AACD,OAHW,CAAZ;AAKAN,MAAAA,YAAY,CAAC,oBAAD,EAAuB,UAAUI,SAAV,EAAqBI,SAArB,EAAgC;AACjE,YAAI,CAACJ,SAAL,EAAgB;AAEhB,YAAIK,IAAI,GAAG,CAACD,SAAD,IAAcA,SAAS,KAAK,IAA5B,GAAmC,EAAnC,GAAwCA,SAAnD,CAHiE,CAKjE;;AACA,YAAI,CAACrM,YAAY,CAACiM,SAAD,EAAYK,IAAZ,CAAjB,EAAoC;AAClCF,UAAAA,mBAAmB,GAAG,IAAtB;AACD;AACF,OATW,CAAZ,CAxC8D,CAmD9D;;AACA,UAAI7G,kBAAkB,KAAK4G,eAAe,IAAIC,mBAAxB,CAAtB,EAAoE;AAClE,YAAIG,YAAY,GAAGxM,QAAQ,CAAC;AAC1ByM,UAAAA,EAAE,EAAE,IADsB;AAE1BC,UAAAA,GAAG,EAAE,KAFqB;AAG1BC,UAAAA,OAAO,EAAE;AAHiB,SAAD,EAIxBnH,kBAAkB,KAAK,IAAvB,GAA8BA,kBAA9B,GAAmD,EAJ3B,CAA3B;;AAKA2G,QAAAA,SAAS,GAAG9K,iBAAiB,CAACoK,CAAD,EAAIrK,mBAAmB,CAACmK,SAAS,CAACjG,QAAX,EAAqBkH,YAArB,CAAvB,CAA7B;AACD,OA3D6D,CA6D9D;;;AACA,UAAI,CAACjB,SAAS,CAACjG,QAAf,EAAyB;AACvB;AACA;AACA;AACA6G,QAAAA,SAAS,GAAG9J,WAAW,CAAC,KAAKuK,MAAL,CAAY,SAAZ,CAAD,CAAvB;AACD,OAnE6D,CAqE9D;;;AACA,UAAIT,SAAJ,EAAe;AACb,YAAIU,WAAW,GAAGvL,qBAAqB,CAAC6K,SAAD,CAAvC;AACA9D,QAAAA,QAAQ,CAACF,UAAT,GAAsBgE,SAAtB;AACA9D,QAAAA,QAAQ,CAACT,YAAT,GAAwBiF,WAAW,CAACC,WAApC;AACAzE,QAAAA,QAAQ,CAACV,cAAT,GAA0BkF,WAAW,CAAC9C,aAAtC;AACA1B,QAAAA,QAAQ,CAACP,YAAT,GAAwB+E,WAAW,CAACE,WAApC;AAEAd,QAAAA,YAAY,GAAG,IAAf;AACD,OA9E6D,CAgF9D;;;AACA,UAAIT,SAAS,CAACvD,KAAd,EAAqB;AACnB6D,QAAAA,YAAY,CAAC,cAAD,EAAiB,UAAUI,SAAV,EAAqB;AAChD7D,UAAAA,QAAQ,CAACd,UAAT,GAAsBrG,mBAAmB,CAACgL,SAAD,EAAYX,SAAZ,CAAzC;AACAU,UAAAA,YAAY,GAAG,IAAf;AACD,SAHW,CAAZ;AAID;;AAEDH,MAAAA,YAAY,CAAC,OAAD,EAAU,UAAUI,SAAV,EAAqB;AACzC7D,QAAAA,QAAQ,CAACd,UAAT,GAAsBrG,mBAAmB,CAACgL,SAAD,EAAYX,SAAZ,CAAzC;AACAU,QAAAA,YAAY,GAAG,IAAf;AACD,OAHW,CAAZ,CAxF8D,CA6F9D;;AACA,UAAIA,YAAJ,EAAkB;AAChB;AACA,YAAIe,aAAa,GAAG,EAApB;AACA,YAAIC,iBAAiB,GAAG,EAAxB;AACA,YAAIC,OAAO,GAAG,EAAd,CAJgB,CAMhB;;AACA,YAAIC,eAAe,GAAG9E,QAAQ,CAACd,UAA/B;;AACA,YAAI,CAAC4F,eAAL,EAAsB;AACpB;AACAA,UAAAA,eAAe,GAAG,GAAGC,MAAH,CAAUrN,kBAAkB,CAACyL,SAAS,CAACjE,UAAX,CAA5B,EAAoDxH,kBAAkB,CAACyL,SAAS,CAAC/D,cAAX,CAAtE,CAAlB;AACD,SAXe,CAahB;;;AACA,YAAI4F,WAAW,GAAG,EAAlB;AACAF,QAAAA,eAAe,CAACtK,OAAhB,CAAwB,UAAUyK,YAAV,EAAwB;AAC9C,cAAI3J,KAAK,GAAG2J,YAAY,CAAC3J,KAAzB;AAAA,cACI4J,KAAK,GAAGD,YAAY,CAACC,KADzB;AAGA,cAAIC,MAAM,GAAG,CAACnF,QAAQ,CAACV,cAAT,IAA2B6D,SAAS,CAAC7D,cAAtC,EAAsDhE,KAAtD,CAAb;AACA0J,UAAAA,WAAW,CAAC1J,KAAD,CAAX,GAAqB4J,KAArB;;AAEA,cAAIC,MAAJ,EAAY;AACVN,YAAAA,OAAO,CAACO,IAAR,CAAaD,MAAM,CAAClD,GAApB;AACA2C,YAAAA,iBAAiB,CAACQ,IAAlB,CAAuBH,YAAvB;AACA;AACD,WAX6C,CAa9C;;;AACAN,UAAAA,aAAa,CAACS,IAAd,CAAmBH,YAAnB;AACD,SAfD,EAfgB,CAgChB;;AACA,YAAI3H,aAAa,IAAI,CAACC,iBAAtB,EAAyC;AACvC;AACA,cAAI8H,aAAa,GAAGnM,YAAY,CAAC2L,OAAD,EAAU,IAAV,EAAgB7E,QAAQ,CAACP,YAAT,IAAyB0D,SAAS,CAAC1D,YAAnD,CAAhC;AAAA,cACI6F,WAAW,GAAGD,aAAa,CAACC,WADhC,CAFuC,CAKvC;;;AAGAtF,UAAAA,QAAQ,CAACd,UAAT,GAAsBoG,WAAW,CAACC,GAAZ,CAAgB,UAAUtD,GAAV,EAAe;AACnD,gBAAIuD,GAAG,GAAG,CAACxF,QAAQ,CAACP,YAAT,IAAyB0D,SAAS,CAAC1D,YAApC,EAAkDgG,GAAlD,CAAsDxD,GAAtD,EAA2D3G,KAArE;;AAEA,gBAAIoK,YAAY,GAAG;AACjBpK,cAAAA,KAAK,EAAEkK;AADU,aAAnB;;AAIA,gBAAIR,WAAW,CAACQ,GAAD,CAAX,KAAqBlL,SAAzB,EAAoC;AAClCoL,cAAAA,YAAY,CAACR,KAAb,GAAqBF,WAAW,CAACQ,GAAD,CAAhC;AACD;;AAED,mBAAOE,YAAP;AACD,WAZqB,CAAtB;AAaD,SArBD,MAqBO;AACL1F,UAAAA,QAAQ,CAACd,UAAT,GAAsB0F,iBAAtB;AACD,SAxDe,CA0DhB;;;AACA5E,QAAAA,QAAQ,CAACZ,cAAT,GAA0BuF,aAA1B,CA3DgB,CA6DhB;;AACA3E,QAAAA,QAAQ,CAACX,kBAAT,GAA8BvG,mBAAmB,CAACkH,QAAQ,CAACd,UAAV,EAAsBgE,SAAtB,EAAiClD,QAAQ,CAACV,cAAT,IAA2B6D,SAAS,CAAC7D,cAAtE,CAAjD;AACD,OA7J6D,CA+J9D;AACA;AACA;;;AACAmE,MAAAA,YAAY,CAAC,YAAD,EAAe,UAAUI,SAAV,EAAqB;AAC9C,YAAIA,SAAS,KAAK,IAAlB,EAAwB;AACtB7D,UAAAA,QAAQ,CAACN,YAAT,GAAwBmE,SAAxB;AACD;AACF,OAJW,CAAZ,CAlK8D,CAwK9D;;AACAJ,MAAAA,YAAY,CAAC,aAAD,EAAgB,UAAUI,SAAV,EAAqB;AAC/C7D,QAAAA,QAAQ,CAACN,YAAT,GAAwBmE,SAAxB;AACD,OAFW,CAAZ,CAzK8D,CA6K9D;;AACA,UAAI7D,QAAQ,CAACN,YAAT,KAA0BpF,SAA1B,IAAuC6I,SAAS,CAACzD,YAAV,IAA0BoE,SAArE,EAAgF;AAC9E,YAAIhI,WAAW,GAAGkE,QAAQ,CAACN,YAAT,KAA0BpF,SAA1B,GAAsC0F,QAAQ,CAACN,YAA/C,GAA8DyD,SAAS,CAACzD,YAA1F;AACA,YAAIiG,gBAAgB,GAAGC,MAAM,CAAC9J,WAAD,CAAN,CAAoB+J,WAApB,EAAvB;AAEA,YAAIC,gBAAgB,GAAGhI,cAAvB;;AACA,YAAIA,cAAc,KAAK,KAAvB,EAA8B;AAC5B;AACAgI,UAAAA,gBAAgB,GAAG,SAASA,gBAAT,GAA4B;AAC7C,mBAAO,IAAP;AACD,WAFD;AAGD,SALD,MAKO,IAAI,OAAOA,gBAAP,KAA4B,UAAhC,EAA4C;AACjD;AACAA,UAAAA,gBAAgB,GAAG,SAASA,gBAAT,CAA0BC,CAA1B,EAA6BC,IAA7B,EAAmC;AACpD,gBAAIC,SAAS,GAAGL,MAAM,CAAC7L,YAAY,CAACiM,IAAD,CAAZ,CAAmB5I,kBAAnB,CAAD,CAAN,CAA+CyI,WAA/C,EAAhB;AACA,mBAAOI,SAAS,CAACC,OAAV,CAAkBP,gBAAlB,MAAwC,CAAC,CAAhD;AACD,WAHD;AAID;;AAED3F,QAAAA,QAAQ,CAACD,kBAAT,GAA8BvG,aAAa,CAAC,KAAK6J,cAAN,EAAsBrD,QAAQ,CAACF,UAAT,IAAuBqD,SAAS,CAACrD,UAAvD,EAAmEhE,WAAnE,EAAgFgK,gBAAhF,EAAkG9F,QAAQ,CAACV,cAAT,IAA2B6D,SAAS,CAAC7D,cAAvI,EAAuJ3F,UAAvJ,CAA3C;AACD,OAjM6D,CAmM9D;;;AACA,UAAIiK,YAAY,IAAItG,aAAhB,IAAiC,CAACC,iBAAlC,KAAwDyC,QAAQ,CAACN,YAAT,IAAyByD,SAAS,CAACzD,YAA3F,CAAJ,EAA8G;AAC5GM,QAAAA,QAAQ,CAACb,sBAAT,GAAkChG,kBAAkB,CAAC6G,QAAQ,CAACd,UAAV,EAAsBc,QAAQ,CAACV,cAAT,IAA2B6D,SAAS,CAAC7D,cAA3D,CAApD;AACD,OAtM6D,CAwM9D;;;AACAmE,MAAAA,YAAY,CAAC,qBAAD,EAAwB,YAAY;AAC9CzD,QAAAA,QAAQ,CAACX,kBAAT,GAA8BW,QAAQ,CAACX,kBAAT,IAA+BvG,mBAAmB,CAACkH,QAAQ,CAACd,UAAT,IAAuBiE,SAAS,CAACjE,UAAlC,EAA8CgE,SAA9C,EAAyDlD,QAAQ,CAACV,cAAT,IAA2B6D,SAAS,CAAC7D,cAA9F,CAAhF;AACD,OAFW,CAAZ;AAIA,aAAOU,QAAP;AACD,KA/MM;AAiNP;AACAI,IAAAA,eAAe,EAAE,SAASA,eAAT,GAA2B;AAC1C,WAAKY,QAAL,CAAc;AAAEnB,QAAAA,QAAQ,EAAE;AAAZ,OAAd;AACD,KApNM;AAqNPQ,IAAAA,cAAc,EAAE,SAASA,cAAT,GAA0B;AACxC,WAAKW,QAAL,CAAc;AAAEnB,QAAAA,QAAQ,EAAE;AAAZ,OAAd,EADwC,CAGxC;AACA;AACD,KA1NM;AA6NP;AACAU,IAAAA,kBAAkB,EAAE,SAASA,kBAAT,CAA4B4F,KAA5B,EAAmC;AACrD,UAAI9K,IAAI,GAAG,KAAK0F,KAAL,CAAW9B,KAAtB;AACA,UAAImH,OAAO,GAAGD,KAAK,CAACC,OAApB;;AAGA,UAAI,CAAC/K,IAAL,EAAW;AACT,YAAI,CAACpD,OAAO,CAACoO,KAAT,EAAgBpO,OAAO,CAACqO,IAAxB,EAA8BJ,OAA9B,CAAsCE,OAAtC,MAAmD,CAAC,CAAxD,EAA2D;AACzD,eAAKG,YAAL,CAAkB,IAAlB;AACD;AACF,OAJD,MAIO,IAAItO,OAAO,CAACuO,GAAR,KAAgBJ,OAApB,EAA6B;AAClC,aAAKG,YAAL,CAAkB,KAAlB;AACD,OAFM,MAEA,IAAI,CAACtO,OAAO,CAACwO,EAAT,EAAaxO,OAAO,CAACqO,IAArB,EAA2BrO,OAAO,CAACyO,IAAnC,EAAyCzO,OAAO,CAAC0O,KAAjD,EAAwDT,OAAxD,CAAgEE,OAAhE,MAA6E,CAAC,CAAlF,EAAqF;AAC1F;AACAD,QAAAA,KAAK,CAACS,eAAN;AACD;AACF,KA7OM;AA8OPC,IAAAA,UAAU,EAAE,SAASA,UAAT,CAAoBnB,YAApB,EAAkCM,IAAlC,EAAwCc,aAAxC,EAAuD;AACjE,WAAKC,MAAL,CAAY,UAAZ,EAAwBrB,YAAxB,EAAsCM,IAAtC,EAA4Cc,aAA5C;AACD,KAhPM;AAiPPtG,IAAAA,eAAe,EAAE,SAASA,eAAT,CAAyB2F,KAAzB,EAAgC;AAC/C,UAAIlK,QAAQ,GAAG,KAAK0C,MAAL,CAAY1C,QAA3B;AAEA,UAAIA,QAAJ,EAAc;AAEd,WAAK+K,aAAL,CAAmB,EAAnB,EAAuB,EAAvB;;AAEA,UAAI,CAAC,KAAKC,uBAAL,EAAL,EAAqC;AACnC,aAAKC,oBAAL,CAA0B;AACxBxH,UAAAA,YAAY,EAAE,EADU;AAExBK,UAAAA,kBAAkB,EAAE;AAFI,SAA1B;AAID;;AAEDoG,MAAAA,KAAK,CAACS,eAAN;AACD,KAhQM;AAiQPnG,IAAAA,wBAAwB,EAAE,SAASA,wBAAT,CAAkC0F,KAAlC,EAAyCgB,WAAzC,EAAsD;AAC9EhB,MAAAA,KAAK,CAACS,eAAN;AAEA,UAAIQ,OAAO,GAAG,KAAKrG,KAAnB;AAAA,UACIsG,SAAS,GAAGD,OAAO,CAAClI,UADxB;AAAA,UAEIyF,aAAa,GAAGyC,OAAO,CAAChI,cAF5B;AAAA,UAGIsC,aAAa,GAAG0F,OAAO,CAAC9H,cAH5B;AAIA,UAAIgI,QAAQ,GAAG,KAAK3I,MAApB;AAAA,UACIrB,aAAa,GAAGgK,QAAQ,CAAChK,aAD7B;AAAA,UAEIC,iBAAiB,GAAG+J,QAAQ,CAAC/J,iBAFjC;AAAA,UAGIF,iBAAiB,GAAGiK,QAAQ,CAACjK,iBAHjC;AAAA,UAIIpB,QAAQ,GAAGqL,QAAQ,CAACrL,QAJxB;AAMA,UAAIA,QAAJ,EAAc,OAbgE,CAe9E;;AACA,UAAIsL,aAAa,GAAG7F,aAAa,CAACyF,WAAD,CAAjC,CAhB8E,CAkB9E;;AACA,UAAIK,YAAY,GAAGH,SAAnB;;AACA,UAAIE,aAAJ,EAAmB;AACjB;AACA,YAAIjK,aAAa,IAAI,CAACC,iBAAtB,EAAyC;AACvCiK,UAAAA,YAAY,GAAGH,SAAS,CAACI,MAAV,CAAiB,UAAUC,KAAV,EAAiB;AAC/C,gBAAIpM,KAAK,GAAGoM,KAAK,CAACpM,KAAlB;AAEA,gBAAI6J,MAAM,GAAGzD,aAAa,CAACpG,KAAD,CAA1B;AACA,mBAAO,CAACjC,YAAY,CAAC8L,MAAM,CAACwC,GAAR,EAAaJ,aAAa,CAACI,GAA3B,CAApB;AACD,WALc,CAAf;AAMD,SAPD,MAOO;AACLH,UAAAA,YAAY,GAAGH,SAAS,CAACI,MAAV,CAAiB,UAAUG,KAAV,EAAiB;AAC/C,gBAAItM,KAAK,GAAGsM,KAAK,CAACtM,KAAlB;AACA,mBAAOA,KAAK,KAAK6L,WAAjB;AACD,WAHc,CAAf;AAID;AACF;;AAED,UAAIU,WAAW,GAAGN,aAAa,GAAGA,aAAa,CAACvB,IAAjB,GAAwB,IAAvD;AAEA,UAAI8B,SAAS,GAAG;AACdC,QAAAA,YAAY,EAAEZ,WADA;AAEdU,QAAAA,WAAW,EAAEA;AAFC,OAAhB;AAIA,UAAIG,YAAY,GAAG;AACjBhC,QAAAA,IAAI,EAAE6B;AADW,OAAnB,CA3C8E,CA+C9E;;AACA,UAAIvK,aAAJ,EAAmB;AACjB,YAAI2K,kBAAkB,GAAGT,YAAY,CAACjC,GAAb,CAAiB,UAAU2C,KAAV,EAAiB;AACzD,cAAI5M,KAAK,GAAG4M,KAAK,CAAC5M,KAAlB;AACA,iBAAOoG,aAAa,CAACpG,KAAD,CAApB;AACD,SAHwB,CAAzB;AAKA0M,QAAAA,YAAY,CAAC7B,KAAb,GAAqB,OAArB;AACA6B,QAAAA,YAAY,CAACG,OAAb,GAAuB,KAAvB;AACAH,QAAAA,YAAY,CAACI,YAAb,GAA4BH,kBAAkB,CAAC1C,GAAnB,CAAuB,UAAU8C,KAAV,EAAiB;AAClE,cAAIrC,IAAI,GAAGqC,KAAK,CAACrC,IAAjB;AACA,iBAAOA,IAAP;AACD,SAH2B,CAA5B;AAIAgC,QAAAA,YAAY,CAACM,qBAAb,GAAqCL,kBAAkB,CAAC1C,GAAnB,CAAuB,UAAUgD,KAAV,EAAiB;AAC3E,cAAIvC,IAAI,GAAGuC,KAAK,CAACvC,IAAjB;AAAA,cACI2B,GAAG,GAAGY,KAAK,CAACZ,GADhB;AAEA,iBAAO;AACL3B,YAAAA,IAAI,EAAEA,IADD;AAEL2B,YAAAA,GAAG,EAAEA;AAFA,WAAP;AAID,SAPoC,CAArC;;AASA,YAAIpK,iBAAJ,EAAuB;AACrBuK,UAAAA,SAAS,CAACU,eAAV,GAA4BR,YAAY,CAACI,YAAzC;AACD,SAFD,MAEO;AACL;AACAN,UAAAA,SAAS,CAACU,eAAV,GAA4BpP,eAAe,CAAC6O,kBAAD,CAAf,CAAoC1C,GAApC,CAAwC,UAAUkD,KAAV,EAAiB;AACnF,gBAAIzC,IAAI,GAAGyC,KAAK,CAACzC,IAAjB;AACA,mBAAOA,IAAP;AACD,WAH2B,CAA5B;AAID;AACF,OA9BD,MA8BO;AACLgC,QAAAA,YAAY,CAAC7B,KAAb,GAAqB,QAArB;AACA6B,QAAAA,YAAY,CAACU,QAAb,GAAwB,KAAxB;AACAV,QAAAA,YAAY,CAACW,aAAb,GAA6BnB,YAAY,CAACjC,GAAb,CAAiB,UAAUqD,KAAV,EAAiB;AAC7D,cAAItN,KAAK,GAAGsN,KAAK,CAACtN,KAAlB;AACA,iBAAO,CAACoG,aAAa,CAACpG,KAAD,CAAb,IAAwB,EAAzB,EAA6B0K,IAApC;AACD,SAH4B,CAA7B;AAID,OArF6E,CAuF9E;;;AACA,UAAI6C,gBAAgB,GAAGlE,aAAa,CAAC8C,MAAd,CAAqB,UAAUqB,KAAV,EAAiB;AAC3D,YAAIxN,KAAK,GAAGwN,KAAK,CAACxN,KAAlB;AACA,eAAOA,KAAK,KAAK6L,WAAjB;AACD,OAHsB,CAAvB;AAIA,UAAIzB,YAAY,GAAG,KAAK,CAAxB;;AACA,UAAI,KAAKpM,cAAL,EAAJ,EAA2B;AACzBoM,QAAAA,YAAY,GAAG;AACbR,UAAAA,KAAK,EAAE2C,WAAW,GAAG9N,YAAY,CAAC8N,WAAD,CAAZ,CAA0BxK,iBAA1B,CAAH,GAAkD,IADvD;AAEb/B,UAAAA,KAAK,EAAE6L;AAFM,SAAf;AAID,OALD,MAKO;AACLzB,QAAAA,YAAY,GAAGyB,WAAf;AACD;;AAED,WAAKN,UAAL,CAAgBnB,YAAhB,EAA8BmC,WAA9B,EAA2CG,YAA3C;AAEA,WAAKhB,aAAL,CAAmB6B,gBAAnB,EAAqCrB,YAArC,EAAmDM,SAAnD;AACD,KA1WM;AA6WP;AACAiB,IAAAA,cAAc,EAAE,SAASA,cAAT,CAAwBC,KAAxB,EAA+BC,QAA/B,EAAyCnC,aAAzC,EAAwDoC,aAAxD,EAAuE;AACrF,UAAIlD,IAAI,GAAGc,aAAa,CAACd,IAAzB;AACA,UAAI1K,KAAK,GAAG0K,IAAI,CAACrH,MAAL,CAAYrD,KAAxB;AACA,UAAI6N,OAAO,GAAG,KAAKpI,KAAnB;AAAA,UACI4D,aAAa,GAAGwE,OAAO,CAAC/J,cAD5B;AAAA,UAEIsC,aAAa,GAAGyH,OAAO,CAAC7J,cAF5B;AAAA,UAGIoF,WAAW,GAAGyE,OAAO,CAAC1J,YAH1B;AAAA,UAII3D,WAAW,GAAGqN,OAAO,CAACzJ,YAJ1B;AAKA,UAAI0J,QAAQ,GAAG,KAAKzK,MAApB;AAAA,UACI1C,QAAQ,GAAGmN,QAAQ,CAACnN,QADxB;AAAA,UAEIJ,UAAU,GAAGuN,QAAQ,CAACvN,UAF1B;AAAA,UAGIwB,iBAAiB,GAAG+L,QAAQ,CAAC/L,iBAHjC;AAAA,UAIInC,QAAQ,GAAGkO,QAAQ,CAAClO,QAJxB;AAAA,UAKIoC,aAAa,GAAG8L,QAAQ,CAAC9L,aAL7B;AAAA,UAMIC,iBAAiB,GAAG6L,QAAQ,CAAC7L,iBANjC;AAAA,UAOIxB,oBAAoB,GAAGqN,QAAQ,CAACrN,oBAPpC;AASA,UAAImJ,KAAK,GAAGc,IAAI,CAACrH,MAAL,CAAYtB,iBAAZ,CAAZ;AAEA,UAAIpB,QAAJ,EAAc,OAnBuE,CAqBrF;;AACA,UAAIyJ,YAAY,GAAG,KAAK,CAAxB;;AACA,UAAI,KAAKpM,cAAL,EAAJ,EAA2B;AACzBoM,QAAAA,YAAY,GAAG;AACbpK,UAAAA,KAAK,EAAEA,KADM;AAEb4J,UAAAA,KAAK,EAAEA;AAFM,SAAf;AAID,OALD,MAKO;AACLQ,QAAAA,YAAY,GAAGpK,KAAf;AACD,OA9BoF,CAgCrF;;;AACA,UAAI0N,KAAJ,EAAW;AACT,aAAKjC,MAAL,CAAY,QAAZ,EAAsBrB,YAAtB,EAAoCM,IAApC,EAA0Cc,aAA1C;AACD,OAFD,MAEO;AACL,aAAKC,MAAL,CAAY,UAAZ,EAAwBrB,YAAxB,EAAsCM,IAAtC,EAA4Cc,aAA5C;AACD,OArCoF,CAuCrF;AACA;;;AACA,UAAIU,YAAY,GAAGyB,QAAQ,CAAC1D,GAAT,CAAa,UAAUS,IAAV,EAAgB;AAC9C,YAAIlL,KAAK,GAAGf,YAAY,CAACiM,IAAD,CAAxB;AACA,eAAO;AACL1K,UAAAA,KAAK,EAAER,KAAK,CAACQ,KADR;AAEL4J,UAAAA,KAAK,EAAEpK,KAAK,CAACuC,iBAAD;AAFP,SAAP;AAID,OANkB,CAAnB,CAzCqF,CAiDrF;AACA;;AACA,UAAIC,aAAa,IAAI,CAACC,iBAAtB,EAAyC;AACvC,YAAIsH,OAAO,GAAG2C,YAAY,CAACjC,GAAb,CAAiB,UAAU8D,MAAV,EAAkB;AAC/C,cAAI7D,GAAG,GAAG6D,MAAM,CAAC/N,KAAjB;AACA,iBAAOoG,aAAa,CAAC8D,GAAD,CAAb,CAAmBvD,GAA1B;AACD,SAHa,CAAd;;AAIA,YAAI+G,KAAJ,EAAW;AACTnE,UAAAA,OAAO,GAAG3L,YAAY,CAAC2L,OAAD,EAAU,IAAV,EAAgBH,WAAhB,CAAZ,CAAyCY,WAAnD;AACD,SAFD,MAEO;AACLT,UAAAA,OAAO,GAAG3L,YAAY,CAAC,CAACwI,aAAa,CAACpG,KAAD,CAAb,CAAqB2G,GAAtB,CAAD,EAA6B,KAA7B,EAAoCyC,WAApC,EAAiD;AACrEY,YAAAA,WAAW,EAAET;AADwD,WAAjD,CAAZ,CAEPS,WAFH;AAGD;;AACDkC,QAAAA,YAAY,GAAG3C,OAAO,CAACU,GAAR,CAAY,UAAUtD,GAAV,EAAe;AACxC,cAAInH,KAAK,GAAGf,YAAY,CAAC2K,WAAW,CAACe,GAAZ,CAAgBxD,GAAhB,EAAqB+D,IAAtB,CAAxB;AACA,iBAAO;AACL1K,YAAAA,KAAK,EAAER,KAAK,CAACQ,KADR;AAEL4J,YAAAA,KAAK,EAAEpK,KAAK,CAACuC,iBAAD;AAFP,WAAP;AAID,SANc,CAAf;AAOD,OAtEoF,CAwErF;;;AACA,UAAItB,oBAAoB,IAAIF,UAAU,KAAK,IAA3C,EAAiD;AAC/C;AACA,YAAI,CAAC,KAAKoL,uBAAL,EAAD,KAAoC/L,QAAQ,IAAIoC,aAAhD,CAAJ,EAAoE;AAClE,eAAK4J,oBAAL,CAA0B;AACxBxH,YAAAA,YAAY,EAAE,EADU;AAExBK,YAAAA,kBAAkB,EAAE;AAFI,WAA1B;AAID,SAP8C,CAS/C;AACA;AACA;;;AACA,YAAIjE,WAAW,IAAIA,WAAW,CAACzB,MAA/B,EAAuC;AACrC,eAAK0M,MAAL,CAAY,oBAAZ,EAAkC,EAAlC;;AACA,eAAKA,MAAL,CAAY,QAAZ,EAAsB,EAAtB;AACD;AACF,OAzFoF,CA2FrF;;;AACA,UAAIe,SAAS,GAAGnQ,QAAQ,CAAC,EAAD,EAAKuR,aAAL,EAAoB;AAC1CnB,QAAAA,YAAY,EAAEzM,KAD4B;AAE1CuM,QAAAA,WAAW,EAAE7B;AAF6B,OAApB,CAAxB;;AAKA,WAAKgB,aAAL,CAAmBrC,aAAnB,EAAkC6C,YAAlC,EAAgDM,SAAhD;AACD,KAhdM;AAidPpH,IAAAA,gBAAgB,EAAE,SAASA,gBAAT,CAA0BqF,CAA1B,EAA6Be,aAA7B,EAA4C;AAC5D,UAAIwC,OAAO,GAAG,KAAKvI,KAAnB;AAAA,UACIsG,SAAS,GAAGiC,OAAO,CAACpK,UADxB;AAAA,UAEIwC,aAAa,GAAG4H,OAAO,CAAChK,cAF5B;AAGA,UAAIiK,QAAQ,GAAG,KAAK5K,MAApB;AAAA,UACIrB,aAAa,GAAGiM,QAAQ,CAACjM,aAD7B;AAAA,UAEIpC,QAAQ,GAAGqO,QAAQ,CAACrO,QAFxB;AAIA,UAAIoC,aAAJ,EAAmB;;AAEnB,UAAI,CAACpC,QAAL,EAAe;AACb,aAAKqL,YAAL,CAAkB,KAAlB;AACD;;AAED,UAAIyC,KAAK,GAAGlC,aAAa,CAAC4B,QAA1B;AACA,UAAIc,aAAa,GAAG1C,aAAa,CAACd,IAAd,CAAmBrH,MAAnB,CAA0BrD,KAA9C;AAGA,UAAIkM,YAAY,GAAG,KAAK,CAAxB;;AAEA,UAAI,CAACtM,QAAL,EAAe;AACbsM,QAAAA,YAAY,GAAG,CAAC;AAAElM,UAAAA,KAAK,EAAEkO;AAAT,SAAD,CAAf;AACD,OAFD,MAEO;AACLhC,QAAAA,YAAY,GAAGH,SAAS,CAACI,MAAV,CAAiB,UAAUgC,MAAV,EAAkB;AAChD,cAAInO,KAAK,GAAGmO,MAAM,CAACnO,KAAnB;AACA,iBAAOA,KAAK,KAAKkO,aAAjB;AACD,SAHc,CAAf;;AAIA,YAAIR,KAAJ,EAAW;AACTxB,UAAAA,YAAY,CAACpC,IAAb,CAAkB;AAAE9J,YAAAA,KAAK,EAAEkO;AAAT,WAAlB;AACD;AACF;;AAED,UAAIb,aAAa,GAAGnB,YAAY,CAACjC,GAAb,CAAiB,UAAUmE,MAAV,EAAkB;AACrD,YAAIpO,KAAK,GAAGoO,MAAM,CAACpO,KAAnB;AACA,eAAOoG,aAAa,CAACpG,KAAD,CAApB;AACD,OAHmB,EAGjBmM,MAHiB,CAGV,UAAUtC,MAAV,EAAkB;AAC1B,eAAOA,MAAP;AACD,OALmB,EAKjBI,GALiB,CAKb,UAAUoE,MAAV,EAAkB;AACvB,YAAI3D,IAAI,GAAG2D,MAAM,CAAC3D,IAAlB;AACA,eAAOA,IAAP;AACD,OARmB,CAApB;AAUA,WAAK+C,cAAL,CAAoBC,KAApB,EAA2BL,aAA3B,EAA0C7B,aAA1C,EAAyD;AAAE4B,QAAAA,QAAQ,EAAEM;AAAZ,OAAzD;AACD,KA5fM;AA6fPrI,IAAAA,eAAe,EAAE,SAASA,eAAT,CAAyBoF,CAAzB,EAA4Be,aAA5B,EAA2C;AAC1D,UAAI8C,OAAO,GAAG,KAAK7I,KAAnB;AAAA,UACIjF,WAAW,GAAG8N,OAAO,CAAClK,YAD1B;AAAA,UAEIgF,WAAW,GAAGkF,OAAO,CAACnK,YAF1B;AAAA,UAGIiC,aAAa,GAAGkI,OAAO,CAACtK,cAH5B;AAAA,UAII+H,SAAS,GAAGuC,OAAO,CAAC1K,UAJxB;AAKA,UAAI3B,iBAAiB,GAAG,KAAKoB,MAAL,CAAYpB,iBAApC;AACA,UAAI6K,YAAY,GAAGtB,aAAa,CAACsB,YAAjC;AAAA,UACIE,qBAAqB,GAAGxB,aAAa,CAACwB,qBAD1C;AAGA,UAAIU,KAAK,GAAGlC,aAAa,CAACqB,OAA1B;AAEA,UAAIL,SAAS,GAAG;AACdK,QAAAA,OAAO,EAAEa;AADK,OAAhB;AAIA,UAAIa,eAAe,GAAGzB,YAAtB,CAhB0D,CAkB1D;AACA;AACA;AACA;;AACA,UAAItM,WAAJ,EAAiB;AACf,YAAIgO,UAAU,GAAGzC,SAAS,CAAC9B,GAAV,CAAc,UAAUwE,MAAV,EAAkB;AAC/C,cAAIzO,KAAK,GAAGyO,MAAM,CAACzO,KAAnB;AACA,iBAAOoG,aAAa,CAACpG,KAAD,CAApB;AACD,SAHgB,EAGdmM,MAHc,CAGP,UAAUtC,MAAV,EAAkB;AAC1B,iBAAOA,MAAP;AACD,SALgB,EAKdI,GALc,CAKV,UAAUyE,MAAV,EAAkB;AACvB,cAAI/H,GAAG,GAAG+H,MAAM,CAAC/H,GAAjB;AACA,iBAAOA,GAAP;AACD,SARgB,CAAjB;AAUA,YAAI4C,OAAO,GAAG,KAAK,CAAnB;;AACA,YAAImE,KAAJ,EAAW;AACTnE,UAAAA,OAAO,GAAGoF,KAAK,CAACC,IAAN,CAAW,IAAIC,GAAJ,CAAQ,GAAGpF,MAAH,CAAUrN,kBAAkB,CAACoS,UAAD,CAA5B,EAA0CpS,kBAAkB,CAACmS,eAAe,CAACtE,GAAhB,CAAoB,UAAUS,IAAV,EAAgB;AAC5H,gBAAIoE,aAAa,GAAGrQ,YAAY,CAACiM,IAAD,CAAhC;AAAA,gBACI1K,KAAK,GAAG8O,aAAa,CAAC9O,KAD1B;;AAGA,mBAAOoG,aAAa,CAACpG,KAAD,CAAb,CAAqB2G,GAA5B;AACD,WALyF,CAAD,CAA5D,CAAR,CAAX,CAAV;AAMD,SAPD,MAOO;AACL4C,UAAAA,OAAO,GAAG3L,YAAY,CAAC,CAACa,YAAY,CAAC+M,aAAa,CAACd,IAAf,CAAZ,CAAiCqE,QAAlC,CAAD,EAA8C,KAA9C,EAAqD3F,WAArD,EAAkE;AACtFY,YAAAA,WAAW,EAAEwE;AADyE,WAAlE,CAAZ,CAEPxE,WAFH;AAGD;;AAEDuE,QAAAA,eAAe,GAAGhF,OAAO,CAACU,GAAR,CAAY,UAAUtD,GAAV,EAAe;AAC3C,iBAAOyC,WAAW,CAACe,GAAZ,CAAgBxD,GAAhB,EAAqB+D,IAA5B;AACD,SAFiB,CAAlB,CAzBe,CA6Bf;;AACA8B,QAAAA,SAAS,CAACU,eAAV,GAA4B3D,OAAO,CAACU,GAAR,CAAY,UAAUtD,GAAV,EAAe;AACrD,iBAAOxI,WAAW,CAACiL,WAAW,CAACe,GAAZ,CAAgBxD,GAAhB,CAAD,CAAlB;AACD,SAF2B,CAA5B;AAGD,OAjCD,MAiCO,IAAI1E,iBAAJ,EAAuB;AAC5BuK,QAAAA,SAAS,CAACU,eAAV,GAA4B1B,aAAa,CAACsB,YAA1C;AACD,OAFM,MAEA;AACLN,QAAAA,SAAS,CAACU,eAAV,GAA4BpP,eAAe,CAACkP,qBAAD,CAA3C;AACD;;AAED,WAAKS,cAAL,CAAoBC,KAApB,EAA2Ba,eAA3B,EAA4C/C,aAA5C,EAA2DgB,SAA3D;AACD,KA3jBM;AA8jBP;AAEAwC,IAAAA,uBAAuB,EAAE,SAASA,uBAAT,CAAiCjP,IAAjC,EAAuC;AAC9D,UAAIkP,QAAQ,GAAG,KAAK5L,MAApB;AAAA,UACIzD,QAAQ,GAAGqP,QAAQ,CAACrP,QADxB;AAAA,UAEIoC,aAAa,GAAGiN,QAAQ,CAACjN,aAF7B;AAGA,UAAIoC,YAAY,GAAG,KAAKqB,KAAL,CAAWrB,YAA9B,CAJ8D,CAM9D;AACA;;AAEA,UAAIrE,IAAI,IAAI,CAACH,QAAT,IAAqB,CAACoC,aAAtB,IAAuCoC,YAA3C,EAAyD;AACvD,aAAKwH,oBAAL,CAA0B;AACxBxH,UAAAA,YAAY,EAAE,EADU;AAExBK,UAAAA,kBAAkB,EAAE;AAFI,SAA1B;AAID;;AACD,WAAKwG,YAAL,CAAkBlL,IAAlB,EAAwB,IAAxB;AACD,KAhlBM;AAilBPwF,IAAAA,mBAAmB,EAAE,SAASA,mBAAT,CAA6BsF,KAA7B,EAAoC;AACvD,UAAI7K,KAAK,GAAG6K,KAAK,CAACqE,MAAN,CAAalP,KAAzB;AACA,UAAImP,OAAO,GAAG,KAAK1J,KAAnB;AAAA,UACI+C,SAAS,GAAG2G,OAAO,CAAC3K,UADxB;AAAA,UAEI4B,aAAa,GAAG+I,OAAO,CAACnL,cAF5B;AAGA,UAAIoL,QAAQ,GAAG,KAAK/L,MAApB;AAAA,UACIb,cAAc,GAAG4M,QAAQ,CAAC5M,cAD9B;AAAA,UAEIV,kBAAkB,GAAGsN,QAAQ,CAACtN,kBAFlC;;AAIA,WAAK2J,MAAL,CAAY,oBAAZ,EAAkCzL,KAAlC;;AACA,WAAKyL,MAAL,CAAY,QAAZ,EAAsBzL,KAAtB;;AAEA,UAAIqP,KAAK,GAAG,KAAZ;;AAEA,UAAI,CAAC,KAAK1D,uBAAL,EAAL,EAAqC;AACnC0D,QAAAA,KAAK,GAAG,KAAKzD,oBAAL,CAA0B;AAChCxH,UAAAA,YAAY,EAAEpE;AADkB,SAA1B,CAAR;AAGA,aAAKiL,YAAL,CAAkB,IAAlB;AACD;;AAED,UAAIoE,KAAJ,EAAW;AACT;AACA,YAAIhF,gBAAgB,GAAGC,MAAM,CAACtK,KAAD,CAAN,CAAcuK,WAAd,EAAvB;AAEA,YAAIC,gBAAgB,GAAGhI,cAAvB;;AACA,YAAIA,cAAc,KAAK,KAAvB,EAA8B;AAC5BgI,UAAAA,gBAAgB,GAAG,SAASA,gBAAT,GAA4B;AAC7C,mBAAO,IAAP;AACD,WAFD;AAGD,SAJD,MAIO,IAAI,CAACA,gBAAL,EAAuB;AAC5BA,UAAAA,gBAAgB,GAAG,SAASA,gBAAT,CAA0BC,CAA1B,EAA6BC,IAA7B,EAAmC;AACpD,gBAAIC,SAAS,GAAGL,MAAM,CAAC7L,YAAY,CAACiM,IAAD,CAAZ,CAAmB5I,kBAAnB,CAAD,CAAN,CAA+CyI,WAA/C,EAAhB;AACA,mBAAOI,SAAS,CAACC,OAAV,CAAkBP,gBAAlB,MAAwC,CAAC,CAAhD;AACD,WAHD;AAID;;AAED,aAAK3E,QAAL,CAAc;AACZjB,UAAAA,kBAAkB,EAAEvG,aAAa,CAAC,KAAK6J,cAAN,EAAsBS,SAAtB,EAAiCxI,KAAjC,EAAwCwK,gBAAxC,EAA0DpE,aAA1D,EAAyE/H,UAAzE;AADrB,SAAd;AAGD;AACF,KA1nBM;AA2nBPmH,IAAAA,oBAAoB,EAAE,SAASA,oBAAT,CAA8BqF,KAA9B,EAAqC;AACzD,UAAIyE,OAAO,GAAG,KAAK7J,KAAnB;AAAA,UACIjF,WAAW,GAAG8O,OAAO,CAAClL,YAD1B;AAAA,UAEI2H,SAAS,GAAGuD,OAAO,CAAC1L,UAFxB;AAGA,UAAIkH,OAAO,GAAGD,KAAK,CAACC,OAApB;;AAGA,UAAInO,OAAO,CAAC4S,SAAR,KAAsBzE,OAAtB,IAAiC,KAAKzE,UAAL,EAAjC,IAAsD,CAAC7F,WAAvD,IAAsEuL,SAAS,CAAChN,MAApF,EAA4F;AAC1F,YAAIyQ,SAAS,GAAGzD,SAAS,CAACA,SAAS,CAAChN,MAAV,GAAmB,CAApB,CAAT,CAAgCiB,KAAhD;AACA,aAAKmF,wBAAL,CAA8B0F,KAA9B,EAAqC2E,SAArC;AACD;AACF,KAtoBM;AAuoBPC,IAAAA,sBAAsB,EAAE,SAASA,sBAAT,GAAkC;AACxD,UAAIC,MAAM,GAAG,IAAb;;AAEAnT,MAAAA,GAAG,CAAC,YAAY;AACdmT,QAAAA,MAAM,CAAC5J,eAAP;AACD,OAFE,CAAH;AAGD,KA7oBM;AA8oBP6J,IAAAA,WAAW,EAAE,SAASA,WAAT,CAAqBrJ,KAArB,EAA4B;AACvC,WAAKA,KAAL,GAAaA,KAAb;AACD,KAhpBM;;AAmpBP;AACJ;AACA;AACIsF,IAAAA,oBAAoB,EAAE,SAASA,oBAAT,CAA8BlI,KAA9B,EAAqC;AACzD,UAAIkM,QAAQ,GAAG,KAAf;AACA,UAAIlL,QAAQ,GAAG,EAAf;AACA,UAAIlF,KAAK,GAAGjB,cAAc,CAAC,IAAD,CAA1B;AACAsR,MAAAA,MAAM,CAAChR,IAAP,CAAY6E,KAAZ,EAAmBxE,OAAnB,CAA2B,UAAUI,IAAV,EAAgB;AACzC,YAAIA,IAAI,CAACwQ,KAAL,CAAW,CAAX,KAAiBtQ,KAArB,EAA4B;AAE5BoQ,QAAAA,QAAQ,GAAG,IAAX;AACAlL,QAAAA,QAAQ,CAACpF,IAAD,CAAR,GAAiBoE,KAAK,CAACpE,IAAD,CAAtB;AACD,OALD;;AAOA,UAAIsQ,QAAJ,EAAc;AACZ,aAAKlK,QAAL,CAAchB,QAAd;AACD;;AAED,aAAOkL,QAAP;AACD,KAtqBM;AAyqBP;AACA;AACA;AACA3E,IAAAA,YAAY,EAAE,SAASA,YAAT,CAAsBlL,IAAtB,EAA4B;AACxC,UAAIgQ,SAAS,GAAGjR,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBE,SAAzC,GAAqDF,SAAS,CAAC,CAAD,CAA9D,GAAoE,KAApF;AACA,UAAI2C,qBAAqB,GAAG,KAAK4B,MAAL,CAAY5B,qBAAxC;;AAGA,UAAIA,qBAAqB,IAAIA,qBAAqB,CAAC1B,IAAD,EAAO;AAAEiQ,QAAAA,kBAAkB,EAAE,CAACjQ,IAAD,IAASgQ;AAA/B,OAAP,CAArB,KAA4E,KAAzG,EAAgH;AAC9G;AACD;;AAED,WAAKnE,oBAAL,CAA0B;AAAEjI,QAAAA,KAAK,EAAE5D;AAAT,OAA1B;AACD,KAtrBM;AAyrBP;AACAsG,IAAAA,UAAU,EAAE,SAASA,UAAT,GAAsB;AAChC,UAAI4J,QAAQ,GAAG,KAAK5M,MAApB;AAAA,UACIzD,QAAQ,GAAGqQ,QAAQ,CAACrQ,QADxB;AAAA,UAEIoC,aAAa,GAAGiO,QAAQ,CAACjO,aAF7B;AAIA,aAAO,CAAC,EAAEpC,QAAQ,IAAIoC,aAAd,CAAR;AACD,KAhsBM;AAisBPhE,IAAAA,cAAc,EAAE,SAASA,cAAT,GAA0B;AACxC,aAAOC,eAAe,CAAC,KAAKoF,MAAN,CAAtB;AACD,KAnsBM;AAssBP;AACA;AACA;AACA;AACAsI,IAAAA,uBAAuB,EAAE,SAASA,uBAAT,GAAmC;AAC1D,UAAInM,KAAK,GAAGjB,cAAc,CAAC,IAAD,CAA1B;AACA,UAAIgC,UAAU,GAAGf,KAAK,CAACe,UAAvB;AAEA,UAAI,iBAAiBf,KAArB,EAA4B,OAAO,IAAP;AAC5B,aAAO,gBAAgBA,KAAhB,IAAyBe,UAAU,KAAK,IAA/C;AACD,KAhtBM;AAitBPuF,IAAAA,eAAe,EAAE,SAASA,eAAT,GAA2B;AAC1C,UAAIoK,QAAQ,GAAG,KAAK1M,gBAAL,CAAsB2D,OAArC;;AACA,UAAI+I,QAAJ,EAAc;AACZA,QAAAA,QAAQ,CAACpK,eAAT;AACD;AACF,KAttBM;AAutBPqK,IAAAA,oBAAoB,EAAE,SAASA,oBAAT,GAAgC;AACpD,UAAIC,MAAM,GAAG,IAAb,CADoD,CAGpD;AACA;;;AACA7T,MAAAA,GAAG,CAAC,YAAY;AACdA,QAAAA,GAAG,CAAC6T,MAAM,CAACtK,eAAR,CAAH;AACD,OAFE,CAAH;AAGD,KA/tBM;;AAkuBP;AACJ;AACA;AACA;AACI4F,IAAAA,aAAa,EAAE,SAASA,aAAT,CAAuBrC,aAAvB,EAAsC0C,SAAtC,EAAiD;AAC9D,UAAIS,SAAS,GAAG1N,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBE,SAAzC,GAAqDF,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAApF;AACA,UAAIuR,OAAO,GAAG,KAAK5K,KAAnB;AAAA,UACIW,aAAa,GAAGiK,OAAO,CAACrM,cAD5B;AAAA,UAEIxD,WAAW,GAAG6P,OAAO,CAACjM,YAF1B;AAAA,UAGIkM,qBAAqB,GAAGD,OAAO,CAACtM,kBAHpC;AAKA,UAAIvE,KAAK,GAAGjB,cAAc,CAAC,IAAD,CAA1B;AACA,UAAIoC,QAAQ,GAAGnB,KAAK,CAACmB,QAArB;AAAA,UACIqB,aAAa,GAAGxC,KAAK,CAACwC,aAD1B;AAAA,UAEIC,iBAAiB,GAAGzC,KAAK,CAACyC,iBAF9B;AAIA,UAAItB,QAAJ,EAAc,OAZgD,CAc9D;;AACA,UAAI4P,KAAK,GAAGlU,QAAQ,CAAC;AACnB;AACAmU,QAAAA,QAAQ,EAAEF,qBAAqB,CAACrG,GAAtB,CAA0B,UAAUwG,MAAV,EAAkB;AACpD,cAAI7G,KAAK,GAAG6G,MAAM,CAAC7G,KAAnB;AAAA,cACI5J,KAAK,GAAGyQ,MAAM,CAACzQ,KADnB;AAEA,iBAAO;AAAE4J,YAAAA,KAAK,EAAEA,KAAT;AAAgB5J,YAAAA,KAAK,EAAEA;AAAvB,WAAP;AACD,SAJS;AAFS,OAAD,EAOjBwM,SAPiB,CAApB,CAf8D,CAwB9D;;;AACA,UAAIrG,iBAAiB,GAAG3I,mBAAmB,CAACuO,SAAD,EAAYvM,KAAZ,EAAmB4G,aAAnB,CAA3C;;AAEA,UAAI,EAAE,WAAW5G,KAAb,CAAJ,EAAyB;AACvB,YAAIkF,QAAQ,GAAG;AACbZ,UAAAA,cAAc,EAAEuF,aADH;AAEbzF,UAAAA,UAAU,EAAEmI,SAFC;AAGbhI,UAAAA,kBAAkB,EAAEoC;AAHP,SAAf;;AAMA,YAAI3F,WAAW,IAAIwB,aAAf,IAAgC,CAACC,iBAArC,EAAwD;AACtDyC,UAAAA,QAAQ,CAACb,sBAAT,GAAkChG,kBAAkB,CAACkO,SAAD,EAAY3F,aAAZ,CAApD;AACD;;AAED,aAAKV,QAAL,CAAchB,QAAd;AACD,OAvC6D,CAyC9D;;;AACA,UAAI/F,YAAY,CAAC,IAAD,CAAZ,CAAmB+R,MAAvB,EAA+B;AAC7B,YAAIC,gBAAgB,GAAG,KAAK,CAA5B,CAD6B,CAG7B;;AACA,YAAI,KAAKtK,UAAL,EAAJ,EAAuB;AACrBsK,UAAAA,gBAAgB,GAAG,GAAGlH,MAAH,CAAUrN,kBAAkB,CAACiN,aAAD,CAA5B,EAA6CjN,kBAAkB,CAAC+J,iBAAD,CAA/D,CAAnB;AACD,SAFD,MAEO;AACLwK,UAAAA,gBAAgB,GAAGxK,iBAAiB,CAAC2J,KAAlB,CAAwB,CAAxB,EAA2B,CAA3B,CAAnB;AACD;;AAED,YAAIc,SAAS,GAAG,IAAhB;AACA,YAAIC,WAAW,GAAG,KAAK,CAAvB;;AAEA,YAAI,KAAK7S,cAAL,EAAJ,EAA2B;AACzB6S,UAAAA,WAAW,GAAGF,gBAAgB,CAAC1G,GAAjB,CAAqB,UAAU6G,MAAV,EAAkB;AACnD,gBAAIlH,KAAK,GAAGkH,MAAM,CAAClH,KAAnB;AAAA,gBACI5J,KAAK,GAAG8Q,MAAM,CAAC9Q,KADnB;AAEA,mBAAO;AAAE4J,cAAAA,KAAK,EAAEA,KAAT;AAAgB5J,cAAAA,KAAK,EAAEA;AAAvB,aAAP;AACD,WAJa,CAAd;AAKD,SAND,MAMO;AACL4Q,UAAAA,SAAS,GAAG,EAAZ;AACAC,UAAAA,WAAW,GAAGF,gBAAgB,CAAC1G,GAAjB,CAAqB,UAAU8G,MAAV,EAAkB;AACnD,gBAAInH,KAAK,GAAGmH,MAAM,CAACnH,KAAnB;AAAA,gBACI5J,KAAK,GAAG+Q,MAAM,CAAC/Q,KADnB;AAGA4Q,YAAAA,SAAS,CAAC9G,IAAV,CAAeF,KAAf;AACA,mBAAO5J,KAAP;AACD,WANa,CAAd;AAOD;;AAED,YAAI,CAAC,KAAKqG,UAAL,EAAL,EAAwB;AACtBwK,UAAAA,WAAW,GAAGA,WAAW,CAAC,CAAD,CAAzB;AACD;;AACD,aAAKpF,MAAL,CAAY,QAAZ,EAAsBoF,WAAtB,EAAmCD,SAAnC,EAA8CL,KAA9C;AACD;AACF,KAnzBM;AAozBP7I,IAAAA,KAAK,EAAE,SAASA,KAAT,GAAiB;AACtB,WAAKnE,WAAL,CAAiB4D,OAAjB,CAAyBO,KAAzB;AACD,KAtzBM;AAuzBPsJ,IAAAA,IAAI,EAAE,SAASA,IAAT,GAAgB;AACpB,WAAKzN,WAAL,CAAiB4D,OAAjB,CAAyB6J,IAAzB;AACD;AAzzBM,GAlNE;AA8gCX;AAEAC,EAAAA,MAAM,EAAE,SAASA,MAAT,GAAkB;AACxB,QAAInJ,CAAC,GAAGhJ,SAAS,CAAC,CAAD,CAAjB;AACA,QAAIoS,OAAO,GAAG,KAAKzL,KAAnB;AAAA,QACIsG,SAAS,GAAGmF,OAAO,CAACtN,UADxB;AAAA,QAEIyF,aAAa,GAAG6H,OAAO,CAACpN,cAF5B;AAAA,QAGIqC,iBAAiB,GAAG+K,OAAO,CAACnN,kBAHhC;AAAA,QAIIoN,qBAAqB,GAAGD,OAAO,CAACrN,sBAJpC;AAAA,QAKIuC,aAAa,GAAG8K,OAAO,CAAClN,cAL5B;AAAA,QAMIoF,WAAW,GAAG8H,OAAO,CAAC/M,YAN1B;AAAA,QAOI3D,WAAW,GAAG0Q,OAAO,CAAC9M,YAP1B;AAAA,QAQIrE,IAAI,GAAGmR,OAAO,CAACvN,KARnB;AAAA,QASIyN,OAAO,GAAGF,OAAO,CAAC3M,QATtB;AAAA,QAUIiE,SAAS,GAAG0I,OAAO,CAAC1M,UAVxB;AAAA,QAWI6M,iBAAiB,GAAGH,OAAO,CAACzM,kBAXhC;AAaA,QAAIjF,KAAK,GAAGjB,cAAc,CAAC,IAAD,CAA1B;AACA,QAAIkB,SAAS,GAAGD,KAAK,CAACC,SAAtB;AAAA,QACI6C,gBAAgB,GAAG9C,KAAK,CAAC8C,gBAD7B;AAGA,QAAI+D,UAAU,GAAG,KAAKA,UAAL,EAAjB;AAEA,QAAIiL,SAAS,GAAG;AACd9R,MAAAA,KAAK,EAAEnD,QAAQ,CAAC,EAAD,EAAKmD,KAAL,EAAY;AACzB6G,QAAAA,UAAU,EAAEA,UADa;AAEzB0F,QAAAA,SAAS,EAAEA,SAFc;AAGzBoF,QAAAA,qBAAqB,EAAEA,qBAHE;AAIzBhL,QAAAA,iBAAiB,EAAE,GAAGsD,MAAH,CAAUrN,kBAAkB,CAACiN,aAAD,CAA5B,EAA6CjN,kBAAkB,CAAC+J,iBAAD,CAA/D,CAJM;AAKzBC,QAAAA,aAAa,EAAEA,aALU;AAMzBgD,QAAAA,WAAW,EAAEA,WANY;AAOzB5I,QAAAA,WAAW,EAAEA,WAPY;AAQzB6J,QAAAA,gBAAgB,EAAE,CAAC7J,WAAW,IAAI,EAAhB,EAAoB+J,WAApB,EARO;AAQ4B;AACrDxK,QAAAA,IAAI,EAAEA,IATmB;AAUzBqR,QAAAA,OAAO,EAAEA,OAVgB;AAWzBG,QAAAA,iBAAiB,EAAE9R,SAAS,GAAG,WAXN;AAYzBgE,QAAAA,MAAM,EAAE,KAAKA;AAZY,OAAZ,CADD;AAed+N,MAAAA,EAAE,EAAEnV,QAAQ,CAAC,EAAD,EAAKsC,YAAY,CAAC,IAAD,CAAjB,EAAyB;AACnC8S,QAAAA,oBAAoB,EAAE,KAAKhC;AADQ,OAAzB,CAfE;AAkBdiC,MAAAA,WAAW,EAAE,KAAKC;AAlBJ,KAAhB;AAoBA,QAAIC,UAAU,GAAGpT,UAAU,CAAC8S,SAAD,EAAY;AACrC9R,MAAAA,KAAK,EAAE;AACLgJ,QAAAA,SAAS,EAAEA,SADN;AAEL6I,QAAAA,iBAAiB,EAAEA,iBAFd;AAGL;AACA/O,QAAAA,gBAAgB,EAAEA,gBAJb;AAKLa,QAAAA,eAAe,EAAE0O,MAAM;AALlB,OAD8B;AAQrCL,MAAAA,EAAE,EAAE;AACFM,QAAAA,YAAY,EAAE,KAAK3B;AADjB,OARiC;AAWrC4B,MAAAA,UAAU,EAAE,CAAC;AACXzS,QAAAA,IAAI,EAAE,SADK;AAEXU,QAAAA,KAAK,EAAE,KAAK2P;AAFD,OAAD;AAXyB,KAAZ,CAA3B;AAiBA,QAAIqC,KAAK,GAAG3L,UAAU,GAAGrJ,aAAH,GAAmBD,WAAzC;AACA,QAAIkV,MAAM,GAAGnK,CAAC,CAACkK,KAAD,EAAQJ,UAAR,CAAd;AAEA,QAAIM,QAAQ,GAAG7L,UAAU,GAAGvJ,gBAAH,GAAsBD,cAA/C;AACA,QAAIsV,SAAS,GAAGrK,CAAC,CAACoK,QAAD,EAAW/V,cAAc,CAAC,CAACmV,SAAD,EAAY;AACrDS,MAAAA,UAAU,EAAE,CAAC;AACXzS,QAAAA,IAAI,EAAE,SADK;AAEXU,QAAAA,KAAK,EAAE,KAAKuD;AAFD,OAAD;AADyC,KAAZ,CAAD,CAAzB,CAAjB;AAMA,QAAI6O,kBAAkB,GAAG5T,UAAU,CAAC8S,SAAD,EAAY;AAC7C9R,MAAAA,KAAK,EAAE;AACL6S,QAAAA,YAAY,EAAEJ,MADT;AAELxQ,QAAAA,qBAAqB,EAAE,KAAKuN;AAFvB,OADsC;AAK7C+C,MAAAA,UAAU,EAAE,CAAC;AACXzS,QAAAA,IAAI,EAAE,SADK;AAEXU,QAAAA,KAAK,EAAE,KAAKwD;AAFD,OAAD;AALiC,KAAZ,CAAnC;AAUA,WAAOsE,CAAC,CACNlL,aADM,EAENwV,kBAFM,EAGN,CAACD,SAAD,CAHM,CAAR;AAKD;AAnmCU,CAAb;AAsmCA9S,MAAM,CAACiT,QAAP,GAAkBjU,UAAlB;AACAgB,MAAM,CAACpC,QAAP,GAAkBA,QAAlB;AACAoC,MAAM,CAACnC,WAAP,GAAqBA,WAArB;AACAmC,MAAM,CAAClC,UAAP,GAAoBA,UAApB,C,CAEA;;AACAkC,MAAM,CAACC,IAAP,GAAc,YAAd;AAEA,eAAeD,MAAf","sourcesContent":["import _mergeJSXProps from 'babel-helper-vue-jsx-merge-props';\nimport _toConsumableArray from 'babel-runtime/helpers/toConsumableArray';\nimport _extends from 'babel-runtime/helpers/extends';\n/**\n * ARIA: https://www.w3.org/TR/wai-aria/#combobox\n * Sample 1: https://www.w3.org/TR/2017/NOTE-wai-aria-practices-1.1-20171214/examples/combobox/aria1.1pattern/listbox-combo.html\n * Sample 2: https://www.w3.org/blog/wai-components-gallery/widget/combobox-with-aria-autocompleteinline/\n *\n * Tab logic:\n * Popup is close\n * 1. Focus input (mark component as focused)\n * 2. Press enter to show the popup\n * 3. If popup has input, focus it\n *\n * Popup is open\n * 1. press tab to close the popup\n * 2. Focus back to the selection input box\n * 3. Let the native tab going on\n *\n * TreeSelect use 2 design type.\n * In single mode, we should focus on the `span`\n * In multiple mode, we should focus on the `input`\n */\n\nimport shallowEqual from 'shallowequal';\nimport raf from 'raf';\nimport scrollIntoView from 'dom-scroll-into-view';\nimport warning from 'warning';\nimport PropTypes from '../../_util/vue-types';\nimport KeyCode from '../../_util/KeyCode';\n\nimport SelectTrigger from './SelectTrigger';\nimport SingleSelector from './Selector/SingleSelector';\nimport MultipleSelector from './Selector/MultipleSelector';\nimport SinglePopup from './Popup/SinglePopup';\nimport MultiplePopup from './Popup/MultiplePopup';\n\nimport { SHOW_ALL, SHOW_PARENT, SHOW_CHILD } from './strategies';\nimport BaseMixin from '../../_util/BaseMixin';\nimport { createRef, generateAriaId, formatInternalValue, formatSelectorValue, parseSimpleTreeData, convertDataToTree, convertTreeToEntities, conductCheck, getHalfCheckedKeys, flatToHierarchy, isPosRelated, isLabelInValue as _isLabelInValue, getFilterTree, cleanEntity, findPopupContainer } from './util';\nimport SelectNode from './SelectNode';\nimport { initDefaultProps, getOptionProps, mergeProps, getPropsData, filterEmpty, getListeners } from '../../_util/props-util';\nfunction getWatch() {\n  var keys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n  var watch = {};\n  keys.forEach(function (k) {\n    watch[k] = function () {\n      this.needSyncKeys[k] = true;\n    };\n  });\n  return watch;\n}\nvar Select = {\n  name: 'Select',\n  mixins: [BaseMixin],\n  props: initDefaultProps({\n    prefixCls: PropTypes.string,\n    prefixAria: PropTypes.string,\n    multiple: PropTypes.bool,\n    showArrow: PropTypes.bool,\n    open: PropTypes.bool,\n    value: PropTypes.any,\n\n    autoFocus: PropTypes.bool,\n\n    defaultOpen: PropTypes.bool,\n    defaultValue: PropTypes.any,\n\n    showSearch: PropTypes.bool,\n    placeholder: PropTypes.any,\n    inputValue: PropTypes.string, // [Legacy] Deprecated. Use `searchValue` instead.\n    searchValue: PropTypes.string,\n    autoClearSearchValue: PropTypes.bool,\n    searchPlaceholder: PropTypes.any, // [Legacy] Confuse with placeholder\n    disabled: PropTypes.bool,\n    children: PropTypes.any,\n    labelInValue: PropTypes.bool,\n    maxTagCount: PropTypes.number,\n    maxTagPlaceholder: PropTypes.oneOfType([PropTypes.any, PropTypes.func]),\n    maxTagTextLength: PropTypes.number,\n    showCheckedStrategy: PropTypes.oneOf([SHOW_ALL, SHOW_PARENT, SHOW_CHILD]),\n    dropdownClassName: PropTypes.string,\n    dropdownStyle: PropTypes.object,\n    dropdownVisibleChange: PropTypes.func,\n    dropdownMatchSelectWidth: PropTypes.bool,\n    treeData: PropTypes.array,\n    treeDataSimpleMode: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]),\n    treeNodeFilterProp: PropTypes.string,\n    treeNodeLabelProp: PropTypes.string,\n    treeCheckable: PropTypes.oneOfType([PropTypes.any, PropTypes.object, PropTypes.bool]),\n    // treeCheckable: PropTypes.any,\n    treeCheckStrictly: PropTypes.bool,\n    treeIcon: PropTypes.bool,\n    treeLine: PropTypes.bool,\n    treeDefaultExpandAll: PropTypes.bool,\n    treeDefaultExpandedKeys: PropTypes.array,\n    treeExpandedKeys: PropTypes.array,\n    loadData: PropTypes.func,\n    filterTreeNode: PropTypes.oneOfType([PropTypes.func, PropTypes.bool]),\n\n    notFoundContent: PropTypes.any,\n    getPopupContainer: PropTypes.func,\n\n    // onSearch: PropTypes.func,\n    // onSelect: PropTypes.func,\n    // onDeselect: PropTypes.func,\n    // onChange: PropTypes.func,\n    // onDropdownVisibleChange: PropTypes.func,\n\n    // onTreeExpand: PropTypes.func,\n    allowClear: PropTypes.bool,\n    transitionName: PropTypes.string,\n    animation: PropTypes.string,\n    choiceTransitionName: PropTypes.string,\n    inputIcon: PropTypes.any,\n    clearIcon: PropTypes.any,\n    removeIcon: PropTypes.any,\n    switcherIcon: PropTypes.any,\n    __propsSymbol__: PropTypes.any\n  }, {\n    prefixCls: 'rc-tree-select',\n    prefixAria: 'rc-tree-select',\n    showSearch: true,\n    autoClearSearchValue: true,\n    showCheckedStrategy: SHOW_CHILD,\n\n    // dropdownMatchSelectWidth change the origin design, set to false now\n    // ref: https://github.com/react-component/select/blob/4cad95e098a341a09de239ad6981067188842020/src/Select.jsx#L344\n    // ref: https://github.com/react-component/select/pull/71\n    treeNodeFilterProp: 'value',\n    treeNodeLabelProp: 'title',\n    treeIcon: false,\n    notFoundContent: 'Not Found',\n    dropdownStyle: {},\n    dropdownVisibleChange: function dropdownVisibleChange() {\n      return true;\n    }\n  }),\n\n  data: function data() {\n    warning(this.$props.__propsSymbol__, 'must pass __propsSymbol__');\n    var _$props = this.$props,\n        prefixAria = _$props.prefixAria,\n        defaultOpen = _$props.defaultOpen,\n        open = _$props.open;\n\n    this.needSyncKeys = {};\n    this.selectorRef = createRef();\n    this.selectTriggerRef = createRef();\n\n    // ARIA need `aria-controls` props mapping\n    // Since this need user input. Let's generate ourselves\n    this.ariaId = generateAriaId(prefixAria + '-list');\n\n    var state = {\n      _open: open || defaultOpen,\n      _valueList: [],\n      _searchHalfCheckedKeys: [],\n      _missValueList: [], // Contains the value not in the tree\n      _selectorValueList: [], // Used for multiple selector\n      _valueEntities: {},\n      _posEntities: new Map(),\n      _keyEntities: new Map(),\n      _searchValue: '',\n      _prevProps: {},\n      _init: true,\n      _focused: undefined,\n      _treeNodes: undefined,\n      _filteredTreeNodes: undefined\n    };\n    var newState = this.getDerivedState(this.$props, state);\n    return _extends({}, state, newState);\n  },\n  provide: function provide() {\n    return {\n      vcTreeSelect: {\n        onSelectorFocus: this.onSelectorFocus,\n        onSelectorBlur: this.onSelectorBlur,\n        onSelectorKeyDown: this.onComponentKeyDown,\n        onSelectorClear: this.onSelectorClear,\n        onMultipleSelectorRemove: this.onMultipleSelectorRemove,\n\n        onTreeNodeSelect: this.onTreeNodeSelect,\n        onTreeNodeCheck: this.onTreeNodeCheck,\n        onPopupKeyDown: this.onComponentKeyDown,\n\n        onSearchInputChange: this.onSearchInputChange,\n        onSearchInputKeyDown: this.onSearchInputKeyDown\n      }\n    };\n  },\n\n  watch: _extends({}, getWatch(['treeData', 'defaultValue', 'value']), {\n    __propsSymbol__: function __propsSymbol__() {\n      var state = this.getDerivedState(this.$props, this.$data);\n      this.setState(state);\n      this.needSyncKeys = {};\n    },\n    '$data._valueList': function $data_valueList() {\n      var _this = this;\n\n      this.$nextTick(function () {\n        _this.forcePopupAlign();\n      });\n    },\n    '$data._open': function $data_open(open) {\n      var _this2 = this;\n\n      setTimeout(function () {\n        var prefixCls = _this2.$props.prefixCls;\n        var _$data = _this2.$data,\n            selectorValueList = _$data._selectorValueList,\n            valueEntities = _$data._valueEntities;\n\n        var isMultiple = _this2.isMultiple();\n\n        // Scroll to value position, only need sync on single mode\n        if (!isMultiple && selectorValueList.length && open && _this2.popup) {\n          var value = selectorValueList[0].value;\n\n          var _popup$getTree = _this2.popup.getTree(),\n              domTreeNodes = _popup$getTree.domTreeNodes;\n\n          var _ref = valueEntities[value] || {},\n              key = _ref.key;\n\n          var treeNode = domTreeNodes[key];\n\n          if (treeNode) {\n            var domNode = treeNode.$el;\n            raf(function () {\n              var popupNode = _this2.popup.$el;\n              var triggerContainer = findPopupContainer(popupNode, prefixCls + '-dropdown');\n              var searchNode = _this2.popup.searchRef.current;\n\n              if (domNode && triggerContainer && searchNode) {\n                scrollIntoView(domNode, triggerContainer, {\n                  onlyScrollIfNeeded: true,\n                  offsetTop: searchNode.offsetHeight\n                });\n              }\n            });\n          }\n        }\n      });\n    }\n  }),\n  mounted: function mounted() {\n    var _this3 = this;\n\n    this.$nextTick(function () {\n      var _$props2 = _this3.$props,\n          autoFocus = _$props2.autoFocus,\n          disabled = _$props2.disabled;\n\n      if (autoFocus && !disabled) {\n        _this3.focus();\n      }\n    });\n  },\n\n\n  methods: {\n    getDerivedState: function getDerivedState(nextProps, prevState) {\n      var h = this.$createElement;\n      var _prevState$_prevProps = prevState._prevProps,\n          prevProps = _prevState$_prevProps === undefined ? {} : _prevState$_prevProps;\n      var treeCheckable = nextProps.treeCheckable,\n          treeCheckStrictly = nextProps.treeCheckStrictly,\n          filterTreeNode = nextProps.filterTreeNode,\n          treeNodeFilterProp = nextProps.treeNodeFilterProp,\n          treeDataSimpleMode = nextProps.treeDataSimpleMode;\n\n      var newState = {\n        _prevProps: _extends({}, nextProps),\n        _init: false\n      };\n      var self = this;\n      // Process the state when props updated\n      function processState(propName, updater) {\n        if (prevProps[propName] !== nextProps[propName] || self.needSyncKeys[propName]) {\n          updater(nextProps[propName], prevProps[propName]);\n          return true;\n        }\n        return false;\n      }\n\n      var valueRefresh = false;\n\n      // Open\n      processState('open', function (propValue) {\n        newState._open = propValue;\n      });\n\n      // Tree Nodes\n      var treeNodes = void 0;\n      var treeDataChanged = false;\n      var treeDataModeChanged = false;\n      processState('treeData', function (propValue) {\n        treeNodes = convertDataToTree(h, propValue);\n        treeDataChanged = true;\n      });\n\n      processState('treeDataSimpleMode', function (propValue, prevValue) {\n        if (!propValue) return;\n\n        var prev = !prevValue || prevValue === true ? {} : prevValue;\n\n        // Shallow equal to avoid dynamic prop object\n        if (!shallowEqual(propValue, prev)) {\n          treeDataModeChanged = true;\n        }\n      });\n\n      // Parse by `treeDataSimpleMode`\n      if (treeDataSimpleMode && (treeDataChanged || treeDataModeChanged)) {\n        var simpleMapper = _extends({\n          id: 'id',\n          pId: 'pId',\n          rootPId: null\n        }, treeDataSimpleMode !== true ? treeDataSimpleMode : {});\n        treeNodes = convertDataToTree(h, parseSimpleTreeData(nextProps.treeData, simpleMapper));\n      }\n\n      // If `treeData` not provide, use children TreeNodes\n      if (!nextProps.treeData) {\n        // processState('children', (propValue) => {\n        //   treeNodes = Array.isArray(propValue) ? propValue : [propValue]\n        // })\n        treeNodes = filterEmpty(this.$slots['default']);\n      }\n\n      // Convert `treeData` to entities\n      if (treeNodes) {\n        var entitiesMap = convertTreeToEntities(treeNodes);\n        newState._treeNodes = treeNodes;\n        newState._posEntities = entitiesMap.posEntities;\n        newState._valueEntities = entitiesMap.valueEntities;\n        newState._keyEntities = entitiesMap.keyEntities;\n\n        valueRefresh = true;\n      }\n\n      // Value List\n      if (prevState._init) {\n        processState('defaultValue', function (propValue) {\n          newState._valueList = formatInternalValue(propValue, nextProps);\n          valueRefresh = true;\n        });\n      }\n\n      processState('value', function (propValue) {\n        newState._valueList = formatInternalValue(propValue, nextProps);\n        valueRefresh = true;\n      });\n\n      // Selector Value List\n      if (valueRefresh) {\n        // Find out that value not exist in the tree\n        var missValueList = [];\n        var filteredValueList = [];\n        var keyList = [];\n\n        // Get latest value list\n        var latestValueList = newState._valueList;\n        if (!latestValueList) {\n          // Also need add prev missValueList to avoid new treeNodes contains the value\n          latestValueList = [].concat(_toConsumableArray(prevState._valueList), _toConsumableArray(prevState._missValueList));\n        }\n\n        // Get key by value\n        var valueLabels = {};\n        latestValueList.forEach(function (wrapperValue) {\n          var value = wrapperValue.value,\n              label = wrapperValue.label;\n\n          var entity = (newState._valueEntities || prevState._valueEntities)[value];\n          valueLabels[value] = label;\n\n          if (entity) {\n            keyList.push(entity.key);\n            filteredValueList.push(wrapperValue);\n            return;\n          }\n\n          // If not match, it may caused by ajax load. We need keep this\n          missValueList.push(wrapperValue);\n        });\n\n        // We need calculate the value when tree is checked tree\n        if (treeCheckable && !treeCheckStrictly) {\n          // Calculate the keys need to be checked\n          var _conductCheck = conductCheck(keyList, true, newState._keyEntities || prevState._keyEntities),\n              checkedKeys = _conductCheck.checkedKeys;\n\n          // Format value list again for internal usage\n\n\n          newState._valueList = checkedKeys.map(function (key) {\n            var val = (newState._keyEntities || prevState._keyEntities).get(key).value;\n\n            var wrappedValue = {\n              value: val\n            };\n\n            if (valueLabels[val] !== undefined) {\n              wrappedValue.label = valueLabels[val];\n            }\n\n            return wrappedValue;\n          });\n        } else {\n          newState._valueList = filteredValueList;\n        }\n\n        // Fill the missValueList, we still need display in the selector\n        newState._missValueList = missValueList;\n\n        // Calculate the value list for `Selector` usage\n        newState._selectorValueList = formatSelectorValue(newState._valueList, nextProps, newState._valueEntities || prevState._valueEntities);\n      }\n\n      // [Legacy] To align with `Select` component,\n      // We use `searchValue` instead of `inputValue` but still keep the api\n      // `inputValue` support `null` to work as `autoClearSearchValue`\n      processState('inputValue', function (propValue) {\n        if (propValue !== null) {\n          newState._searchValue = propValue;\n        }\n      });\n\n      // Search value\n      processState('searchValue', function (propValue) {\n        newState._searchValue = propValue;\n      });\n\n      // Do the search logic\n      if (newState._searchValue !== undefined || prevState._searchValue && treeNodes) {\n        var searchValue = newState._searchValue !== undefined ? newState._searchValue : prevState._searchValue;\n        var upperSearchValue = String(searchValue).toUpperCase();\n\n        var filterTreeNodeFn = filterTreeNode;\n        if (filterTreeNode === false) {\n          // Don't filter if is false\n          filterTreeNodeFn = function filterTreeNodeFn() {\n            return true;\n          };\n        } else if (typeof filterTreeNodeFn !== 'function') {\n          // When is not function (true or undefined), use inner filter\n          filterTreeNodeFn = function filterTreeNodeFn(_, node) {\n            var nodeValue = String(getPropsData(node)[treeNodeFilterProp]).toUpperCase();\n            return nodeValue.indexOf(upperSearchValue) !== -1;\n          };\n        }\n\n        newState._filteredTreeNodes = getFilterTree(this.$createElement, newState._treeNodes || prevState._treeNodes, searchValue, filterTreeNodeFn, newState._valueEntities || prevState._valueEntities, SelectNode);\n      }\n\n      // We should re-calculate the halfCheckedKeys when in search mode\n      if (valueRefresh && treeCheckable && !treeCheckStrictly && (newState._searchValue || prevState._searchValue)) {\n        newState._searchHalfCheckedKeys = getHalfCheckedKeys(newState._valueList, newState._valueEntities || prevState._valueEntities);\n      }\n\n      // Checked Strategy\n      processState('showCheckedStrategy', function () {\n        newState._selectorValueList = newState._selectorValueList || formatSelectorValue(newState._valueList || prevState._valueList, nextProps, newState._valueEntities || prevState._valueEntities);\n      });\n\n      return newState;\n    },\n\n    // ==================== Selector ====================\n    onSelectorFocus: function onSelectorFocus() {\n      this.setState({ _focused: true });\n    },\n    onSelectorBlur: function onSelectorBlur() {\n      this.setState({ _focused: false });\n\n      // TODO: Close when Popup is also not focused\n      // this.setState({ open: false });\n    },\n\n\n    // Handle key board event in both Selector and Popup\n    onComponentKeyDown: function onComponentKeyDown(event) {\n      var open = this.$data._open;\n      var keyCode = event.keyCode;\n\n\n      if (!open) {\n        if ([KeyCode.ENTER, KeyCode.DOWN].indexOf(keyCode) !== -1) {\n          this.setOpenState(true);\n        }\n      } else if (KeyCode.ESC === keyCode) {\n        this.setOpenState(false);\n      } else if ([KeyCode.UP, KeyCode.DOWN, KeyCode.LEFT, KeyCode.RIGHT].indexOf(keyCode) !== -1) {\n        // TODO: Handle `open` state\n        event.stopPropagation();\n      }\n    },\n    onDeselect: function onDeselect(wrappedValue, node, nodeEventInfo) {\n      this.__emit('deselect', wrappedValue, node, nodeEventInfo);\n    },\n    onSelectorClear: function onSelectorClear(event) {\n      var disabled = this.$props.disabled;\n\n      if (disabled) return;\n\n      this.triggerChange([], []);\n\n      if (!this.isSearchValueControlled()) {\n        this.setUncontrolledState({\n          _searchValue: '',\n          _filteredTreeNodes: null\n        });\n      }\n\n      event.stopPropagation();\n    },\n    onMultipleSelectorRemove: function onMultipleSelectorRemove(event, removeValue) {\n      event.stopPropagation();\n\n      var _$data2 = this.$data,\n          valueList = _$data2._valueList,\n          missValueList = _$data2._missValueList,\n          valueEntities = _$data2._valueEntities;\n      var _$props3 = this.$props,\n          treeCheckable = _$props3.treeCheckable,\n          treeCheckStrictly = _$props3.treeCheckStrictly,\n          treeNodeLabelProp = _$props3.treeNodeLabelProp,\n          disabled = _$props3.disabled;\n\n      if (disabled) return;\n\n      // Find trigger entity\n      var triggerEntity = valueEntities[removeValue];\n\n      // Clean up value\n      var newValueList = valueList;\n      if (triggerEntity) {\n        // If value is in tree\n        if (treeCheckable && !treeCheckStrictly) {\n          newValueList = valueList.filter(function (_ref2) {\n            var value = _ref2.value;\n\n            var entity = valueEntities[value];\n            return !isPosRelated(entity.pos, triggerEntity.pos);\n          });\n        } else {\n          newValueList = valueList.filter(function (_ref3) {\n            var value = _ref3.value;\n            return value !== removeValue;\n          });\n        }\n      }\n\n      var triggerNode = triggerEntity ? triggerEntity.node : null;\n\n      var extraInfo = {\n        triggerValue: removeValue,\n        triggerNode: triggerNode\n      };\n      var deselectInfo = {\n        node: triggerNode\n      };\n\n      // [Legacy] Little hack on this to make same action as `onCheck` event.\n      if (treeCheckable) {\n        var filteredEntityList = newValueList.map(function (_ref4) {\n          var value = _ref4.value;\n          return valueEntities[value];\n        });\n\n        deselectInfo.event = 'check';\n        deselectInfo.checked = false;\n        deselectInfo.checkedNodes = filteredEntityList.map(function (_ref5) {\n          var node = _ref5.node;\n          return node;\n        });\n        deselectInfo.checkedNodesPositions = filteredEntityList.map(function (_ref6) {\n          var node = _ref6.node,\n              pos = _ref6.pos;\n          return {\n            node: node,\n            pos: pos\n          };\n        });\n\n        if (treeCheckStrictly) {\n          extraInfo.allCheckedNodes = deselectInfo.checkedNodes;\n        } else {\n          // TODO: It's too expansive to get `halfCheckedKeys` in onDeselect. Not pass this.\n          extraInfo.allCheckedNodes = flatToHierarchy(filteredEntityList).map(function (_ref7) {\n            var node = _ref7.node;\n            return node;\n          });\n        }\n      } else {\n        deselectInfo.event = 'select';\n        deselectInfo.selected = false;\n        deselectInfo.selectedNodes = newValueList.map(function (_ref8) {\n          var value = _ref8.value;\n          return (valueEntities[value] || {}).node;\n        });\n      }\n\n      // Some value user pass prop is not in the tree, we also need clean it\n      var newMissValueList = missValueList.filter(function (_ref9) {\n        var value = _ref9.value;\n        return value !== removeValue;\n      });\n      var wrappedValue = void 0;\n      if (this.isLabelInValue()) {\n        wrappedValue = {\n          label: triggerNode ? getPropsData(triggerNode)[treeNodeLabelProp] : null,\n          value: removeValue\n        };\n      } else {\n        wrappedValue = removeValue;\n      }\n\n      this.onDeselect(wrappedValue, triggerNode, deselectInfo);\n\n      this.triggerChange(newMissValueList, newValueList, extraInfo);\n    },\n\n\n    // ===================== Popup ======================\n    onValueTrigger: function onValueTrigger(isAdd, nodeList, nodeEventInfo, nodeExtraInfo) {\n      var node = nodeEventInfo.node;\n      var value = node.$props.value;\n      var _$data3 = this.$data,\n          missValueList = _$data3._missValueList,\n          valueEntities = _$data3._valueEntities,\n          keyEntities = _$data3._keyEntities,\n          searchValue = _$data3._searchValue;\n      var _$props4 = this.$props,\n          disabled = _$props4.disabled,\n          inputValue = _$props4.inputValue,\n          treeNodeLabelProp = _$props4.treeNodeLabelProp,\n          multiple = _$props4.multiple,\n          treeCheckable = _$props4.treeCheckable,\n          treeCheckStrictly = _$props4.treeCheckStrictly,\n          autoClearSearchValue = _$props4.autoClearSearchValue;\n\n      var label = node.$props[treeNodeLabelProp];\n\n      if (disabled) return;\n\n      // Wrap the return value for user\n      var wrappedValue = void 0;\n      if (this.isLabelInValue()) {\n        wrappedValue = {\n          value: value,\n          label: label\n        };\n      } else {\n        wrappedValue = value;\n      }\n\n      // [Legacy] Origin code not trigger `onDeselect` every time. Let's align the behaviour.\n      if (isAdd) {\n        this.__emit('select', wrappedValue, node, nodeEventInfo);\n      } else {\n        this.__emit('deselect', wrappedValue, node, nodeEventInfo);\n      }\n\n      // Get wrapped value list.\n      // This is a bit hack cause we use key to match the value.\n      var newValueList = nodeList.map(function (node) {\n        var props = getPropsData(node);\n        return {\n          value: props.value,\n          label: props[treeNodeLabelProp]\n        };\n      });\n\n      // When is `treeCheckable` and with `searchValue`, `valueList` is not full filled.\n      // We need calculate the missing nodes.\n      if (treeCheckable && !treeCheckStrictly) {\n        var keyList = newValueList.map(function (_ref10) {\n          var val = _ref10.value;\n          return valueEntities[val].key;\n        });\n        if (isAdd) {\n          keyList = conductCheck(keyList, true, keyEntities).checkedKeys;\n        } else {\n          keyList = conductCheck([valueEntities[value].key], false, keyEntities, {\n            checkedKeys: keyList\n          }).checkedKeys;\n        }\n        newValueList = keyList.map(function (key) {\n          var props = getPropsData(keyEntities.get(key).node);\n          return {\n            value: props.value,\n            label: props[treeNodeLabelProp]\n          };\n        });\n      }\n\n      // Clean up `searchValue` when this prop is set\n      if (autoClearSearchValue || inputValue === null) {\n        // Clean state `searchValue` if uncontrolled\n        if (!this.isSearchValueControlled() && (multiple || treeCheckable)) {\n          this.setUncontrolledState({\n            _searchValue: '',\n            _filteredTreeNodes: null\n          });\n        }\n\n        // Trigger onSearch if `searchValue` to be empty.\n        // We should also trigger onSearch with empty string here\n        // since if user use `treeExpandedKeys`, it need user have the ability to reset it.\n        if (searchValue && searchValue.length) {\n          this.__emit('update:searchValue', '');\n          this.__emit('search', '');\n        }\n      }\n\n      // [Legacy] Provide extra info\n      var extraInfo = _extends({}, nodeExtraInfo, {\n        triggerValue: value,\n        triggerNode: node\n      });\n\n      this.triggerChange(missValueList, newValueList, extraInfo);\n    },\n    onTreeNodeSelect: function onTreeNodeSelect(_, nodeEventInfo) {\n      var _$data4 = this.$data,\n          valueList = _$data4._valueList,\n          valueEntities = _$data4._valueEntities;\n      var _$props5 = this.$props,\n          treeCheckable = _$props5.treeCheckable,\n          multiple = _$props5.multiple;\n\n      if (treeCheckable) return;\n\n      if (!multiple) {\n        this.setOpenState(false);\n      }\n\n      var isAdd = nodeEventInfo.selected;\n      var selectedValue = nodeEventInfo.node.$props.value;\n\n\n      var newValueList = void 0;\n\n      if (!multiple) {\n        newValueList = [{ value: selectedValue }];\n      } else {\n        newValueList = valueList.filter(function (_ref11) {\n          var value = _ref11.value;\n          return value !== selectedValue;\n        });\n        if (isAdd) {\n          newValueList.push({ value: selectedValue });\n        }\n      }\n\n      var selectedNodes = newValueList.map(function (_ref12) {\n        var value = _ref12.value;\n        return valueEntities[value];\n      }).filter(function (entity) {\n        return entity;\n      }).map(function (_ref13) {\n        var node = _ref13.node;\n        return node;\n      });\n\n      this.onValueTrigger(isAdd, selectedNodes, nodeEventInfo, { selected: isAdd });\n    },\n    onTreeNodeCheck: function onTreeNodeCheck(_, nodeEventInfo) {\n      var _$data5 = this.$data,\n          searchValue = _$data5._searchValue,\n          keyEntities = _$data5._keyEntities,\n          valueEntities = _$data5._valueEntities,\n          valueList = _$data5._valueList;\n      var treeCheckStrictly = this.$props.treeCheckStrictly;\n      var checkedNodes = nodeEventInfo.checkedNodes,\n          checkedNodesPositions = nodeEventInfo.checkedNodesPositions;\n\n      var isAdd = nodeEventInfo.checked;\n\n      var extraInfo = {\n        checked: isAdd\n      };\n\n      var checkedNodeList = checkedNodes;\n\n      // [Legacy] Check event provide `allCheckedNodes`.\n      // When `treeCheckStrictly` or internal `searchValue` is set, TreeNode will be unrelated:\n      // - Related: Show the top checked nodes and has children prop.\n      // - Unrelated: Show all the checked nodes.\n      if (searchValue) {\n        var oriKeyList = valueList.map(function (_ref14) {\n          var value = _ref14.value;\n          return valueEntities[value];\n        }).filter(function (entity) {\n          return entity;\n        }).map(function (_ref15) {\n          var key = _ref15.key;\n          return key;\n        });\n\n        var keyList = void 0;\n        if (isAdd) {\n          keyList = Array.from(new Set([].concat(_toConsumableArray(oriKeyList), _toConsumableArray(checkedNodeList.map(function (node) {\n            var _getPropsData = getPropsData(node),\n                value = _getPropsData.value;\n\n            return valueEntities[value].key;\n          })))));\n        } else {\n          keyList = conductCheck([getPropsData(nodeEventInfo.node).eventKey], false, keyEntities, {\n            checkedKeys: oriKeyList\n          }).checkedKeys;\n        }\n\n        checkedNodeList = keyList.map(function (key) {\n          return keyEntities.get(key).node;\n        });\n\n        // Let's follow as not `treeCheckStrictly` format\n        extraInfo.allCheckedNodes = keyList.map(function (key) {\n          return cleanEntity(keyEntities.get(key));\n        });\n      } else if (treeCheckStrictly) {\n        extraInfo.allCheckedNodes = nodeEventInfo.checkedNodes;\n      } else {\n        extraInfo.allCheckedNodes = flatToHierarchy(checkedNodesPositions);\n      }\n\n      this.onValueTrigger(isAdd, checkedNodeList, nodeEventInfo, extraInfo);\n    },\n\n\n    // ==================== Trigger =====================\n\n    onDropdownVisibleChange: function onDropdownVisibleChange(open) {\n      var _$props6 = this.$props,\n          multiple = _$props6.multiple,\n          treeCheckable = _$props6.treeCheckable;\n      var _searchValue = this.$data._searchValue;\n\n      // When set open success and single mode,\n      // we will reset the input content.\n\n      if (open && !multiple && !treeCheckable && _searchValue) {\n        this.setUncontrolledState({\n          _searchValue: '',\n          _filteredTreeNodes: null\n        });\n      }\n      this.setOpenState(open, true);\n    },\n    onSearchInputChange: function onSearchInputChange(event) {\n      var value = event.target.value;\n      var _$data6 = this.$data,\n          treeNodes = _$data6._treeNodes,\n          valueEntities = _$data6._valueEntities;\n      var _$props7 = this.$props,\n          filterTreeNode = _$props7.filterTreeNode,\n          treeNodeFilterProp = _$props7.treeNodeFilterProp;\n\n      this.__emit('update:searchValue', value);\n      this.__emit('search', value);\n\n      var isSet = false;\n\n      if (!this.isSearchValueControlled()) {\n        isSet = this.setUncontrolledState({\n          _searchValue: value\n        });\n        this.setOpenState(true);\n      }\n\n      if (isSet) {\n        // Do the search logic\n        var upperSearchValue = String(value).toUpperCase();\n\n        var filterTreeNodeFn = filterTreeNode;\n        if (filterTreeNode === false) {\n          filterTreeNodeFn = function filterTreeNodeFn() {\n            return true;\n          };\n        } else if (!filterTreeNodeFn) {\n          filterTreeNodeFn = function filterTreeNodeFn(_, node) {\n            var nodeValue = String(getPropsData(node)[treeNodeFilterProp]).toUpperCase();\n            return nodeValue.indexOf(upperSearchValue) !== -1;\n          };\n        }\n\n        this.setState({\n          _filteredTreeNodes: getFilterTree(this.$createElement, treeNodes, value, filterTreeNodeFn, valueEntities, SelectNode)\n        });\n      }\n    },\n    onSearchInputKeyDown: function onSearchInputKeyDown(event) {\n      var _$data7 = this.$data,\n          searchValue = _$data7._searchValue,\n          valueList = _$data7._valueList;\n      var keyCode = event.keyCode;\n\n\n      if (KeyCode.BACKSPACE === keyCode && this.isMultiple() && !searchValue && valueList.length) {\n        var lastValue = valueList[valueList.length - 1].value;\n        this.onMultipleSelectorRemove(event, lastValue);\n      }\n    },\n    onChoiceAnimationLeave: function onChoiceAnimationLeave() {\n      var _this4 = this;\n\n      raf(function () {\n        _this4.forcePopupAlign();\n      });\n    },\n    setPopupRef: function setPopupRef(popup) {\n      this.popup = popup;\n    },\n\n\n    /**\n     * Only update the value which is not in props\n     */\n    setUncontrolledState: function setUncontrolledState(state) {\n      var needSync = false;\n      var newState = {};\n      var props = getOptionProps(this);\n      Object.keys(state).forEach(function (name) {\n        if (name.slice(1) in props) return;\n\n        needSync = true;\n        newState[name] = state[name];\n      });\n\n      if (needSync) {\n        this.setState(newState);\n      }\n\n      return needSync;\n    },\n\n\n    // [Legacy] Origin provide `documentClickClose` which triggered by `Trigger`\n    // Currently `TreeSelect` align the hide popup logic as `Select` which blur to hide.\n    // `documentClickClose` is not accurate anymore. Let's just keep the key word.\n    setOpenState: function setOpenState(open) {\n      var byTrigger = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var dropdownVisibleChange = this.$props.dropdownVisibleChange;\n\n\n      if (dropdownVisibleChange && dropdownVisibleChange(open, { documentClickClose: !open && byTrigger }) === false) {\n        return;\n      }\n\n      this.setUncontrolledState({ _open: open });\n    },\n\n\n    // Tree checkable is also a multiple case\n    isMultiple: function isMultiple() {\n      var _$props8 = this.$props,\n          multiple = _$props8.multiple,\n          treeCheckable = _$props8.treeCheckable;\n\n      return !!(multiple || treeCheckable);\n    },\n    isLabelInValue: function isLabelInValue() {\n      return _isLabelInValue(this.$props);\n    },\n\n\n    // [Legacy] To align with `Select` component,\n    // We use `searchValue` instead of `inputValue`\n    // but currently still need support that.\n    // Add this method the check if is controlled\n    isSearchValueControlled: function isSearchValueControlled() {\n      var props = getOptionProps(this);\n      var inputValue = props.inputValue;\n\n      if ('searchValue' in props) return true;\n      return 'inputValue' in props && inputValue !== null;\n    },\n    forcePopupAlign: function forcePopupAlign() {\n      var $trigger = this.selectTriggerRef.current;\n      if ($trigger) {\n        $trigger.forcePopupAlign();\n      }\n    },\n    delayForcePopupAlign: function delayForcePopupAlign() {\n      var _this5 = this;\n\n      // Wait 2 frame to avoid dom update & dom algin in the same time\n      // https://github.com/ant-design/ant-design/issues/12031\n      raf(function () {\n        raf(_this5.forcePopupAlign);\n      });\n    },\n\n\n    /**\n     * 1. Update state valueList.\n     * 2. Fire `onChange` event to user.\n     */\n    triggerChange: function triggerChange(missValueList, valueList) {\n      var extraInfo = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var _$data8 = this.$data,\n          valueEntities = _$data8._valueEntities,\n          searchValue = _$data8._searchValue,\n          prevSelectorValueList = _$data8._selectorValueList;\n\n      var props = getOptionProps(this);\n      var disabled = props.disabled,\n          treeCheckable = props.treeCheckable,\n          treeCheckStrictly = props.treeCheckStrictly;\n\n      if (disabled) return;\n\n      // Trigger\n      var extra = _extends({\n        // [Legacy] Always return as array contains label & value\n        preValue: prevSelectorValueList.map(function (_ref16) {\n          var label = _ref16.label,\n              value = _ref16.value;\n          return { label: label, value: value };\n        })\n      }, extraInfo);\n\n      // Format value by `treeCheckStrictly`\n      var selectorValueList = formatSelectorValue(valueList, props, valueEntities);\n\n      if (!('value' in props)) {\n        var newState = {\n          _missValueList: missValueList,\n          _valueList: valueList,\n          _selectorValueList: selectorValueList\n        };\n\n        if (searchValue && treeCheckable && !treeCheckStrictly) {\n          newState._searchHalfCheckedKeys = getHalfCheckedKeys(valueList, valueEntities);\n        }\n\n        this.setState(newState);\n      }\n\n      // Only do the logic when `onChange` function provided\n      if (getListeners(this).change) {\n        var connectValueList = void 0;\n\n        // Get value by mode\n        if (this.isMultiple()) {\n          connectValueList = [].concat(_toConsumableArray(missValueList), _toConsumableArray(selectorValueList));\n        } else {\n          connectValueList = selectorValueList.slice(0, 1);\n        }\n\n        var labelList = null;\n        var returnValue = void 0;\n\n        if (this.isLabelInValue()) {\n          returnValue = connectValueList.map(function (_ref17) {\n            var label = _ref17.label,\n                value = _ref17.value;\n            return { label: label, value: value };\n          });\n        } else {\n          labelList = [];\n          returnValue = connectValueList.map(function (_ref18) {\n            var label = _ref18.label,\n                value = _ref18.value;\n\n            labelList.push(label);\n            return value;\n          });\n        }\n\n        if (!this.isMultiple()) {\n          returnValue = returnValue[0];\n        }\n        this.__emit('change', returnValue, labelList, extra);\n      }\n    },\n    focus: function focus() {\n      this.selectorRef.current.focus();\n    },\n    blur: function blur() {\n      this.selectorRef.current.blur();\n    }\n  },\n\n  // ===================== Render =====================\n\n  render: function render() {\n    var h = arguments[0];\n    var _$data9 = this.$data,\n        valueList = _$data9._valueList,\n        missValueList = _$data9._missValueList,\n        selectorValueList = _$data9._selectorValueList,\n        searchHalfCheckedKeys = _$data9._searchHalfCheckedKeys,\n        valueEntities = _$data9._valueEntities,\n        keyEntities = _$data9._keyEntities,\n        searchValue = _$data9._searchValue,\n        open = _$data9._open,\n        focused = _$data9._focused,\n        treeNodes = _$data9._treeNodes,\n        filteredTreeNodes = _$data9._filteredTreeNodes;\n\n    var props = getOptionProps(this);\n    var prefixCls = props.prefixCls,\n        treeExpandedKeys = props.treeExpandedKeys;\n\n    var isMultiple = this.isMultiple();\n\n    var passProps = {\n      props: _extends({}, props, {\n        isMultiple: isMultiple,\n        valueList: valueList,\n        searchHalfCheckedKeys: searchHalfCheckedKeys,\n        selectorValueList: [].concat(_toConsumableArray(missValueList), _toConsumableArray(selectorValueList)),\n        valueEntities: valueEntities,\n        keyEntities: keyEntities,\n        searchValue: searchValue,\n        upperSearchValue: (searchValue || '').toUpperCase(), // Perf save\n        open: open,\n        focused: focused,\n        dropdownPrefixCls: prefixCls + '-dropdown',\n        ariaId: this.ariaId\n      }),\n      on: _extends({}, getListeners(this), {\n        choiceAnimationLeave: this.onChoiceAnimationLeave\n      }),\n      scopedSlots: this.$scopedSlots\n    };\n    var popupProps = mergeProps(passProps, {\n      props: {\n        treeNodes: treeNodes,\n        filteredTreeNodes: filteredTreeNodes,\n        // Tree expanded control\n        treeExpandedKeys: treeExpandedKeys,\n        __propsSymbol__: Symbol()\n      },\n      on: {\n        treeExpanded: this.delayForcePopupAlign\n      },\n      directives: [{\n        name: 'ant-ref',\n        value: this.setPopupRef\n      }]\n    });\n\n    var Popup = isMultiple ? MultiplePopup : SinglePopup;\n    var $popup = h(Popup, popupProps);\n\n    var Selector = isMultiple ? MultipleSelector : SingleSelector;\n    var $selector = h(Selector, _mergeJSXProps([passProps, {\n      directives: [{\n        name: 'ant-ref',\n        value: this.selectorRef\n      }]\n    }]));\n    var selectTriggerProps = mergeProps(passProps, {\n      props: {\n        popupElement: $popup,\n        dropdownVisibleChange: this.onDropdownVisibleChange\n      },\n      directives: [{\n        name: 'ant-ref',\n        value: this.selectTriggerRef\n      }]\n    });\n    return h(\n      SelectTrigger,\n      selectTriggerProps,\n      [$selector]\n    );\n  }\n};\n\nSelect.TreeNode = SelectNode;\nSelect.SHOW_ALL = SHOW_ALL;\nSelect.SHOW_PARENT = SHOW_PARENT;\nSelect.SHOW_CHILD = SHOW_CHILD;\n\n// Let warning show correct component name\nSelect.name = 'TreeSelect';\n\nexport default Select;"]},"metadata":{},"sourceType":"module"}