{"ast":null,"code":"import _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _extends from 'babel-runtime/helpers/extends';\nimport omit from 'omit.js';\nimport PropTypes from '../_util/vue-types';\nimport { connect } from '../_util/store';\nimport BaseMixin from '../_util/BaseMixin';\nimport KeyCode from '../_util/KeyCode';\nimport classNames from 'classnames';\nimport { getKeyFromChildrenIndex, loopMenuItem, noop, isMobileDevice } from './util';\nimport DOMWrap from './DOMWrap';\nimport { cloneElement } from '../_util/vnode';\nimport { initDefaultProps, getOptionProps, getPropsData, getEvents, getComponentFromProp, getListeners } from '../_util/props-util';\n\nfunction allDisabled(arr) {\n  if (!arr.length) {\n    return true;\n  }\n\n  return arr.every(function (c) {\n    return !!c.disabled;\n  });\n}\n\nfunction updateActiveKey(store, menuId, activeKey) {\n  var state = store.getState();\n  store.setState({\n    activeKey: _extends({}, state.activeKey, _defineProperty({}, menuId, activeKey))\n  });\n}\n\nfunction getEventKey(props) {\n  // when eventKey not available ,it's menu and return menu id '0-menu-'\n  return props.eventKey || '0-menu-';\n}\n\nexport function saveRef(key, c) {\n  if (c) {\n    var index = this.instanceArrayKeyIndexMap[key];\n    this.instanceArray[index] = c;\n  }\n}\nexport function getActiveKey(props, originalActiveKey) {\n  var activeKey = originalActiveKey;\n  var eventKey = props.eventKey,\n      defaultActiveFirst = props.defaultActiveFirst,\n      children = props.children;\n\n  if (activeKey !== undefined && activeKey !== null) {\n    var found = void 0;\n    loopMenuItem(children, function (c, i) {\n      var propsData = c.componentOptions.propsData || {};\n\n      if (c && !propsData.disabled && activeKey === getKeyFromChildrenIndex(c, eventKey, i)) {\n        found = true;\n      }\n    });\n\n    if (found) {\n      return activeKey;\n    }\n  }\n\n  activeKey = null;\n\n  if (defaultActiveFirst) {\n    loopMenuItem(children, function (c, i) {\n      var propsData = c.componentOptions.propsData || {};\n      var noActiveKey = activeKey === null || activeKey === undefined;\n\n      if (noActiveKey && c && !propsData.disabled) {\n        activeKey = getKeyFromChildrenIndex(c, eventKey, i);\n      }\n    });\n    return activeKey;\n  }\n\n  return activeKey;\n}\nvar SubPopupMenu = {\n  name: 'SubPopupMenu',\n  props: initDefaultProps({\n    // onSelect: PropTypes.func,\n    // onClick: PropTypes.func,\n    // onDeselect: PropTypes.func,\n    // onOpenChange: PropTypes.func,\n    // onDestroy: PropTypes.func,\n    prefixCls: PropTypes.string,\n    openTransitionName: PropTypes.string,\n    openAnimation: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n    openKeys: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.number])),\n    visible: PropTypes.bool,\n    parentMenu: PropTypes.object,\n    eventKey: PropTypes.string,\n    store: PropTypes.object,\n    forceSubMenuRender: PropTypes.bool,\n    // adding in refactor\n    focusable: PropTypes.bool,\n    multiple: PropTypes.bool,\n    defaultActiveFirst: PropTypes.bool,\n    activeKey: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    selectedKeys: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.number])),\n    defaultSelectedKeys: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.number])),\n    defaultOpenKeys: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.number])),\n    level: PropTypes.number,\n    mode: PropTypes.oneOf(['horizontal', 'vertical', 'vertical-left', 'vertical-right', 'inline']),\n    triggerSubMenuAction: PropTypes.oneOf(['click', 'hover']),\n    inlineIndent: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    manualRef: PropTypes.func,\n    itemIcon: PropTypes.any,\n    expandIcon: PropTypes.any,\n    overflowedIndicator: PropTypes.any,\n    children: PropTypes.any.def([]),\n    __propsSymbol__: PropTypes.any // mock componentWillReceiveProps\n\n  }, {\n    prefixCls: 'rc-menu',\n    mode: 'vertical',\n    level: 1,\n    inlineIndent: 24,\n    visible: true,\n    focusable: true,\n    manualRef: noop\n  }),\n  mixins: [BaseMixin],\n  created: function created() {\n    var props = getOptionProps(this);\n    this.prevProps = _extends({}, props);\n    props.store.setState({\n      activeKey: _extends({}, props.store.getState().activeKey, _defineProperty({}, props.eventKey, getActiveKey(props, props.activeKey)))\n    });\n    this.instanceArray = [];\n  },\n  mounted: function mounted() {\n    // invoke customized ref to expose component to mixin\n    if (this.manualRef) {\n      this.manualRef(this);\n    }\n  },\n  updated: function updated() {\n    var props = getOptionProps(this);\n    var prevProps = this.prevProps;\n    var originalActiveKey = 'activeKey' in props ? props.activeKey : props.store.getState().activeKey[getEventKey(props)];\n    var activeKey = getActiveKey(props, originalActiveKey);\n\n    if (activeKey !== originalActiveKey) {\n      updateActiveKey(props.store, getEventKey(props), activeKey);\n    } else if ('activeKey' in prevProps) {\n      // If prev activeKey is not same as current activeKey,\n      // we should set it.\n      var prevActiveKey = getActiveKey(prevProps, prevProps.activeKey);\n\n      if (activeKey !== prevActiveKey) {\n        updateActiveKey(props.store, getEventKey(props), activeKey);\n      }\n    }\n\n    this.prevProps = _extends({}, props);\n  },\n  methods: {\n    // all keyboard events callbacks run from here at first\n    onKeyDown: function onKeyDown(e, callback) {\n      var keyCode = e.keyCode;\n      var handled = void 0;\n      this.getFlatInstanceArray().forEach(function (obj) {\n        if (obj && obj.active && obj.onKeyDown) {\n          handled = obj.onKeyDown(e);\n        }\n      });\n\n      if (handled) {\n        return 1;\n      }\n\n      var activeItem = null;\n\n      if (keyCode === KeyCode.UP || keyCode === KeyCode.DOWN) {\n        activeItem = this.step(keyCode === KeyCode.UP ? -1 : 1);\n      }\n\n      if (activeItem) {\n        e.preventDefault();\n        updateActiveKey(this.$props.store, getEventKey(this.$props), activeItem.eventKey);\n\n        if (typeof callback === 'function') {\n          callback(activeItem);\n        }\n\n        return 1;\n      }\n\n      return undefined;\n    },\n    onItemHover: function onItemHover(e) {\n      var key = e.key,\n          hover = e.hover;\n      updateActiveKey(this.$props.store, getEventKey(this.$props), hover ? key : null);\n    },\n    onDeselect: function onDeselect(selectInfo) {\n      this.__emit('deselect', selectInfo);\n    },\n    onSelect: function onSelect(selectInfo) {\n      this.__emit('select', selectInfo);\n    },\n    onClick: function onClick(e) {\n      this.__emit('click', e);\n    },\n    onOpenChange: function onOpenChange(e) {\n      this.__emit('openChange', e);\n    },\n    onDestroy: function onDestroy(key) {\n      this.__emit('destroy', key);\n    },\n    getFlatInstanceArray: function getFlatInstanceArray() {\n      return this.instanceArray;\n    },\n    getOpenTransitionName: function getOpenTransitionName() {\n      return this.$props.openTransitionName;\n    },\n    step: function step(direction) {\n      var children = this.getFlatInstanceArray();\n      var activeKey = this.$props.store.getState().activeKey[getEventKey(this.$props)];\n      var len = children.length;\n\n      if (!len) {\n        return null;\n      }\n\n      if (direction < 0) {\n        children = children.concat().reverse();\n      } // find current activeIndex\n\n\n      var activeIndex = -1;\n      children.every(function (c, ci) {\n        if (c && c.eventKey === activeKey) {\n          activeIndex = ci;\n          return false;\n        }\n\n        return true;\n      });\n\n      if (!this.defaultActiveFirst && activeIndex !== -1 && allDisabled(children.slice(activeIndex, len - 1))) {\n        return undefined;\n      }\n\n      var start = (activeIndex + 1) % len;\n      var i = start;\n\n      do {\n        var child = children[i];\n\n        if (!child || child.disabled) {\n          i = (i + 1) % len;\n        } else {\n          return child;\n        }\n      } while (i !== start);\n\n      return null;\n    },\n    getIcon: function getIcon(instance, name) {\n      if (instance.$createElement) {\n        var temp = instance[name];\n\n        if (temp !== undefined) {\n          return temp;\n        }\n\n        return instance.$slots[name] || instance.$scopedSlots[name];\n      } else {\n        var _temp = getPropsData(instance)[name];\n\n        if (_temp !== undefined) {\n          return _temp;\n        }\n\n        var slotsProp = [];\n        var componentOptions = instance.componentOptions || {};\n        (componentOptions.children || []).forEach(function (child) {\n          if (child.data && child.data.slot === name) {\n            if (child.tag === 'template') {\n              slotsProp.push(child.children);\n            } else {\n              slotsProp.push(child);\n            }\n          }\n        });\n        return slotsProp.length ? slotsProp : undefined;\n      }\n    },\n    renderCommonMenuItem: function renderCommonMenuItem(child, i, extraProps) {\n      var _this = this;\n\n      if (child.tag === undefined) {\n        return child;\n      }\n\n      var state = this.$props.store.getState();\n      var props = this.$props;\n      var key = getKeyFromChildrenIndex(child, props.eventKey, i);\n      var childProps = child.componentOptions.propsData || {};\n      var isActive = key === state.activeKey[getEventKey(this.$props)];\n\n      if (!childProps.disabled) {\n        // manualRef的执行顺序不能保证，使用key映射ref在this.instanceArray中的位置\n        this.instanceArrayKeyIndexMap[key] = Object.keys(this.instanceArrayKeyIndexMap).length;\n      }\n\n      var childListeners = getEvents(child);\n      var newChildProps = {\n        props: _extends({\n          mode: childProps.mode || props.mode,\n          level: props.level,\n          inlineIndent: props.inlineIndent,\n          renderMenuItem: this.renderMenuItem,\n          rootPrefixCls: props.prefixCls,\n          index: i,\n          parentMenu: props.parentMenu,\n          // customized ref function, need to be invoked manually in child's componentDidMount\n          manualRef: childProps.disabled ? noop : saveRef.bind(this, key),\n          eventKey: key,\n          active: !childProps.disabled && isActive,\n          multiple: props.multiple,\n          openTransitionName: this.getOpenTransitionName(),\n          openAnimation: props.openAnimation,\n          subMenuOpenDelay: props.subMenuOpenDelay,\n          subMenuCloseDelay: props.subMenuCloseDelay,\n          forceSubMenuRender: props.forceSubMenuRender,\n          builtinPlacements: props.builtinPlacements,\n          itemIcon: this.getIcon(child, 'itemIcon') || this.getIcon(this, 'itemIcon'),\n          expandIcon: this.getIcon(child, 'expandIcon') || this.getIcon(this, 'expandIcon')\n        }, extraProps),\n        on: {\n          click: function click(e) {\n            (childListeners.click || noop)(e);\n\n            _this.onClick(e);\n          },\n          itemHover: this.onItemHover,\n          openChange: this.onOpenChange,\n          deselect: this.onDeselect,\n          // destroy: this.onDestroy,\n          select: this.onSelect\n        }\n      }; // ref: https://github.com/ant-design/ant-design/issues/13943\n\n      if (props.mode === 'inline' || isMobileDevice()) {\n        newChildProps.props.triggerSubMenuAction = 'click';\n      }\n\n      return cloneElement(child, newChildProps);\n    },\n    renderMenuItem: function renderMenuItem(c, i, subMenuKey) {\n      if (!c) {\n        return null;\n      }\n\n      var state = this.$props.store.getState();\n      var extraProps = {\n        openKeys: state.openKeys,\n        selectedKeys: state.selectedKeys,\n        triggerSubMenuAction: this.triggerSubMenuAction,\n        isRootMenu: false,\n        subMenuKey: subMenuKey\n      };\n      return this.renderCommonMenuItem(c, i, extraProps);\n    }\n  },\n  render: function render() {\n    var _this2 = this;\n\n    var h = arguments[0];\n\n    var props = _objectWithoutProperties(this.$props, []);\n\n    var eventKey = props.eventKey,\n        prefixCls = props.prefixCls,\n        visible = props.visible,\n        level = props.level,\n        mode = props.mode,\n        theme = props.theme;\n    this.instanceArray = [];\n    this.instanceArrayKeyIndexMap = {};\n    var className = classNames(props.prefixCls, props.prefixCls + '-' + props.mode);\n    var domWrapProps = {\n      props: {\n        tag: 'ul',\n        // hiddenClassName: `${prefixCls}-hidden`,\n        visible: visible,\n        prefixCls: prefixCls,\n        level: level,\n        mode: mode,\n        theme: theme,\n        overflowedIndicator: getComponentFromProp(this, 'overflowedIndicator')\n      },\n      attrs: {\n        role: props.role || 'menu'\n      },\n      'class': className,\n      // Otherwise, the propagated click event will trigger another onClick\n      on: omit(getListeners(this), ['click'])\n    }; // if (props.id) {\n    //   domProps.id = props.id\n    // }\n\n    if (props.focusable) {\n      domWrapProps.attrs.tabIndex = '0';\n      domWrapProps.on.keydown = this.onKeyDown;\n    }\n\n    return (// ESLint is not smart enough to know that the type of `children` was checked.\n\n      /* eslint-disable */\n      h(DOMWrap, domWrapProps, [props.children.map(function (c, i) {\n        return _this2.renderMenuItem(c, i, eventKey || '0-menu-');\n      })])\n      /*eslint -enable */\n\n    );\n  }\n};\nexport default connect()(SubPopupMenu);","map":{"version":3,"sources":["/Users/liulu/刘璐/vue3/hello-vue3/node_modules/ant-design-vue/es/vc-menu/SubPopupMenu.js"],"names":["_objectWithoutProperties","_defineProperty","_extends","omit","PropTypes","connect","BaseMixin","KeyCode","classNames","getKeyFromChildrenIndex","loopMenuItem","noop","isMobileDevice","DOMWrap","cloneElement","initDefaultProps","getOptionProps","getPropsData","getEvents","getComponentFromProp","getListeners","allDisabled","arr","length","every","c","disabled","updateActiveKey","store","menuId","activeKey","state","getState","setState","getEventKey","props","eventKey","saveRef","key","index","instanceArrayKeyIndexMap","instanceArray","getActiveKey","originalActiveKey","defaultActiveFirst","children","undefined","found","i","propsData","componentOptions","noActiveKey","SubPopupMenu","name","prefixCls","string","openTransitionName","openAnimation","oneOfType","object","openKeys","arrayOf","number","visible","bool","parentMenu","forceSubMenuRender","focusable","multiple","selectedKeys","defaultSelectedKeys","defaultOpenKeys","level","mode","oneOf","triggerSubMenuAction","inlineIndent","manualRef","func","itemIcon","any","expandIcon","overflowedIndicator","def","__propsSymbol__","mixins","created","prevProps","mounted","updated","prevActiveKey","methods","onKeyDown","e","callback","keyCode","handled","getFlatInstanceArray","forEach","obj","active","activeItem","UP","DOWN","step","preventDefault","$props","onItemHover","hover","onDeselect","selectInfo","__emit","onSelect","onClick","onOpenChange","onDestroy","getOpenTransitionName","direction","len","concat","reverse","activeIndex","ci","slice","start","child","getIcon","instance","$createElement","temp","$slots","$scopedSlots","_temp","slotsProp","data","slot","tag","push","renderCommonMenuItem","extraProps","_this","childProps","isActive","Object","keys","childListeners","newChildProps","renderMenuItem","rootPrefixCls","bind","subMenuOpenDelay","subMenuCloseDelay","builtinPlacements","on","click","itemHover","openChange","deselect","select","subMenuKey","isRootMenu","render","_this2","h","arguments","theme","className","domWrapProps","attrs","role","tabIndex","keydown","map"],"mappings":"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","sourcesContent":["import _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _extends from 'babel-runtime/helpers/extends';\nimport omit from 'omit.js';\nimport PropTypes from '../_util/vue-types';\nimport { connect } from '../_util/store';\nimport BaseMixin from '../_util/BaseMixin';\nimport KeyCode from '../_util/KeyCode';\nimport classNames from 'classnames';\nimport { getKeyFromChildrenIndex, loopMenuItem, noop, isMobileDevice } from './util';\nimport DOMWrap from './DOMWrap';\nimport { cloneElement } from '../_util/vnode';\nimport { initDefaultProps, getOptionProps, getPropsData, getEvents, getComponentFromProp, getListeners } from '../_util/props-util';\n\nfunction allDisabled(arr) {\n  if (!arr.length) {\n    return true;\n  }\n  return arr.every(function (c) {\n    return !!c.disabled;\n  });\n}\n\nfunction updateActiveKey(store, menuId, activeKey) {\n  var state = store.getState();\n  store.setState({\n    activeKey: _extends({}, state.activeKey, _defineProperty({}, menuId, activeKey))\n  });\n}\n\nfunction getEventKey(props) {\n  // when eventKey not available ,it's menu and return menu id '0-menu-'\n  return props.eventKey || '0-menu-';\n}\n\nexport function saveRef(key, c) {\n  if (c) {\n    var index = this.instanceArrayKeyIndexMap[key];\n    this.instanceArray[index] = c;\n  }\n}\nexport function getActiveKey(props, originalActiveKey) {\n  var activeKey = originalActiveKey;\n  var eventKey = props.eventKey,\n      defaultActiveFirst = props.defaultActiveFirst,\n      children = props.children;\n\n  if (activeKey !== undefined && activeKey !== null) {\n    var found = void 0;\n    loopMenuItem(children, function (c, i) {\n      var propsData = c.componentOptions.propsData || {};\n      if (c && !propsData.disabled && activeKey === getKeyFromChildrenIndex(c, eventKey, i)) {\n        found = true;\n      }\n    });\n    if (found) {\n      return activeKey;\n    }\n  }\n  activeKey = null;\n  if (defaultActiveFirst) {\n    loopMenuItem(children, function (c, i) {\n      var propsData = c.componentOptions.propsData || {};\n      var noActiveKey = activeKey === null || activeKey === undefined;\n      if (noActiveKey && c && !propsData.disabled) {\n        activeKey = getKeyFromChildrenIndex(c, eventKey, i);\n      }\n    });\n    return activeKey;\n  }\n  return activeKey;\n}\n\nvar SubPopupMenu = {\n  name: 'SubPopupMenu',\n  props: initDefaultProps({\n    // onSelect: PropTypes.func,\n    // onClick: PropTypes.func,\n    // onDeselect: PropTypes.func,\n    // onOpenChange: PropTypes.func,\n    // onDestroy: PropTypes.func,\n    prefixCls: PropTypes.string,\n    openTransitionName: PropTypes.string,\n    openAnimation: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n    openKeys: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.number])),\n    visible: PropTypes.bool,\n    parentMenu: PropTypes.object,\n    eventKey: PropTypes.string,\n    store: PropTypes.object,\n    forceSubMenuRender: PropTypes.bool,\n\n    // adding in refactor\n    focusable: PropTypes.bool,\n    multiple: PropTypes.bool,\n    defaultActiveFirst: PropTypes.bool,\n    activeKey: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    selectedKeys: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.number])),\n    defaultSelectedKeys: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.number])),\n    defaultOpenKeys: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.number])),\n    level: PropTypes.number,\n    mode: PropTypes.oneOf(['horizontal', 'vertical', 'vertical-left', 'vertical-right', 'inline']),\n    triggerSubMenuAction: PropTypes.oneOf(['click', 'hover']),\n    inlineIndent: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    manualRef: PropTypes.func,\n    itemIcon: PropTypes.any,\n    expandIcon: PropTypes.any,\n    overflowedIndicator: PropTypes.any,\n    children: PropTypes.any.def([]),\n    __propsSymbol__: PropTypes.any // mock componentWillReceiveProps\n  }, {\n    prefixCls: 'rc-menu',\n    mode: 'vertical',\n    level: 1,\n    inlineIndent: 24,\n    visible: true,\n    focusable: true,\n    manualRef: noop\n  }),\n\n  mixins: [BaseMixin],\n  created: function created() {\n    var props = getOptionProps(this);\n    this.prevProps = _extends({}, props);\n    props.store.setState({\n      activeKey: _extends({}, props.store.getState().activeKey, _defineProperty({}, props.eventKey, getActiveKey(props, props.activeKey)))\n    });\n    this.instanceArray = [];\n  },\n  mounted: function mounted() {\n    // invoke customized ref to expose component to mixin\n    if (this.manualRef) {\n      this.manualRef(this);\n    }\n  },\n  updated: function updated() {\n    var props = getOptionProps(this);\n    var prevProps = this.prevProps;\n    var originalActiveKey = 'activeKey' in props ? props.activeKey : props.store.getState().activeKey[getEventKey(props)];\n    var activeKey = getActiveKey(props, originalActiveKey);\n    if (activeKey !== originalActiveKey) {\n      updateActiveKey(props.store, getEventKey(props), activeKey);\n    } else if ('activeKey' in prevProps) {\n      // If prev activeKey is not same as current activeKey,\n      // we should set it.\n      var prevActiveKey = getActiveKey(prevProps, prevProps.activeKey);\n      if (activeKey !== prevActiveKey) {\n        updateActiveKey(props.store, getEventKey(props), activeKey);\n      }\n    }\n    this.prevProps = _extends({}, props);\n  },\n\n  methods: {\n    // all keyboard events callbacks run from here at first\n    onKeyDown: function onKeyDown(e, callback) {\n      var keyCode = e.keyCode;\n      var handled = void 0;\n      this.getFlatInstanceArray().forEach(function (obj) {\n        if (obj && obj.active && obj.onKeyDown) {\n          handled = obj.onKeyDown(e);\n        }\n      });\n      if (handled) {\n        return 1;\n      }\n      var activeItem = null;\n      if (keyCode === KeyCode.UP || keyCode === KeyCode.DOWN) {\n        activeItem = this.step(keyCode === KeyCode.UP ? -1 : 1);\n      }\n      if (activeItem) {\n        e.preventDefault();\n        updateActiveKey(this.$props.store, getEventKey(this.$props), activeItem.eventKey);\n\n        if (typeof callback === 'function') {\n          callback(activeItem);\n        }\n\n        return 1;\n      }\n      return undefined;\n    },\n    onItemHover: function onItemHover(e) {\n      var key = e.key,\n          hover = e.hover;\n\n      updateActiveKey(this.$props.store, getEventKey(this.$props), hover ? key : null);\n    },\n    onDeselect: function onDeselect(selectInfo) {\n      this.__emit('deselect', selectInfo);\n    },\n    onSelect: function onSelect(selectInfo) {\n      this.__emit('select', selectInfo);\n    },\n    onClick: function onClick(e) {\n      this.__emit('click', e);\n    },\n    onOpenChange: function onOpenChange(e) {\n      this.__emit('openChange', e);\n    },\n    onDestroy: function onDestroy(key) {\n      this.__emit('destroy', key);\n    },\n    getFlatInstanceArray: function getFlatInstanceArray() {\n      return this.instanceArray;\n    },\n    getOpenTransitionName: function getOpenTransitionName() {\n      return this.$props.openTransitionName;\n    },\n    step: function step(direction) {\n      var children = this.getFlatInstanceArray();\n      var activeKey = this.$props.store.getState().activeKey[getEventKey(this.$props)];\n      var len = children.length;\n      if (!len) {\n        return null;\n      }\n      if (direction < 0) {\n        children = children.concat().reverse();\n      }\n      // find current activeIndex\n      var activeIndex = -1;\n      children.every(function (c, ci) {\n        if (c && c.eventKey === activeKey) {\n          activeIndex = ci;\n          return false;\n        }\n        return true;\n      });\n      if (!this.defaultActiveFirst && activeIndex !== -1 && allDisabled(children.slice(activeIndex, len - 1))) {\n        return undefined;\n      }\n      var start = (activeIndex + 1) % len;\n      var i = start;\n\n      do {\n        var child = children[i];\n        if (!child || child.disabled) {\n          i = (i + 1) % len;\n        } else {\n          return child;\n        }\n      } while (i !== start);\n\n      return null;\n    },\n    getIcon: function getIcon(instance, name) {\n      if (instance.$createElement) {\n        var temp = instance[name];\n        if (temp !== undefined) {\n          return temp;\n        }\n        return instance.$slots[name] || instance.$scopedSlots[name];\n      } else {\n        var _temp = getPropsData(instance)[name];\n        if (_temp !== undefined) {\n          return _temp;\n        }\n        var slotsProp = [];\n        var componentOptions = instance.componentOptions || {};\n        (componentOptions.children || []).forEach(function (child) {\n          if (child.data && child.data.slot === name) {\n            if (child.tag === 'template') {\n              slotsProp.push(child.children);\n            } else {\n              slotsProp.push(child);\n            }\n          }\n        });\n        return slotsProp.length ? slotsProp : undefined;\n      }\n    },\n    renderCommonMenuItem: function renderCommonMenuItem(child, i, extraProps) {\n      var _this = this;\n\n      if (child.tag === undefined) {\n        return child;\n      }\n      var state = this.$props.store.getState();\n      var props = this.$props;\n      var key = getKeyFromChildrenIndex(child, props.eventKey, i);\n      var childProps = child.componentOptions.propsData || {};\n\n      var isActive = key === state.activeKey[getEventKey(this.$props)];\n      if (!childProps.disabled) {\n        // manualRef的执行顺序不能保证，使用key映射ref在this.instanceArray中的位置\n        this.instanceArrayKeyIndexMap[key] = Object.keys(this.instanceArrayKeyIndexMap).length;\n      }\n      var childListeners = getEvents(child);\n      var newChildProps = {\n        props: _extends({\n          mode: childProps.mode || props.mode,\n          level: props.level,\n          inlineIndent: props.inlineIndent,\n          renderMenuItem: this.renderMenuItem,\n          rootPrefixCls: props.prefixCls,\n          index: i,\n          parentMenu: props.parentMenu,\n          // customized ref function, need to be invoked manually in child's componentDidMount\n          manualRef: childProps.disabled ? noop : saveRef.bind(this, key),\n          eventKey: key,\n          active: !childProps.disabled && isActive,\n          multiple: props.multiple,\n          openTransitionName: this.getOpenTransitionName(),\n          openAnimation: props.openAnimation,\n          subMenuOpenDelay: props.subMenuOpenDelay,\n          subMenuCloseDelay: props.subMenuCloseDelay,\n          forceSubMenuRender: props.forceSubMenuRender,\n          builtinPlacements: props.builtinPlacements,\n          itemIcon: this.getIcon(child, 'itemIcon') || this.getIcon(this, 'itemIcon'),\n          expandIcon: this.getIcon(child, 'expandIcon') || this.getIcon(this, 'expandIcon')\n        }, extraProps),\n        on: {\n          click: function click(e) {\n            (childListeners.click || noop)(e);\n            _this.onClick(e);\n          },\n          itemHover: this.onItemHover,\n          openChange: this.onOpenChange,\n          deselect: this.onDeselect,\n          // destroy: this.onDestroy,\n          select: this.onSelect\n        }\n      };\n      // ref: https://github.com/ant-design/ant-design/issues/13943\n      if (props.mode === 'inline' || isMobileDevice()) {\n        newChildProps.props.triggerSubMenuAction = 'click';\n      }\n      return cloneElement(child, newChildProps);\n    },\n    renderMenuItem: function renderMenuItem(c, i, subMenuKey) {\n      if (!c) {\n        return null;\n      }\n      var state = this.$props.store.getState();\n      var extraProps = {\n        openKeys: state.openKeys,\n        selectedKeys: state.selectedKeys,\n        triggerSubMenuAction: this.triggerSubMenuAction,\n        isRootMenu: false,\n        subMenuKey: subMenuKey\n      };\n      return this.renderCommonMenuItem(c, i, extraProps);\n    }\n  },\n  render: function render() {\n    var _this2 = this;\n\n    var h = arguments[0];\n\n    var props = _objectWithoutProperties(this.$props, []);\n\n    var eventKey = props.eventKey,\n        prefixCls = props.prefixCls,\n        visible = props.visible,\n        level = props.level,\n        mode = props.mode,\n        theme = props.theme;\n\n    this.instanceArray = [];\n    this.instanceArrayKeyIndexMap = {};\n    var className = classNames(props.prefixCls, props.prefixCls + '-' + props.mode);\n    var domWrapProps = {\n      props: {\n        tag: 'ul',\n        // hiddenClassName: `${prefixCls}-hidden`,\n        visible: visible,\n        prefixCls: prefixCls,\n        level: level,\n        mode: mode,\n        theme: theme,\n        overflowedIndicator: getComponentFromProp(this, 'overflowedIndicator')\n      },\n      attrs: {\n        role: props.role || 'menu'\n      },\n      'class': className,\n      // Otherwise, the propagated click event will trigger another onClick\n      on: omit(getListeners(this), ['click'])\n    };\n    // if (props.id) {\n    //   domProps.id = props.id\n    // }\n    if (props.focusable) {\n      domWrapProps.attrs.tabIndex = '0';\n      domWrapProps.on.keydown = this.onKeyDown;\n    }\n    return (\n      // ESLint is not smart enough to know that the type of `children` was checked.\n      /* eslint-disable */\n      h(\n        DOMWrap,\n        domWrapProps,\n        [props.children.map(function (c, i) {\n          return _this2.renderMenuItem(c, i, eventKey || '0-menu-');\n        })]\n      )\n      /*eslint -enable */\n\n    );\n  }\n};\n\nexport default connect()(SubPopupMenu);"]},"metadata":{},"sourceType":"module"}